/**
 * Integrated by Dominique Cavailhez (c) 2014
 * https://github.com/Dominique92/MyLeaflet
 * Generated by MagicMin: 2015-09-09 03:45:19
 */

/**
 * leafletjs.com/leaflet-src.js (146.3 kb)
 */
(function(window,document,undefined){if(navigator.userAgent.search(/arach|archiver|bot|crawl|curl|factory|index|partner|rss|seek|search|semantic|scoot|spider|spyder|yandex/i)!=-1)
return;var oldL=window.L,L={};L.version='0.7.5';if(typeof module==='object'&&typeof module.exports==='object'){module.exports=L;}else if(typeof define==='function'&&define.amd){define(L);}
L.noConflict=function(){window.L=oldL;return this;};window.L=L;L.Util={extend:function(dest){var sources=Array.prototype.slice.call(arguments,1),i,j,len,src;for(j=0,len=sources.length;j<len;j++){src=sources[j]||{};for(i in src){if(src.hasOwnProperty(i)){dest[i]=src[i];}}}
return dest;},bind:function(fn,obj){var args=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return fn.apply(obj,args||arguments);};},stamp:(function(){var lastId=0,key='_leaflet_id';return function(obj){obj[key]=obj[key]||++lastId;return obj[key];};}()),invokeEach:function(obj,method,context){var i,args;if(typeof obj==='object'){args=Array.prototype.slice.call(arguments,3);for(i in obj){method.apply(context,[i,obj[i]].concat(args));}
return true;}
return false;},limitExecByInterval:function(fn,time,context){var lock,execOnUnlock;return function wrapperFn(){var args=arguments;if(lock){execOnUnlock=true;return;}
lock=true;setTimeout(function(){lock=false;if(execOnUnlock){wrapperFn.apply(context,args);execOnUnlock=false;}},time);fn.apply(context,args);};},falseFn:function(){return false;},formatNum:function(num,digits){var pow=Math.pow(10,digits||5);return Math.round(num*pow)/ pow;},trim:function(str){return str.trim?str.trim():str.replace(/^\s+|\s+$/g,'');},splitWords:function(str){return L.Util.trim(str).split(/\s+/);},setOptions:function(obj,options){obj.options=L.extend({},obj.options,options);return obj.options;},getParamString:function(obj,existingUrl,uppercase){var params=[];for(var i in obj){params.push(encodeURIComponent(uppercase?i.toUpperCase():i)+'='+encodeURIComponent(obj[i]));}
return((!existingUrl||existingUrl.indexOf('?')===-1)?'?':'&')+params.join('&');},template:function(str,data){return str.replace(/\{ *([\w_]+) *\}/g,function(str,key){var value=data[key];if(value===undefined){throw new Error('No value provided for variable '+str);}else if(typeof value==='function'){value=value(data);}
return value;});},isArray:Array.isArray||function(obj){return(Object.prototype.toString.call(obj)==='[object Array]');},emptyImageUrl:'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs='};(function(){function getPrefixed(name){var i,fn,prefixes=['webkit','moz','o','ms'];for(i=0;i<prefixes.length&&!fn;i++){fn=window[prefixes[i]+name];}
return fn;}
var lastTime=0;function timeoutDefer(fn){var time=+new Date(),timeToCall=Math.max(0,16-(time-lastTime));lastTime=time+timeToCall;return window.setTimeout(fn,timeToCall);}
var requestFn=window.requestAnimationFrame||getPrefixed('RequestAnimationFrame')||timeoutDefer;var cancelFn=window.cancelAnimationFrame||getPrefixed('CancelAnimationFrame')||getPrefixed('CancelRequestAnimationFrame')||function(id){window.clearTimeout(id);};L.Util.requestAnimFrame=function(fn,context,immediate,element){fn=L.bind(fn,context);if(immediate&&requestFn===timeoutDefer){fn();}else{return requestFn.call(window,fn,element);}};L.Util.cancelAnimFrame=function(id){if(id){cancelFn.call(window,id);}};}());L.extend=L.Util.extend;L.bind=L.Util.bind;L.stamp=L.Util.stamp;L.setOptions=L.Util.setOptions;L.Class=function(){};L.Class.extend=function(props){var NewClass=function(){if(this.initialize){this.initialize.apply(this,arguments);}
if(this._initHooks){this.callInitHooks();}};var F=function(){};F.prototype=this.prototype;var proto=new F();proto.constructor=NewClass;NewClass.prototype=proto;for(var i in this){if(this.hasOwnProperty(i)&&i!=='prototype'){NewClass[i]=this[i];}}
if(props.statics){L.extend(NewClass,props.statics);delete props.statics;}
if(props.includes){L.Util.extend.apply(null,[proto].concat(props.includes));delete props.includes;}
if(props.options&&proto.options){props.options=L.extend({},proto.options,props.options);}
L.extend(proto,props);proto._initHooks=[];var parent=this;NewClass.__super__=parent.prototype;proto.callInitHooks=function(){if(this._initHooksCalled){return;}
if(parent.prototype.callInitHooks){parent.prototype.callInitHooks.call(this);}
this._initHooksCalled=true;for(var i=0,len=proto._initHooks.length;i<len;i++){proto._initHooks[i].call(this);}};return NewClass;};L.Class.include=function(props){L.extend(this.prototype,props);};L.Class.mergeOptions=function(options){L.extend(this.prototype.options,options);};L.Class.addInitHook=function(fn){var args=Array.prototype.slice.call(arguments,1);var init=typeof fn==='function'?fn:function(){this[fn].apply(this,args);};this.prototype._initHooks=this.prototype._initHooks||[];this.prototype._initHooks.push(init);};var eventsKey='_leaflet_events';L.Mixin={};L.Mixin.Events={addEventListener:function(types,fn,context){if(L.Util.invokeEach(types,this.addEventListener,this,fn,context)){return this;}
var events=this[eventsKey]=this[eventsKey]||{},contextId=context&&context!==this&&L.stamp(context),i,len,event,type,indexKey,indexLenKey,typeIndex;types=L.Util.splitWords(types);for(i=0,len=types.length;i<len;i++){event={action:fn,context:context||this};type=types[i];if(contextId){indexKey=type+'_idx';indexLenKey=indexKey+'_len';typeIndex=events[indexKey]=events[indexKey]||{};if(!typeIndex[contextId]){typeIndex[contextId]=[];events[indexLenKey]=(events[indexLenKey]||0)+1;}
typeIndex[contextId].push(event);}else{events[type]=events[type]||[];events[type].push(event);}}
return this;},hasEventListeners:function(type){var events=this[eventsKey];return!!events&&((type in events&&events[type].length>0)||(type+'_idx'in events&&events[type+'_idx_len']>0));},removeEventListener:function(types,fn,context){if(!this[eventsKey]){return this;}
if(!types){return this.clearAllEventListeners();}
if(L.Util.invokeEach(types,this.removeEventListener,this,fn,context)){return this;}
var events=this[eventsKey],contextId=context&&context!==this&&L.stamp(context),i,len,type,listeners,j,indexKey,indexLenKey,typeIndex,removed;types=L.Util.splitWords(types);for(i=0,len=types.length;i<len;i++){type=types[i];indexKey=type+'_idx';indexLenKey=indexKey+'_len';typeIndex=events[indexKey];if(!fn){delete events[type];delete events[indexKey];delete events[indexLenKey];}else{listeners=contextId&&typeIndex?typeIndex[contextId]:events[type];if(listeners){for(j=listeners.length-1;j>=0;j--){if((listeners[j].action===fn)&&(!context||(listeners[j].context===context))){removed=listeners.splice(j,1);removed[0].action=L.Util.falseFn;}}
if(context&&typeIndex&&(listeners.length===0)){delete typeIndex[contextId];events[indexLenKey]--;}}}}
return this;},clearAllEventListeners:function(){delete this[eventsKey];return this;},fireEvent:function(type,data){if(!this.hasEventListeners(type)){return this;}
var event=L.Util.extend({},data,{type:type,target:this});var events=this[eventsKey],listeners,i,len,typeIndex,contextId;if(events[type]){listeners=events[type].slice();for(i=0,len=listeners.length;i<len;i++){listeners[i].action.call(listeners[i].context,event);}}
typeIndex=events[type+'_idx'];for(contextId in typeIndex){listeners=typeIndex[contextId].slice();if(listeners){for(i=0,len=listeners.length;i<len;i++){listeners[i].action.call(listeners[i].context,event);}}}
return this;},addOneTimeEventListener:function(types,fn,context){if(L.Util.invokeEach(types,this.addOneTimeEventListener,this,fn,context)){return this;}
var handler=L.bind(function(){this.removeEventListener(types,fn,context).removeEventListener(types,handler,context);},this);return this.addEventListener(types,fn,context).addEventListener(types,handler,context);}};L.Mixin.Events.on=L.Mixin.Events.addEventListener;L.Mixin.Events.off=L.Mixin.Events.removeEventListener;L.Mixin.Events.once=L.Mixin.Events.addOneTimeEventListener;L.Mixin.Events.fire=L.Mixin.Events.fireEvent;(function(){var ie='ActiveXObject'in window,ielt9=ie&&!document.addEventListener,ua=navigator.userAgent.toLowerCase(),webkit=ua.indexOf('webkit')!==-1,chrome=ua.indexOf('chrome')!==-1,phantomjs=ua.indexOf('phantom')!==-1,android=ua.indexOf('android')!==-1,android23=ua.search('android [23]')!==-1,gecko=ua.indexOf('gecko')!==-1,mobile=typeof orientation!==undefined+'',msPointer=!window.PointerEvent&&window.MSPointerEvent,pointer=(window.PointerEvent&&window.navigator.pointerEnabled&&window.navigator.maxTouchPoints)||msPointer,retina=('devicePixelRatio'in window&&window.devicePixelRatio>1)||('matchMedia'in window&&window.matchMedia('(min-resolution:144dpi)')&&window.matchMedia('(min-resolution:144dpi)').matches),doc=document.documentElement,ie3d=ie&&('transition'in doc.style),webkit3d=('WebKitCSSMatrix'in window)&&('m11'in new window.WebKitCSSMatrix())&&!android23,gecko3d='MozPerspective'in doc.style,opera3d='OTransition'in doc.style,any3d=!window.L_DISABLE_3D&&(ie3d||webkit3d||gecko3d||opera3d)&&!phantomjs;var touch=!window.L_NO_TOUCH&&!phantomjs&&(pointer||'ontouchstart'in window||(window.DocumentTouch&&document instanceof window.DocumentTouch));L.Browser={ie:ie,ielt9:ielt9,webkit:webkit,gecko:gecko&&!webkit&&!window.opera&&!ie,android:android,android23:android23,chrome:chrome,ie3d:ie3d,webkit3d:webkit3d,gecko3d:gecko3d,opera3d:opera3d,any3d:any3d,mobile:mobile,mobileWebkit:mobile&&webkit,mobileWebkit3d:mobile&&webkit3d,mobileOpera:mobile&&window.opera,touch:touch,msPointer:msPointer,pointer:pointer,retina:retina};}());L.Point=function(x,y,round){this.x=(round?Math.round(x):x);this.y=(round?Math.round(y):y);};L.Point.prototype={clone:function(){return new L.Point(this.x,this.y);},add:function(point){return this.clone()._add(L.point(point));},_add:function(point){this.x+=point.x;this.y+=point.y;return this;},subtract:function(point){return this.clone()._subtract(L.point(point));},_subtract:function(point){this.x-=point.x;this.y-=point.y;return this;},divideBy:function(num){return this.clone()._divideBy(num);},_divideBy:function(num){this.x /=num;this.y /=num;return this;},multiplyBy:function(num){return this.clone()._multiplyBy(num);},_multiplyBy:function(num){this.x*=num;this.y*=num;return this;},round:function(){return this.clone()._round();},_round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this;},floor:function(){return this.clone()._floor();},_floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this;},distanceTo:function(point){point=L.point(point);var x=point.x-this.x,y=point.y-this.y;return Math.sqrt(x*x+y*y);},equals:function(point){point=L.point(point);return point.x===this.x&&point.y===this.y;},contains:function(point){point=L.point(point);return Math.abs(point.x)<=Math.abs(this.x)&&Math.abs(point.y)<=Math.abs(this.y);},toString:function(){return'Point('+
L.Util.formatNum(this.x)+', '+
L.Util.formatNum(this.y)+')';}};L.point=function(x,y,round){if(x instanceof L.Point){return x;}
if(L.Util.isArray(x)){return new L.Point(x[0],x[1]);}
if(x===undefined||x===null){return x;}
return new L.Point(x,y,round);};L.Bounds=function(a,b){if(!a){return;}
var points=b?[a,b]:a;for(var i=0,len=points.length;i<len;i++){this.extend(points[i]);}};L.Bounds.prototype={extend:function(point){point=L.point(point);if(!this.min&&!this.max){this.min=point.clone();this.max=point.clone();}else{this.min.x=Math.min(point.x,this.min.x);this.max.x=Math.max(point.x,this.max.x);this.min.y=Math.min(point.y,this.min.y);this.max.y=Math.max(point.y,this.max.y);}
return this;},getCenter:function(round){return new L.Point((this.min.x+this.max.x)/ 2,(this.min.y+this.max.y)/ 2,round);},getBottomLeft:function(){return new L.Point(this.min.x,this.max.y);},getTopRight:function(){return new L.Point(this.max.x,this.min.y);},getSize:function(){return this.max.subtract(this.min);},contains:function(obj){var min,max;if(typeof obj[0]==='number'||obj instanceof L.Point){obj=L.point(obj);}else{obj=L.bounds(obj);}
if(obj instanceof L.Bounds){min=obj.min;max=obj.max;}else{min=max=obj;}
return(min.x>=this.min.x)&&(max.x<=this.max.x)&&(min.y>=this.min.y)&&(max.y<=this.max.y);},intersects:function(bounds){bounds=L.bounds(bounds);var min=this.min,max=this.max,min2=bounds.min,max2=bounds.max,xIntersects=(max2.x>=min.x)&&(min2.x<=max.x),yIntersects=(max2.y>=min.y)&&(min2.y<=max.y);return xIntersects&&yIntersects;},isValid:function(){return!!(this.min&&this.max);}};L.bounds=function(a,b){if(!a||a instanceof L.Bounds){return a;}
return new L.Bounds(a,b);};L.Transformation=function(a,b,c,d){this._a=a;this._b=b;this._c=c;this._d=d;};L.Transformation.prototype={transform:function(point,scale){return this._transform(point.clone(),scale);},_transform:function(point,scale){scale=scale||1;point.x=scale*(this._a*point.x+this._b);point.y=scale*(this._c*point.y+this._d);return point;},untransform:function(point,scale){scale=scale||1;return new L.Point((point.x / scale-this._b)/ this._a,(point.y / scale-this._d)/ this._c);}};L.DomUtil={get:function(id){return(typeof id==='string'?document.getElementById(id):id);},getStyle:function(el,style){var value=el.style[style];if(!value&&el.currentStyle){value=el.currentStyle[style];}
if((!value||value==='auto')&&document.defaultView){var css=document.defaultView.getComputedStyle(el,null);value=css?css[style]:null;}
return value==='auto'?null:value;},getViewportOffset:function(element){var top=0,left=0,el=element,docBody=document.body,docEl=document.documentElement,pos;do{top+=el.offsetTop||0;left+=el.offsetLeft||0;top+=parseInt(L.DomUtil.getStyle(el,'borderTopWidth'),10)||0;left+=parseInt(L.DomUtil.getStyle(el,'borderLeftWidth'),10)||0;pos=L.DomUtil.getStyle(el,'position');if(el.offsetParent===docBody&&pos==='absolute'){break;}
if(pos==='fixed'){top+=docBody.scrollTop||docEl.scrollTop||0;left+=docBody.scrollLeft||docEl.scrollLeft||0;break;}
if(pos==='relative'&&!el.offsetLeft){var width=L.DomUtil.getStyle(el,'width'),maxWidth=L.DomUtil.getStyle(el,'max-width'),r=el.getBoundingClientRect();if(width!=='none'||maxWidth!=='none'){left+=r.left+el.clientLeft;}
top+=r.top+(docBody.scrollTop||docEl.scrollTop||0);break;}
el=el.offsetParent;}while(el);el=element;do{if(el===docBody){break;}
top-=el.scrollTop||0;left-=el.scrollLeft||0;el=el.parentNode;}while(el);return new L.Point(left,top);},documentIsLtr:function(){if(!L.DomUtil._docIsLtrCached){L.DomUtil._docIsLtrCached=true;L.DomUtil._docIsLtr=L.DomUtil.getStyle(document.body,'direction')==='ltr';}
return L.DomUtil._docIsLtr;},create:function(tagName,className,container){var el=document.createElement(tagName);el.className=className;if(container){container.appendChild(el);}
return el;},hasClass:function(el,name){if(el.classList!==undefined){return el.classList.contains(name);}
var className=L.DomUtil._getClass(el);return className.length>0&&new RegExp('(^|\\s)'+name+'(\\s|$)').test(className);},addClass:function(el,name){if(el.classList!==undefined){var classes=L.Util.splitWords(name);for(var i=0,len=classes.length;i<len;i++){el.classList.add(classes[i]);}}else if(!L.DomUtil.hasClass(el,name)){var className=L.DomUtil._getClass(el);L.DomUtil._setClass(el,(className?className+' ':'')+name);}},removeClass:function(el,name){if(el.classList!==undefined){el.classList.remove(name);}else{L.DomUtil._setClass(el,L.Util.trim((' '+L.DomUtil._getClass(el)+' ').replace(' '+name+' ',' ')));}},_setClass:function(el,name){if(el.className.baseVal===undefined){el.className=name;}else{el.className.baseVal=name;}},_getClass:function(el){return el.className.baseVal===undefined?el.className:el.className.baseVal;},setOpacity:function(el,value){if('opacity'in el.style){el.style.opacity=value;}else if('filter'in el.style){var filter=false,filterName='DXImageTransform.Microsoft.Alpha';try{filter=el.filters.item(filterName);}catch(e){if(value===1){return;}}
value=Math.round(value*100);if(filter){filter.Enabled=(value!==100);filter.Opacity=value;}else{el.style.filter+=' progid:'+filterName+'(opacity='+value+')';}}},testProp:function(props){var style=document.documentElement.style;for(var i=0;i<props.length;i++){if(props[i]in style){return props[i];}}
return false;},getTranslateString:function(point){var is3d=L.Browser.webkit3d,open='translate'+(is3d?'3d':'')+'(',close=(is3d?',0':'')+')';return open+point.x+'px,'+point.y+'px'+close;},getScaleString:function(scale,origin){var preTranslateStr=L.DomUtil.getTranslateString(origin.add(origin.multiplyBy(-1*scale))),scaleStr=' scale('+scale+') ';return preTranslateStr+scaleStr;},setPosition:function(el,point,disable3D){el._leaflet_pos=point;if(!disable3D&&L.Browser.any3d){el.style[L.DomUtil.TRANSFORM]=L.DomUtil.getTranslateString(point);}else{el.style.left=point.x+'px';el.style.top=point.y+'px';}},getPosition:function(el){return el._leaflet_pos;}};L.DomUtil.TRANSFORM=L.DomUtil.testProp(['transform','WebkitTransform','OTransform','MozTransform','msTransform']);L.DomUtil.TRANSITION=L.DomUtil.testProp(['webkitTransition','transition','OTransition','MozTransition','msTransition']);L.DomUtil.TRANSITION_END=L.DomUtil.TRANSITION==='webkitTransition'||L.DomUtil.TRANSITION==='OTransition'?L.DomUtil.TRANSITION+'End':'transitionend';(function(){if('onselectstart'in document){L.extend(L.DomUtil,{disableTextSelection:function(){L.DomEvent.on(window,'selectstart',L.DomEvent.preventDefault);},enableTextSelection:function(){L.DomEvent.off(window,'selectstart',L.DomEvent.preventDefault);}});}else{var userSelectProperty=L.DomUtil.testProp(['userSelect','WebkitUserSelect','OUserSelect','MozUserSelect','msUserSelect']);L.extend(L.DomUtil,{disableTextSelection:function(){if(userSelectProperty){var style=document.documentElement.style;this._userSelect=style[userSelectProperty];style[userSelectProperty]='none';}},enableTextSelection:function(){if(userSelectProperty){document.documentElement.style[userSelectProperty]=this._userSelect;delete this._userSelect;}}});}
L.extend(L.DomUtil,{disableImageDrag:function(){L.DomEvent.on(window,'dragstart',L.DomEvent.preventDefault);},enableImageDrag:function(){L.DomEvent.off(window,'dragstart',L.DomEvent.preventDefault);}});})();L.LatLng=function(lat,lng,alt){lat=parseFloat(lat);lng=parseFloat(lng);if(isNaN(lat)||isNaN(lng)){throw new Error('Invalid LatLng object: ('+lat+', '+lng+')');}
this.lat=lat;this.lng=lng;if(alt!==undefined){this.alt=parseFloat(alt);}};L.extend(L.LatLng,{DEG_TO_RAD:Math.PI / 180,RAD_TO_DEG:180 / Math.PI,MAX_MARGIN:1.0E-9});L.LatLng.prototype={equals:function(obj){if(!obj){return false;}
obj=L.latLng(obj);var margin=Math.max(Math.abs(this.lat-obj.lat),Math.abs(this.lng-obj.lng));return margin<=L.LatLng.MAX_MARGIN;},toString:function(precision){return'LatLng('+
L.Util.formatNum(this.lat,precision)+', '+
L.Util.formatNum(this.lng,precision)+')';},distanceTo:function(other){other=L.latLng(other);var R=6378137,d2r=L.LatLng.DEG_TO_RAD,dLat=(other.lat-this.lat)*d2r,dLon=(other.lng-this.lng)*d2r,lat1=this.lat*d2r,lat2=other.lat*d2r,sin1=Math.sin(dLat / 2),sin2=Math.sin(dLon / 2);var a=sin1*sin1+sin2*sin2*Math.cos(lat1)*Math.cos(lat2);return R*2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));},wrap:function(a,b){var lng=this.lng;a=a||-180;b=b||180;lng=(lng+b)%(b-a)+(lng<a||lng===b?b:a);return new L.LatLng(this.lat,lng);}};L.latLng=function(a,b){if(a instanceof L.LatLng){return a;}
if(L.Util.isArray(a)){if(typeof a[0]==='number'||typeof a[0]==='string'){return new L.LatLng(a[0],a[1],a[2]);}else{return null;}}
if(a===undefined||a===null){return a;}
if(typeof a==='object'&&'lat'in a){return new L.LatLng(a.lat,'lng'in a?a.lng:a.lon);}
if(b===undefined){return null;}
return new L.LatLng(a,b);};L.LatLngBounds=function(southWest,northEast){if(!southWest){return;}
var latlngs=northEast?[southWest,northEast]:southWest;for(var i=0,len=latlngs.length;i<len;i++){this.extend(latlngs[i]);}};L.LatLngBounds.prototype={extend:function(obj){if(!obj){return this;}
var latLng=L.latLng(obj);if(latLng!==null){obj=latLng;}else{obj=L.latLngBounds(obj);}
if(obj instanceof L.LatLng){if(!this._southWest&&!this._northEast){this._southWest=new L.LatLng(obj.lat,obj.lng);this._northEast=new L.LatLng(obj.lat,obj.lng);}else{this._southWest.lat=Math.min(obj.lat,this._southWest.lat);this._southWest.lng=Math.min(obj.lng,this._southWest.lng);this._northEast.lat=Math.max(obj.lat,this._northEast.lat);this._northEast.lng=Math.max(obj.lng,this._northEast.lng);}}else if(obj instanceof L.LatLngBounds){this.extend(obj._southWest);this.extend(obj._northEast);}
return this;},pad:function(bufferRatio){var sw=this._southWest,ne=this._northEast,heightBuffer=Math.abs(sw.lat-ne.lat)*bufferRatio,widthBuffer=Math.abs(sw.lng-ne.lng)*bufferRatio;return new L.LatLngBounds(new L.LatLng(sw.lat-heightBuffer,sw.lng-widthBuffer),new L.LatLng(ne.lat+heightBuffer,ne.lng+widthBuffer));},getCenter:function(){return new L.LatLng((this._southWest.lat+this._northEast.lat)/ 2,(this._southWest.lng+this._northEast.lng)/ 2);},getSouthWest:function(){return this._southWest;},getNorthEast:function(){return this._northEast;},getNorthWest:function(){return new L.LatLng(this.getNorth(),this.getWest());},getSouthEast:function(){return new L.LatLng(this.getSouth(),this.getEast());},getWest:function(){return this._southWest.lng;},getSouth:function(){return this._southWest.lat;},getEast:function(){return this._northEast.lng;},getNorth:function(){return this._northEast.lat;},contains:function(obj){if(typeof obj[0]==='number'||obj instanceof L.LatLng){obj=L.latLng(obj);}else{obj=L.latLngBounds(obj);}
var sw=this._southWest,ne=this._northEast,sw2,ne2;if(obj instanceof L.LatLngBounds){sw2=obj.getSouthWest();ne2=obj.getNorthEast();}else{sw2=ne2=obj;}
return(sw2.lat>=sw.lat)&&(ne2.lat<=ne.lat)&&(sw2.lng>=sw.lng)&&(ne2.lng<=ne.lng);},intersects:function(bounds){bounds=L.latLngBounds(bounds);var sw=this._southWest,ne=this._northEast,sw2=bounds.getSouthWest(),ne2=bounds.getNorthEast(),latIntersects=(ne2.lat>=sw.lat)&&(sw2.lat<=ne.lat),lngIntersects=(ne2.lng>=sw.lng)&&(sw2.lng<=ne.lng);return latIntersects&&lngIntersects;},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(',');},equals:function(bounds){if(!bounds){return false;}
bounds=L.latLngBounds(bounds);return this._southWest.equals(bounds.getSouthWest())&&this._northEast.equals(bounds.getNorthEast());},isValid:function(){return!!(this._southWest&&this._northEast);}};L.latLngBounds=function(a,b){if(!a||a instanceof L.LatLngBounds){return a;}
return new L.LatLngBounds(a,b);};L.Projection={};L.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(latlng){var d=L.LatLng.DEG_TO_RAD,max=this.MAX_LATITUDE,lat=Math.max(Math.min(max,latlng.lat),-max),x=latlng.lng*d,y=lat*d;y=Math.log(Math.tan((Math.PI / 4)+(y / 2)));return new L.Point(x,y);},unproject:function(point){var d=L.LatLng.RAD_TO_DEG,lng=point.x*d,lat=(2*Math.atan(Math.exp(point.y))-(Math.PI / 2))*d;return new L.LatLng(lat,lng);}};L.Projection.LonLat={project:function(latlng){return new L.Point(latlng.lng,latlng.lat);},unproject:function(point){return new L.LatLng(point.y,point.x);}};L.CRS={latLngToPoint:function(latlng,zoom){var projectedPoint=this.projection.project(latlng),scale=this.scale(zoom);return this.transformation._transform(projectedPoint,scale);},pointToLatLng:function(point,zoom){var scale=this.scale(zoom),untransformedPoint=this.transformation.untransform(point,scale);return this.projection.unproject(untransformedPoint);},project:function(latlng){return this.projection.project(latlng);},scale:function(zoom){return 256*Math.pow(2,zoom);},getSize:function(zoom){var s=this.scale(zoom);return L.point(s,s);}};L.CRS.Simple=L.extend({},L.CRS,{projection:L.Projection.LonLat,transformation:new L.Transformation(1,0,-1,0),scale:function(zoom){return Math.pow(2,zoom);}});L.CRS.EPSG3857=L.extend({},L.CRS,{code:'EPSG:3857',projection:L.Projection.SphericalMercator,transformation:new L.Transformation(0.5 / Math.PI,0.5,-0.5 / Math.PI,0.5),project:function(latlng){var projectedPoint=this.projection.project(latlng),earthRadius=6378137;return projectedPoint.multiplyBy(earthRadius);}});L.CRS.EPSG900913=L.extend({},L.CRS.EPSG3857,{code:'EPSG:900913'});L.CRS.EPSG4326=L.extend({},L.CRS,{code:'EPSG:4326',projection:L.Projection.LonLat,transformation:new L.Transformation(1 / 360,0.5,-1 / 360,0.5)});L.Map=L.Class.extend({includes:L.Mixin.Events,options:{crs:L.CRS.EPSG3857,fadeAnimation:L.DomUtil.TRANSITION&&!L.Browser.android23,trackResize:true,markerZoomAnimation:L.DomUtil.TRANSITION&&L.Browser.any3d},initialize:function(id,options){options=L.setOptions(this,options);this._initContainer(id);this._initLayout();this._onResize=L.bind(this._onResize,this);this._initEvents();if(options.maxBounds){this.setMaxBounds(options.maxBounds);}
if(options.center&&options.zoom!==undefined){this.setView(L.latLng(options.center),options.zoom,{reset:true});}
this._handlers=[];this._layers={};this._zoomBoundLayers={};this._tileLayersNum=0;this.callInitHooks();this._addLayers(options.layers);},setView:function(center,zoom){zoom=zoom===undefined?this.getZoom():zoom;this._resetView(L.latLng(center),this._limitZoom(zoom));return this;},setZoom:function(zoom,options){if(!this._loaded){this._zoom=this._limitZoom(zoom);return this;}
return this.setView(this.getCenter(),zoom,{zoom:options});},zoomIn:function(delta,options){return this.setZoom(this._zoom+(delta||1),options);},zoomOut:function(delta,options){return this.setZoom(this._zoom-(delta||1),options);},setZoomAround:function(latlng,zoom,options){var scale=this.getZoomScale(zoom),viewHalf=this.getSize().divideBy(2),containerPoint=latlng instanceof L.Point?latlng:this.latLngToContainerPoint(latlng),centerOffset=containerPoint.subtract(viewHalf).multiplyBy(1-1 / scale),newCenter=this.containerPointToLatLng(viewHalf.add(centerOffset));return this.setView(newCenter,zoom,{zoom:options});},fitBounds:function(bounds,options){options=options||{};bounds=bounds.getBounds?bounds.getBounds():L.latLngBounds(bounds);var paddingTL=L.point(options.paddingTopLeft||options.padding||[0,0]),paddingBR=L.point(options.paddingBottomRight||options.padding||[0,0]),zoom=this.getBoundsZoom(bounds,false,paddingTL.add(paddingBR));zoom=(options.maxZoom)?Math.min(options.maxZoom,zoom):zoom;var paddingOffset=paddingBR.subtract(paddingTL).divideBy(2),swPoint=this.project(bounds.getSouthWest(),zoom),nePoint=this.project(bounds.getNorthEast(),zoom),center=this.unproject(swPoint.add(nePoint).divideBy(2).add(paddingOffset),zoom);return this.setView(center,zoom,options);},fitWorld:function(options){return this.fitBounds([[-90,-180],[90,180]],options);},panTo:function(center,options){return this.setView(center,this._zoom,{pan:options});},panBy:function(offset){this.fire('movestart');this._rawPanBy(L.point(offset));this.fire('move');return this.fire('moveend');},setMaxBounds:function(bounds){bounds=L.latLngBounds(bounds);this.options.maxBounds=bounds;if(!bounds){return this.off('moveend',this._panInsideMaxBounds,this);}
if(this._loaded){this._panInsideMaxBounds();}
return this.on('moveend',this._panInsideMaxBounds,this);},panInsideBounds:function(bounds,options){var center=this.getCenter(),newCenter=this._limitCenter(center,this._zoom,bounds);if(center.equals(newCenter)){return this;}
return this.panTo(newCenter,options);},addLayer:function(layer){var id=L.stamp(layer);if(this._layers[id]){return this;}
this._layers[id]=layer;if(layer.options&&(!isNaN(layer.options.maxZoom)||!isNaN(layer.options.minZoom))){this._zoomBoundLayers[id]=layer;this._updateZoomLevels();}
if(this.options.zoomAnimation&&L.TileLayer&&(layer instanceof L.TileLayer)){this._tileLayersNum++;this._tileLayersToLoad++;layer.on('load',this._onTileLayerLoad,this);}
if(this._loaded){this._layerAdd(layer);}
return this;},removeLayer:function(layer){var id=L.stamp(layer);if(!this._layers[id]){return this;}
if(this._loaded){layer.onRemove(this);}
delete this._layers[id];if(this._loaded){this.fire('layerremove',{layer:layer});}
if(this._zoomBoundLayers[id]){delete this._zoomBoundLayers[id];this._updateZoomLevels();}
if(this.options.zoomAnimation&&L.TileLayer&&(layer instanceof L.TileLayer)){this._tileLayersNum--;this._tileLayersToLoad--;layer.off('load',this._onTileLayerLoad,this);}
return this;},hasLayer:function(layer){if(!layer){return false;}
return(L.stamp(layer)in this._layers);},eachLayer:function(method,context){for(var i in this._layers){method.call(context,this._layers[i]);}
return this;},invalidateSize:function(options){if(!this._loaded){return this;}
options=L.extend({animate:false,pan:true},options===true?{animate:true}:options);var oldSize=this.getSize();this._sizeChanged=true;this._initialCenter=null;var newSize=this.getSize(),oldCenter=oldSize.divideBy(2).round(),newCenter=newSize.divideBy(2).round(),offset=oldCenter.subtract(newCenter);if(!offset.x&&!offset.y){return this;}
if(options.animate&&options.pan){this.panBy(offset);}else{if(options.pan){this._rawPanBy(offset);}
this.fire('move');if(options.debounceMoveend){clearTimeout(this._sizeTimer);this._sizeTimer=setTimeout(L.bind(this.fire,this,'moveend'),200);}else{this.fire('moveend');}}
return this.fire('resize',{oldSize:oldSize,newSize:newSize});},addHandler:function(name,HandlerClass){if(!HandlerClass){return this;}
var handler=this[name]=new HandlerClass(this);this._handlers.push(handler);if(this.options[name]){handler.enable();}
return this;},remove:function(){if(this._loaded){this.fire('unload');}
this._initEvents('off');try{delete this._container._leaflet;}catch(e){this._container._leaflet=undefined;}
this._clearPanes();if(this._clearControlPos){this._clearControlPos();}
this._clearHandlers();return this;},getCenter:function(){this._checkIfLoaded();if(this._initialCenter&&!this._moved()){return this._initialCenter;}
return this.layerPointToLatLng(this._getCenterLayerPoint());},getZoom:function(){return this._zoom;},getBounds:function(){var bounds=this.getPixelBounds(),sw=this.unproject(bounds.getBottomLeft()),ne=this.unproject(bounds.getTopRight());return new L.LatLngBounds(sw,ne);},getMinZoom:function(){return this.options.minZoom===undefined?(this._layersMinZoom===undefined?0:this._layersMinZoom):this.options.minZoom;},getMaxZoom:function(){return this.options.maxZoom===undefined?(this._layersMaxZoom===undefined?Infinity:this._layersMaxZoom):this.options.maxZoom;},getBoundsZoom:function(bounds,inside,padding){bounds=L.latLngBounds(bounds);var zoom=this.getMinZoom()-(inside?1:0),maxZoom=this.getMaxZoom(),size=this.getSize(),nw=bounds.getNorthWest(),se=bounds.getSouthEast(),zoomNotFound=true,boundsSize;padding=L.point(padding||[0,0]);do{zoom++;boundsSize=this.project(se,zoom).subtract(this.project(nw,zoom)).add(padding);zoomNotFound=!inside?size.contains(boundsSize):boundsSize.x<size.x||boundsSize.y<size.y;}while(zoomNotFound&&zoom<=maxZoom);if(zoomNotFound&&inside){return null;}
return inside?zoom:zoom-1;},getSize:function(){if(!this._size||this._sizeChanged){this._size=new L.Point(this._container.clientWidth,this._container.clientHeight);this._sizeChanged=false;}
return this._size.clone();},getPixelBounds:function(){var topLeftPoint=this._getTopLeftPoint();return new L.Bounds(topLeftPoint,topLeftPoint.add(this.getSize()));},getPixelOrigin:function(){this._checkIfLoaded();return this._initialTopLeftPoint;},getPanes:function(){return this._panes;},getContainer:function(){return this._container;},getZoomScale:function(toZoom){var crs=this.options.crs;return crs.scale(toZoom)/ crs.scale(this._zoom);},getScaleZoom:function(scale){return this._zoom+(Math.log(scale)/ Math.LN2);},project:function(latlng,zoom){zoom=zoom===undefined?this._zoom:zoom;return this.options.crs.latLngToPoint(L.latLng(latlng),zoom);},unproject:function(point,zoom){zoom=zoom===undefined?this._zoom:zoom;return this.options.crs.pointToLatLng(L.point(point),zoom);},layerPointToLatLng:function(point){var projectedPoint=L.point(point).add(this.getPixelOrigin());return this.unproject(projectedPoint);},latLngToLayerPoint:function(latlng){var projectedPoint=this.project(L.latLng(latlng))._round();return projectedPoint._subtract(this.getPixelOrigin());},containerPointToLayerPoint:function(point){return L.point(point).subtract(this._getMapPanePos());},layerPointToContainerPoint:function(point){return L.point(point).add(this._getMapPanePos());},containerPointToLatLng:function(point){var layerPoint=this.containerPointToLayerPoint(L.point(point));return this.layerPointToLatLng(layerPoint);},latLngToContainerPoint:function(latlng){return this.layerPointToContainerPoint(this.latLngToLayerPoint(L.latLng(latlng)));},mouseEventToContainerPoint:function(e){return L.DomEvent.getMousePosition(e,this._container);},mouseEventToLayerPoint:function(e){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e));},mouseEventToLatLng:function(e){return this.layerPointToLatLng(this.mouseEventToLayerPoint(e));},_initContainer:function(id){var container=this._container=L.DomUtil.get(id);if(!container){throw new Error('Map container not found.');}else if(container._leaflet){throw new Error('Map container is already initialized.');}
container._leaflet=true;},_initLayout:function(){var container=this._container;L.DomUtil.addClass(container,'leaflet-container'+
(L.Browser.touch?' leaflet-touch':'')+
(L.Browser.retina?' leaflet-retina':'')+
(L.Browser.ielt9?' leaflet-oldie':'')+
(this.options.fadeAnimation?' leaflet-fade-anim':''));var position=L.DomUtil.getStyle(container,'position');if(position!=='absolute'&&position!=='relative'&&position!=='fixed'){container.style.position='relative';}
this._initPanes();if(this._initControlPos){this._initControlPos();}},_initPanes:function(){var panes=this._panes={};this._mapPane=panes.mapPane=this._createPane('leaflet-map-pane',this._container);this._tilePane=panes.tilePane=this._createPane('leaflet-tile-pane',this._mapPane);panes.objectsPane=this._createPane('leaflet-objects-pane',this._mapPane);panes.shadowPane=this._createPane('leaflet-shadow-pane');panes.overlayPane=this._createPane('leaflet-overlay-pane');panes.markerPane=this._createPane('leaflet-marker-pane');panes.popupPane=this._createPane('leaflet-popup-pane');var zoomHide=' leaflet-zoom-hide';if(!this.options.markerZoomAnimation){L.DomUtil.addClass(panes.markerPane,zoomHide);L.DomUtil.addClass(panes.shadowPane,zoomHide);L.DomUtil.addClass(panes.popupPane,zoomHide);}},_createPane:function(className,container){return L.DomUtil.create('div',className,container||this._panes.objectsPane);},_clearPanes:function(){this._container.removeChild(this._mapPane);},_addLayers:function(layers){layers=layers?(L.Util.isArray(layers)?layers:[layers]):[];for(var i=0,len=layers.length;i<len;i++){this.addLayer(layers[i]);}},_resetView:function(center,zoom,preserveMapOffset,afterZoomAnim){var zoomChanged=(this._zoom!==zoom);if(!afterZoomAnim){this.fire('movestart');if(zoomChanged){this.fire('zoomstart');}}
this._zoom=zoom;this._initialCenter=center;this._initialTopLeftPoint=this._getNewTopLeftPoint(center);if(!preserveMapOffset){L.DomUtil.setPosition(this._mapPane,new L.Point(0,0));}else{this._initialTopLeftPoint._add(this._getMapPanePos());}
this._tileLayersToLoad=this._tileLayersNum;var loading=!this._loaded;this._loaded=true;this.fire('viewreset',{hard:!preserveMapOffset});if(loading){this.fire('load');this.eachLayer(this._layerAdd,this);}
this.fire('move');if(zoomChanged||afterZoomAnim){this.fire('zoomend');}
this.fire('moveend',{hard:!preserveMapOffset});},_rawPanBy:function(offset){L.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(offset));},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom();},_updateZoomLevels:function(){var i,minZoom=Infinity,maxZoom=-Infinity,oldZoomSpan=this._getZoomSpan();for(i in this._zoomBoundLayers){var layer=this._zoomBoundLayers[i];if(!isNaN(layer.options.minZoom)){minZoom=Math.min(minZoom,layer.options.minZoom);}
if(!isNaN(layer.options.maxZoom)){maxZoom=Math.max(maxZoom,layer.options.maxZoom);}}
if(i===undefined){this._layersMaxZoom=this._layersMinZoom=undefined;}else{this._layersMaxZoom=maxZoom;this._layersMinZoom=minZoom;}
if(oldZoomSpan!==this._getZoomSpan()){this.fire('zoomlevelschange');}},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds);},_checkIfLoaded:function(){if(!this._loaded){throw new Error('Set map center and zoom first.');}},_initEvents:function(onOff){if(!L.DomEvent){return;}
onOff=onOff||'on';L.DomEvent[onOff](this._container,'click',this._onMouseClick,this);var events=['dblclick','mousedown','mouseup','mouseenter','mouseleave','mousemove','contextmenu'],i,len;for(i=0,len=events.length;i<len;i++){L.DomEvent[onOff](this._container,events[i],this._fireMouseEvent,this);}
if(this.options.trackResize){L.DomEvent[onOff](window,'resize',this._onResize,this);}},_onResize:function(){L.Util.cancelAnimFrame(this._resizeRequest);this._resizeRequest=L.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:true});},this,false,this._container);},_onMouseClick:function(e){if(!this._loaded||(!e._simulated&&((this.dragging&&this.dragging.moved())||(this.boxZoom&&this.boxZoom.moved())))||L.DomEvent._skipped(e)){return;}
this.fire('preclick');this._fireMouseEvent(e);},_fireMouseEvent:function(e){if(!this._loaded||L.DomEvent._skipped(e)){return;}
var type=e.type;type=(type==='mouseenter'?'mouseover':(type==='mouseleave'?'mouseout':type));if(!this.hasEventListeners(type)){return;}
if(type==='contextmenu'){L.DomEvent.preventDefault(e);}
var containerPoint=this.mouseEventToContainerPoint(e),layerPoint=this.containerPointToLayerPoint(containerPoint),latlng=this.layerPointToLatLng(layerPoint);this.fire(type,{latlng:latlng,layerPoint:layerPoint,containerPoint:containerPoint,originalEvent:e});},_onTileLayerLoad:function(){this._tileLayersToLoad--;if(this._tileLayersNum&&!this._tileLayersToLoad){this.fire('tilelayersload');}},_clearHandlers:function(){for(var i=0,len=this._handlers.length;i<len;i++){this._handlers[i].disable();}},whenReady:function(callback,context){if(this._loaded){callback.call(context||this,this);}else{this.on('load',callback,context);}
return this;},_layerAdd:function(layer){layer.onAdd(this);this.fire('layeradd',{layer:layer});},_getMapPanePos:function(){return L.DomUtil.getPosition(this._mapPane);},_moved:function(){var pos=this._getMapPanePos();return pos&&!pos.equals([0,0]);},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos());},_getNewTopLeftPoint:function(center,zoom){var viewHalf=this.getSize()._divideBy(2);return this.project(center,zoom)._subtract(viewHalf)._round();},_latLngToNewLayerPoint:function(latlng,newZoom,newCenter){var topLeft=this._getNewTopLeftPoint(newCenter,newZoom).add(this._getMapPanePos());return this.project(latlng,newZoom)._subtract(topLeft);},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2));},_getCenterOffset:function(latlng){return this.latLngToLayerPoint(latlng).subtract(this._getCenterLayerPoint());},_limitCenter:function(center,zoom,bounds){if(!bounds){return center;}
var centerPoint=this.project(center,zoom),viewHalf=this.getSize().divideBy(2),viewBounds=new L.Bounds(centerPoint.subtract(viewHalf),centerPoint.add(viewHalf)),offset=this._getBoundsOffset(viewBounds,bounds,zoom);return this.unproject(centerPoint.add(offset),zoom);},_limitOffset:function(offset,bounds){if(!bounds){return offset;}
var viewBounds=this.getPixelBounds(),newBounds=new L.Bounds(viewBounds.min.add(offset),viewBounds.max.add(offset));return offset.add(this._getBoundsOffset(newBounds,bounds));},_getBoundsOffset:function(pxBounds,maxBounds,zoom){var nwOffset=this.project(maxBounds.getNorthWest(),zoom).subtract(pxBounds.min),seOffset=this.project(maxBounds.getSouthEast(),zoom).subtract(pxBounds.max),dx=this._rebound(nwOffset.x,-seOffset.x),dy=this._rebound(nwOffset.y,-seOffset.y);return new L.Point(dx,dy);},_rebound:function(left,right){return left+right>0?Math.round(left-right)/ 2:Math.max(0,Math.ceil(left))-Math.max(0,Math.floor(right));},_limitZoom:function(zoom){var min=this.getMinZoom(),max=this.getMaxZoom();return Math.max(min,Math.min(max,zoom));}});L.map=function(id,options){return new L.Map(id,options);};L.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.314245179,R_MAJOR:6378137,project:function(latlng){var d=L.LatLng.DEG_TO_RAD,max=this.MAX_LATITUDE,lat=Math.max(Math.min(max,latlng.lat),-max),r=this.R_MAJOR,r2=this.R_MINOR,x=latlng.lng*d*r,y=lat*d,tmp=r2 / r,eccent=Math.sqrt(1.0-tmp*tmp),con=eccent*Math.sin(y);con=Math.pow((1-con)/(1+con),eccent*0.5);var ts=Math.tan(0.5*((Math.PI*0.5)-y))/ con;y=-r*Math.log(ts);return new L.Point(x,y);},unproject:function(point){var d=L.LatLng.RAD_TO_DEG,r=this.R_MAJOR,r2=this.R_MINOR,lng=point.x*d / r,tmp=r2 / r,eccent=Math.sqrt(1-(tmp*tmp)),ts=Math.exp(-point.y / r),phi=(Math.PI / 2)-2*Math.atan(ts),numIter=15,tol=1e-7,i=numIter,dphi=0.1,con;while((Math.abs(dphi)>tol)&&(--i>0)){con=eccent*Math.sin(phi);dphi=(Math.PI / 2)-2*Math.atan(ts*Math.pow((1.0-con)/(1.0+con),0.5*eccent))-phi;phi+=dphi;}
return new L.LatLng(phi*d,lng);}};L.CRS.EPSG3395=L.extend({},L.CRS,{code:'EPSG:3395',projection:L.Projection.Mercator,transformation:(function(){var m=L.Projection.Mercator,r=m.R_MAJOR,scale=0.5 /(Math.PI*r);return new L.Transformation(scale,0.5,-scale,0.5);}())});L.TileLayer=L.Class.extend({includes:L.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:'abc',errorTileUrl:'',attribution:'',zoomOffset:0,opacity:1,unloadInvisibleTiles:L.Browser.mobile,updateWhenIdle:L.Browser.mobile},initialize:function(url,options){options=L.setOptions(this,options);if(options.detectRetina&&L.Browser.retina&&options.maxZoom>0){options.tileSize=Math.floor(options.tileSize / 2);options.zoomOffset++;if(options.minZoom>0){options.minZoom--;}
this.options.maxZoom--;}
if(options.bounds){options.bounds=L.latLngBounds(options.bounds);}
this._url=url;var subdomains=this.options.subdomains;if(typeof subdomains==='string'){this.options.subdomains=subdomains.split('');}},onAdd:function(map){this._map=map;this._animated=map._zoomAnimated;this._initContainer();map.on({'viewreset':this._reset,'moveend':this._update},this);if(this._animated){map.on({'zoomanim':this._animateZoom,'zoomend':this._endZoomAnim},this);}
if(!this.options.updateWhenIdle){this._limitedUpdate=L.Util.limitExecByInterval(this._update,150,this);map.on('move',this._limitedUpdate,this);}
this._reset();this._update();},addTo:function(map){map.addLayer(this);return this;},onRemove:function(map){this._container.parentNode.removeChild(this._container);map.off({'viewreset':this._reset,'moveend':this._update},this);if(this._animated){map.off({'zoomanim':this._animateZoom,'zoomend':this._endZoomAnim},this);}
if(!this.options.updateWhenIdle){map.off('move',this._limitedUpdate,this);}
this._container=null;this._map=null;},bringToFront:function(){var pane=this._map._panes.tilePane;if(this._container){pane.appendChild(this._container);this._setAutoZIndex(pane,Math.max);}
return this;},bringToBack:function(){var pane=this._map._panes.tilePane;if(this._container){pane.insertBefore(this._container,pane.firstChild);this._setAutoZIndex(pane,Math.min);}
return this;},getAttribution:function(){return this.options.attribution;},getContainer:function(){return this._container;},setOpacity:function(opacity){this.options.opacity=opacity;if(this._map){this._updateOpacity();}
return this;},setZIndex:function(zIndex){this.options.zIndex=zIndex;this._updateZIndex();return this;},setUrl:function(url,noRedraw){this._url=url;if(!noRedraw){this.redraw();}
return this;},redraw:function(){if(this._map){this._reset({hard:true});this._update();}
return this;},_updateZIndex:function(){if(this._container&&this.options.zIndex!==undefined){this._container.style.zIndex=this.options.zIndex;}},_setAutoZIndex:function(pane,compare){var layers=pane.children,edgeZIndex=-compare(Infinity,-Infinity),zIndex,i,len;for(i=0,len=layers.length;i<len;i++){if(layers[i]!==this._container){zIndex=parseInt(layers[i].style.zIndex,10);if(!isNaN(zIndex)){edgeZIndex=compare(edgeZIndex,zIndex);}}}
this.options.zIndex=this._container.style.zIndex=(isFinite(edgeZIndex)?edgeZIndex:0)+compare(1,-1);},_updateOpacity:function(){var i,tiles=this._tiles;if(L.Browser.ielt9){for(i in tiles){L.DomUtil.setOpacity(tiles[i],this.options.opacity);}}else{L.DomUtil.setOpacity(this._container,this.options.opacity);}},_initContainer:function(){var tilePane=this._map._panes.tilePane;if(!this._container){this._container=L.DomUtil.create('div','leaflet-layer');this._updateZIndex();if(this._animated){var className='leaflet-tile-container';this._bgBuffer=L.DomUtil.create('div',className,this._container);this._tileContainer=L.DomUtil.create('div',className,this._container);}else{this._tileContainer=this._container;}
tilePane.appendChild(this._container);if(this.options.opacity<1){this._updateOpacity();}}},_reset:function(e){for(var key in this._tiles){this.fire('tileunload',{tile:this._tiles[key]});}
this._tiles={};this._tilesToLoad=0;if(this.options.reuseTiles){this._unusedTiles=[];}
this._tileContainer.innerHTML='';if(this._animated&&e&&e.hard){this._clearBgBuffer();}
this._initContainer();},_getTileSize:function(){var map=this._map,zoom=map.getZoom()+this.options.zoomOffset,zoomN=this.options.maxNativeZoom,tileSize=this.options.tileSize;if(zoomN&&zoom>zoomN){tileSize=Math.round(map.getZoomScale(zoom)/ map.getZoomScale(zoomN)*tileSize);}
return tileSize;},_update:function(){if(!this._map){return;}
var map=this._map,bounds=map.getPixelBounds(),zoom=map.getZoom(),tileSize=this._getTileSize();if(zoom>this.options.maxZoom||zoom<this.options.minZoom){return;}
var tileBounds=L.bounds(bounds.min.divideBy(tileSize)._floor(),bounds.max.divideBy(tileSize)._floor());this._addTilesFromCenterOut(tileBounds);if(this.options.unloadInvisibleTiles||this.options.reuseTiles){this._removeOtherTiles(tileBounds);}},_addTilesFromCenterOut:function(bounds){var queue=[],center=bounds.getCenter();var j,i,point;for(j=bounds.min.y;j<=bounds.max.y;j++){for(i=bounds.min.x;i<=bounds.max.x;i++){point=new L.Point(i,j);if(this._tileShouldBeLoaded(point)){queue.push(point);}}}
var tilesToLoad=queue.length;if(tilesToLoad===0){return;}
queue.sort(function(a,b){return a.distanceTo(center)-b.distanceTo(center);});var fragment=document.createDocumentFragment();if(!this._tilesToLoad){this.fire('loading');}
this._tilesToLoad+=tilesToLoad;for(i=0;i<tilesToLoad;i++){this._addTile(queue[i],fragment);}
this._tileContainer.appendChild(fragment);},_tileShouldBeLoaded:function(tilePoint){if((tilePoint.x+':'+tilePoint.y)in this._tiles){return false;}
var options=this.options;if(!options.continuousWorld){var limit=this._getWrapTileNum();if((options.noWrap&&(tilePoint.x<0||tilePoint.x>=limit.x))||tilePoint.y<0||tilePoint.y>=limit.y){return false;}}
if(options.bounds){var tileSize=this._getTileSize(),nwPoint=tilePoint.multiplyBy(tileSize),sePoint=nwPoint.add([tileSize,tileSize]),nw=this._map.unproject(nwPoint),se=this._map.unproject(sePoint);if(!options.continuousWorld&&!options.noWrap){nw=nw.wrap();se=se.wrap();}
if(!options.bounds.intersects([nw,se])){return false;}}
return true;},_removeOtherTiles:function(bounds){var kArr,x,y,key;for(key in this._tiles){kArr=key.split(':');x=parseInt(kArr[0],10);y=parseInt(kArr[1],10);if(x<bounds.min.x||x>bounds.max.x||y<bounds.min.y||y>bounds.max.y){this._removeTile(key);}}},_removeTile:function(key){var tile=this._tiles[key];this.fire('tileunload',{tile:tile,url:tile.src});if(this.options.reuseTiles){L.DomUtil.removeClass(tile,'leaflet-tile-loaded');this._unusedTiles.push(tile);}else if(tile.parentNode===this._tileContainer){this._tileContainer.removeChild(tile);}
if(!L.Browser.android){tile.onload=null;tile.src=L.Util.emptyImageUrl;}
delete this._tiles[key];},_addTile:function(tilePoint,container){var tilePos=this._getTilePos(tilePoint);var tile=this._getTile();L.DomUtil.setPosition(tile,tilePos,L.Browser.chrome);this._tiles[tilePoint.x+':'+tilePoint.y]=tile;this._loadTile(tile,tilePoint);if(tile.parentNode!==this._tileContainer){container.appendChild(tile);}},_getZoomForUrl:function(){var options=this.options,zoom=this._map.getZoom();if(options.zoomReverse){zoom=options.maxZoom-zoom;}
zoom+=options.zoomOffset;return options.maxNativeZoom?Math.min(zoom,options.maxNativeZoom):zoom;},_getTilePos:function(tilePoint){var origin=this._map.getPixelOrigin(),tileSize=this._getTileSize();return tilePoint.multiplyBy(tileSize).subtract(origin);},getTileUrl:function(tilePoint){return L.Util.template(this._url,L.extend({s:this._getSubdomain(tilePoint),z:tilePoint.z,x:tilePoint.x,y:tilePoint.y},this.options));},_getWrapTileNum:function(){var crs=this._map.options.crs,size=crs.getSize(this._map.getZoom());return size.divideBy(this._getTileSize())._floor();},_adjustTilePoint:function(tilePoint){var limit=this._getWrapTileNum();if(!this.options.continuousWorld&&!this.options.noWrap){tilePoint.x=((tilePoint.x%limit.x)+limit.x)%limit.x;}
if(this.options.tms){tilePoint.y=limit.y-tilePoint.y-1;}
tilePoint.z=this._getZoomForUrl();},_getSubdomain:function(tilePoint){var index=Math.abs(tilePoint.x+tilePoint.y)%this.options.subdomains.length;return this.options.subdomains[index];},_getTile:function(){if(this.options.reuseTiles&&this._unusedTiles.length>0){var tile=this._unusedTiles.pop();this._resetTile(tile);return tile;}
return this._createTile();},_resetTile:function(){},_createTile:function(){var tile=L.DomUtil.create('img','leaflet-tile');tile.style.width=tile.style.height=this._getTileSize()+'px';tile.galleryimg='no';tile.onselectstart=tile.onmousemove=L.Util.falseFn;if(L.Browser.ielt9&&this.options.opacity!==undefined){L.DomUtil.setOpacity(tile,this.options.opacity);}
if(L.Browser.mobileWebkit3d){tile.style.WebkitBackfaceVisibility='hidden';}
return tile;},_loadTile:function(tile,tilePoint){tile._layer=this;tile.onload=this._tileOnLoad;tile.onerror=this._tileOnError;this._adjustTilePoint(tilePoint);tile.src=this.getTileUrl(tilePoint);this.fire('tileloadstart',{tile:tile,url:tile.src});},_tileLoaded:function(){this._tilesToLoad--;if(this._animated){L.DomUtil.addClass(this._tileContainer,'leaflet-zoom-animated');}
if(!this._tilesToLoad){this.fire('load');if(this._animated){clearTimeout(this._clearBgBufferTimer);this._clearBgBufferTimer=setTimeout(L.bind(this._clearBgBuffer,this),500);}}},_tileOnLoad:function(){var layer=this._layer;if(this.src!==L.Util.emptyImageUrl){L.DomUtil.addClass(this,'leaflet-tile-loaded');layer.fire('tileload',{tile:this,url:this.src});}
layer._tileLoaded();},_tileOnError:function(){var layer=this._layer;layer.fire('tileerror',{tile:this,url:this.src});var newUrl=layer.options.errorTileUrl;if(newUrl){this.src=newUrl;}
layer._tileLoaded();}});L.tileLayer=function(url,options){return new L.TileLayer(url,options);};L.TileLayer.WMS=L.TileLayer.extend({defaultWmsParams:{service:'WMS',request:'GetMap',version:'1.1.1',layers:'',styles:'',format:'image/jpeg',transparent:false},initialize:function(url,options){this._url=url;var wmsParams=L.extend({},this.defaultWmsParams),tileSize=options.tileSize||this.options.tileSize;if(options.detectRetina&&L.Browser.retina){wmsParams.width=wmsParams.height=tileSize*2;}else{wmsParams.width=wmsParams.height=tileSize;}
for(var i in options){if(!this.options.hasOwnProperty(i)&&i!=='crs'){wmsParams[i]=options[i];}}
this.wmsParams=wmsParams;L.setOptions(this,options);},onAdd:function(map){this._crs=this.options.crs||map.options.crs;this._wmsVersion=parseFloat(this.wmsParams.version);var projectionKey=this._wmsVersion>=1.3?'crs':'srs';this.wmsParams[projectionKey]=this._crs.code;L.TileLayer.prototype.onAdd.call(this,map);},getTileUrl:function(tilePoint){var map=this._map,tileSize=this.options.tileSize,nwPoint=tilePoint.multiplyBy(tileSize),sePoint=nwPoint.add([tileSize,tileSize]),nw=this._crs.project(map.unproject(nwPoint,tilePoint.z)),se=this._crs.project(map.unproject(sePoint,tilePoint.z)),bbox=this._wmsVersion>=1.3&&this._crs===L.CRS.EPSG4326?[se.y,nw.x,nw.y,se.x].join(','):[nw.x,se.y,se.x,nw.y].join(','),url=L.Util.template(this._url,{s:this._getSubdomain(tilePoint)});return url+L.Util.getParamString(this.wmsParams,url,true)+'&BBOX='+bbox;},setParams:function(params,noRedraw){L.extend(this.wmsParams,params);if(!noRedraw){this.redraw();}
return this;}});L.tileLayer.wms=function(url,options){return new L.TileLayer.WMS(url,options);};L.TileLayer.Canvas=L.TileLayer.extend({options:{async:false},initialize:function(options){L.setOptions(this,options);},redraw:function(){if(this._map){this._reset({hard:true});this._update();}
for(var i in this._tiles){this._redrawTile(this._tiles[i]);}
return this;},_redrawTile:function(tile){this.drawTile(tile,tile._tilePoint,this._map._zoom);},_createTile:function(){var tile=L.DomUtil.create('canvas','leaflet-tile');tile.width=tile.height=this.options.tileSize;tile.onselectstart=tile.onmousemove=L.Util.falseFn;return tile;},_loadTile:function(tile,tilePoint){tile._layer=this;tile._tilePoint=tilePoint;this._redrawTile(tile);if(!this.options.async){this.tileDrawn(tile);}},drawTile:function(){},tileDrawn:function(tile){this._tileOnLoad.call(tile);}});L.tileLayer.canvas=function(options){return new L.TileLayer.Canvas(options);};L.Icon=L.Class.extend({options:{className:''},initialize:function(options){L.setOptions(this,options);},createIcon:function(oldIcon){return this._createIcon('icon',oldIcon);},createShadow:function(oldIcon){return this._createIcon('shadow',oldIcon);},_createIcon:function(name,oldIcon){var src=this._getIconUrl(name);if(!src){if(name==='icon'){throw new Error('iconUrl not set in Icon options (see the docs).');}
return null;}
var img;if(!oldIcon||oldIcon.tagName!=='IMG'){img=this._createImg(src);}else{img=this._createImg(src,oldIcon);}
this._setIconStyles(img,name);return img;},_setIconStyles:function(img,name){var options=this.options,size=L.point(options[name+'Size']),anchor;if(name==='shadow'){anchor=L.point(options.shadowAnchor||options.iconAnchor);}else{anchor=L.point(options.iconAnchor);}
if(!anchor&&size){anchor=size.divideBy(2,true);}
img.className='leaflet-marker-'+name+' '+options.className;if(anchor){img.style.marginLeft=(-anchor.x)+'px';img.style.marginTop=(-anchor.y)+'px';}
if(size){img.style.width=size.x+'px';img.style.height=size.y+'px';}},_createImg:function(src,el){el=el||document.createElement('img');el.src=src;return el;},_getIconUrl:function(name){if(L.Browser.retina&&this.options[name+'RetinaUrl']){return this.options[name+'RetinaUrl'];}
return this.options[name+'Url'];}});L.icon=function(options){return new L.Icon(options);};L.Icon.Default=L.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(name){var key=name+'Url';if(this.options[key]){return this.options[key];}
if(L.Browser.retina&&name==='icon'){name+='-2x';}
var path=L.Icon.Default.imagePath;if(!path){throw new Error('Couldn\'t autodetect L.Icon.Default.imagePath, set it manually.');}
return path+'/marker-'+name+'.png';}});L.Icon.Default.imagePath=(function(){var scripts=document.getElementsByTagName('script'),leafletRe=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;var i,len,src,matches,path;for(i=0,len=scripts.length;i<len;i++){src=scripts[i].src;matches=src.match(leafletRe);if(matches){path=src.split(leafletRe)[0];return(path?path+'/':'')+'images';}}}());L.Marker=L.Class.extend({includes:L.Mixin.Events,options:{icon:new L.Icon.Default(),title:'',alt:'',clickable:true,draggable:false,keyboard:true,zIndexOffset:0,opacity:1,riseOnHover:false,riseOffset:250},initialize:function(latlng,options){L.setOptions(this,options);this._latlng=L.latLng(latlng);},onAdd:function(map){this._map=map;map.on('viewreset',this.update,this);this._initIcon();this.update();this.fire('add');if(map.options.zoomAnimation&&map.options.markerZoomAnimation){map.on('zoomanim',this._animateZoom,this);}},addTo:function(map){map.addLayer(this);return this;},onRemove:function(map){if(this.dragging){this.dragging.disable();}
this._removeIcon();this._removeShadow();this.fire('remove');map.off({'viewreset':this.update,'zoomanim':this._animateZoom},this);this._map=null;},getLatLng:function(){return this._latlng;},setLatLng:function(latlng){this._latlng=L.latLng(latlng);this.update();return this.fire('move',{latlng:this._latlng});},setZIndexOffset:function(offset){this.options.zIndexOffset=offset;this.update();return this;},setIcon:function(icon){this.options.icon=icon;if(this._map){this._initIcon();this.update();}
if(this._popup){this.bindPopup(this._popup);}
return this;},update:function(){if(this._icon){this._setPos(this._map.latLngToLayerPoint(this._latlng).round());}
return this;},_initIcon:function(){var options=this.options,map=this._map,animation=(map.options.zoomAnimation&&map.options.markerZoomAnimation),classToAdd=animation?'leaflet-zoom-animated':'leaflet-zoom-hide';var icon=options.icon.createIcon(this._icon),addIcon=false;if(icon!==this._icon){if(this._icon){this._removeIcon();}
addIcon=true;if(options.title){icon.title=options.title;}
if(options.alt){icon.alt=options.alt;}}
L.DomUtil.addClass(icon,classToAdd);if(options.keyboard){icon.tabIndex='0';}
this._icon=icon;this._initInteraction();if(options.riseOnHover){L.DomEvent.on(icon,'mouseover',this._bringToFront,this).on(icon,'mouseout',this._resetZIndex,this);}
var newShadow=options.icon.createShadow(this._shadow),addShadow=false;if(newShadow!==this._shadow){this._removeShadow();addShadow=true;}
if(newShadow){L.DomUtil.addClass(newShadow,classToAdd);}
this._shadow=newShadow;if(options.opacity<1){this._updateOpacity();}
var panes=this._map._panes;if(addIcon){panes.markerPane.appendChild(this._icon);}
if(newShadow&&addShadow){panes.shadowPane.appendChild(this._shadow);}},_removeIcon:function(){if(this.options.riseOnHover){L.DomEvent.off(this._icon,'mouseover',this._bringToFront).off(this._icon,'mouseout',this._resetZIndex);}
this._map._panes.markerPane.removeChild(this._icon);this._icon=null;},_removeShadow:function(){if(this._shadow){this._map._panes.shadowPane.removeChild(this._shadow);}
this._shadow=null;},_setPos:function(pos){L.DomUtil.setPosition(this._icon,pos);if(this._shadow){L.DomUtil.setPosition(this._shadow,pos);}
this._zIndex=pos.y+this.options.zIndexOffset;this._resetZIndex();},_updateZIndex:function(offset){this._icon.style.zIndex=this._zIndex+offset;},_animateZoom:function(opt){var pos=this._map._latLngToNewLayerPoint(this._latlng,opt.zoom,opt.center).round();this._setPos(pos);},_initInteraction:function(){if(!this.options.clickable){return;}
var icon=this._icon,events=['dblclick','mousedown','mouseover','mouseout','contextmenu'];L.DomUtil.addClass(icon,'leaflet-clickable');L.DomEvent.on(icon,'click',this._onMouseClick,this);L.DomEvent.on(icon,'keypress',this._onKeyPress,this);for(var i=0;i<events.length;i++){L.DomEvent.on(icon,events[i],this._fireMouseEvent,this);}
if(L.Handler.MarkerDrag){this.dragging=new L.Handler.MarkerDrag(this);if(this.options.draggable){this.dragging.enable();}}},_onMouseClick:function(e){var wasDragged=this.dragging&&this.dragging.moved();if(this.hasEventListeners(e.type)||wasDragged){L.DomEvent.stopPropagation(e);}
if(wasDragged){return;}
if((!this.dragging||!this.dragging._enabled)&&this._map.dragging&&this._map.dragging.moved()){return;}
this.fire(e.type,{originalEvent:e,latlng:this._latlng});},_onKeyPress:function(e){if(e.keyCode===13){this.fire('click',{originalEvent:e,latlng:this._latlng});}},_fireMouseEvent:function(e){this.fire(e.type,{originalEvent:e,latlng:this._latlng});if(e.type==='contextmenu'&&this.hasEventListeners(e.type)){L.DomEvent.preventDefault(e);}
if(e.type!=='mousedown'){L.DomEvent.stopPropagation(e);}else{L.DomEvent.preventDefault(e);}},setOpacity:function(opacity){this.options.opacity=opacity;if(this._map){this._updateOpacity();}
return this;},_updateOpacity:function(){L.DomUtil.setOpacity(this._icon,this.options.opacity);if(this._shadow){L.DomUtil.setOpacity(this._shadow,this.options.opacity);}},_bringToFront:function(){this._updateZIndex(this.options.riseOffset);},_resetZIndex:function(){this._updateZIndex(0);}});L.marker=function(latlng,options){return new L.Marker(latlng,options);};L.DivIcon=L.Icon.extend({options:{iconSize:[12,12],className:'leaflet-div-icon',html:false},createIcon:function(oldIcon){var div=(oldIcon&&oldIcon.tagName==='DIV')?oldIcon:document.createElement('div'),options=this.options;if(options.html!==false){div.innerHTML=options.html;}else{div.innerHTML='';}
if(options.bgPos){div.style.backgroundPosition=(-options.bgPos.x)+'px '+(-options.bgPos.y)+'px';}
this._setIconStyles(div,'icon');return div;},createShadow:function(){return null;}});L.divIcon=function(options){return new L.DivIcon(options);};L.Map.mergeOptions({closePopupOnClick:true});L.Popup=L.Class.extend({includes:L.Mixin.Events,options:{minWidth:50,maxWidth:300,autoPan:true,closeButton:true,offset:[0,7],autoPanPadding:[5,5],keepInView:false,className:'',zoomAnimation:true},initialize:function(options,source){L.setOptions(this,options);this._source=source;this._animated=L.Browser.any3d&&this.options.zoomAnimation;this._isOpen=false;},onAdd:function(map){this._map=map;if(!this._container){this._initLayout();}
var animFade=map.options.fadeAnimation;if(animFade){L.DomUtil.setOpacity(this._container,0);}
map._panes.popupPane.appendChild(this._container);map.on(this._getEvents(),this);this.update();if(animFade){L.DomUtil.setOpacity(this._container,1);}
this.fire('open');map.fire('popupopen',{popup:this});if(this._source){this._source.fire('popupopen',{popup:this});}},addTo:function(map){map.addLayer(this);return this;},openOn:function(map){map.openPopup(this);return this;},onRemove:function(map){map._panes.popupPane.removeChild(this._container);L.Util.falseFn(this._container.offsetWidth);map.off(this._getEvents(),this);if(map.options.fadeAnimation){L.DomUtil.setOpacity(this._container,0);}
this._map=null;this.fire('close');map.fire('popupclose',{popup:this});if(this._source){this._source.fire('popupclose',{popup:this});}},getLatLng:function(){return this._latlng;},setLatLng:function(latlng){this._latlng=L.latLng(latlng);if(this._map){this._updatePosition();this._adjustPan();}
return this;},getContent:function(){return this._content;},setContent:function(content){this._content=content;this.update();return this;},update:function(){if(!this._map){return;}
this._container.style.visibility='hidden';this._updateContent();this._updateLayout();this._updatePosition();this._container.style.visibility='';this._adjustPan();},_getEvents:function(){var events={viewreset:this._updatePosition};if(this._animated){events.zoomanim=this._zoomAnimation;}
if('closeOnClick'in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick){events.preclick=this._close;}
if(this.options.keepInView){events.moveend=this._adjustPan;}
return events;},_close:function(){if(this._map){this._map.closePopup(this);}},_initLayout:function(){var prefix='leaflet-popup',containerClass=prefix+' '+this.options.className+' leaflet-zoom-'+
(this._animated?'animated':'hide'),container=this._container=L.DomUtil.create('div',containerClass),closeButton;if(this.options.closeButton){closeButton=this._closeButton=L.DomUtil.create('a',prefix+'-close-button',container);closeButton.href='#close';closeButton.innerHTML='&#215;';L.DomEvent.disableClickPropagation(closeButton);L.DomEvent.on(closeButton,'click',this._onCloseButtonClick,this);}
var wrapper=this._wrapper=L.DomUtil.create('div',prefix+'-content-wrapper',container);L.DomEvent.disableClickPropagation(wrapper);this._contentNode=L.DomUtil.create('div',prefix+'-content',wrapper);L.DomEvent.disableScrollPropagation(this._contentNode);L.DomEvent.on(wrapper,'contextmenu',L.DomEvent.stopPropagation);this._tipContainer=L.DomUtil.create('div',prefix+'-tip-container',container);this._tip=L.DomUtil.create('div',prefix+'-tip',this._tipContainer);},_updateContent:function(){if(!this._content){return;}
if(typeof this._content==='string'){this._contentNode.innerHTML=this._content;}else{while(this._contentNode.hasChildNodes()){this._contentNode.removeChild(this._contentNode.firstChild);}
this._contentNode.appendChild(this._content);}
this.fire('contentupdate');},_updateLayout:function(){var container=this._contentNode,style=container.style;style.width='';style.whiteSpace='nowrap';var width=container.offsetWidth;width=Math.min(width,this.options.maxWidth);width=Math.max(width,this.options.minWidth);style.width=(width+1)+'px';style.whiteSpace='';style.height='';var height=container.offsetHeight,maxHeight=this.options.maxHeight,scrolledClass='leaflet-popup-scrolled';if(maxHeight&&height>maxHeight){style.height=maxHeight+'px';L.DomUtil.addClass(container,scrolledClass);}else{L.DomUtil.removeClass(container,scrolledClass);}
this._containerWidth=this._container.offsetWidth;},_updatePosition:function(){if(!this._map){return;}
var pos=this._map.latLngToLayerPoint(this._latlng),animated=this._animated,offset=L.point(this.options.offset);if(animated){L.DomUtil.setPosition(this._container,pos);}
this._containerBottom=-offset.y-(animated?0:pos.y);this._containerLeft=-Math.round(this._containerWidth / 2)+offset.x+(animated?0:pos.x);this._container.style.bottom=this._containerBottom+'px';this._container.style.left=this._containerLeft+'px';},_zoomAnimation:function(opt){var pos=this._map._latLngToNewLayerPoint(this._latlng,opt.zoom,opt.center);L.DomUtil.setPosition(this._container,pos);},_adjustPan:function(){if(!this.options.autoPan){return;}
var map=this._map,containerHeight=this._container.offsetHeight,containerWidth=this._containerWidth,layerPos=new L.Point(this._containerLeft,-containerHeight-this._containerBottom);if(this._animated){layerPos._add(L.DomUtil.getPosition(this._container));}
var containerPos=map.layerPointToContainerPoint(layerPos),padding=L.point(this.options.autoPanPadding),paddingTL=L.point(this.options.autoPanPaddingTopLeft||padding),paddingBR=L.point(this.options.autoPanPaddingBottomRight||padding),size=map.getSize(),dx=0,dy=0;if(containerPos.x+containerWidth+paddingBR.x>size.x){dx=containerPos.x+containerWidth-size.x+paddingBR.x;}
if(containerPos.x-dx-paddingTL.x<0){dx=containerPos.x-paddingTL.x;}
if(containerPos.y+containerHeight+paddingBR.y>size.y){dy=containerPos.y+containerHeight-size.y+paddingBR.y;}
if(containerPos.y-dy-paddingTL.y<0){dy=containerPos.y-paddingTL.y;}
if(dx||dy){map.fire('autopanstart').panBy([dx,dy]);}},_onCloseButtonClick:function(e){this._close();L.DomEvent.stop(e);}});L.popup=function(options,source){return new L.Popup(options,source);};L.Map.include({openPopup:function(popup,latlng,options){this.closePopup();if(!(popup instanceof L.Popup)){var content=popup;popup=new L.Popup(options).setLatLng(latlng).setContent(content);}
popup._isOpen=true;this._popup=popup;return this.addLayer(popup);},closePopup:function(popup){if(!popup||popup===this._popup){popup=this._popup;this._popup=null;}
if(popup){this.removeLayer(popup);popup._isOpen=false;}
return this;}});L.LayerGroup=L.Class.extend({initialize:function(layers){this._layers={};var i,len;if(layers){for(i=0,len=layers.length;i<len;i++){this.addLayer(layers[i]);}}},addLayer:function(layer){var id=this.getLayerId(layer);this._layers[id]=layer;if(this._map){this._map.addLayer(layer);}
return this;},removeLayer:function(layer){var id=layer in this._layers?layer:this.getLayerId(layer);if(this._map&&this._layers[id]){this._map.removeLayer(this._layers[id]);}
delete this._layers[id];return this;},hasLayer:function(layer){if(!layer){return false;}
return(layer in this._layers||this.getLayerId(layer)in this._layers);},clearLayers:function(){this.eachLayer(this.removeLayer,this);return this;},invoke:function(methodName){var args=Array.prototype.slice.call(arguments,1),i,layer;for(i in this._layers){layer=this._layers[i];if(layer[methodName]){layer[methodName].apply(layer,args);}}
return this;},onAdd:function(map){this._map=map;this.eachLayer(map.addLayer,map);},onRemove:function(map){this.eachLayer(map.removeLayer,map);this._map=null;},addTo:function(map){map.addLayer(this);return this;},eachLayer:function(method,context){for(var i in this._layers){method.call(context,this._layers[i]);}
return this;},getLayer:function(id){return this._layers[id];},getLayers:function(){var layers=[];for(var i in this._layers){layers.push(this._layers[i]);}
return layers;},setZIndex:function(zIndex){return this.invoke('setZIndex',zIndex);},getLayerId:function(layer){return L.stamp(layer);}});L.layerGroup=function(layers){return new L.LayerGroup(layers);};L.FeatureGroup=L.LayerGroup.extend({includes:L.Mixin.Events,statics:{EVENTS:'click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose'},addLayer:function(layer){if(this.hasLayer(layer)){return this;}
if('on'in layer){layer.on(L.FeatureGroup.EVENTS,this._propagateEvent,this);}
L.LayerGroup.prototype.addLayer.call(this,layer);if(this._popupContent&&layer.bindPopup){layer.bindPopup(this._popupContent,this._popupOptions);}
return this.fire('layeradd',{layer:layer});},removeLayer:function(layer){if(!this.hasLayer(layer)){return this;}
if(layer in this._layers){layer=this._layers[layer];}
layer.off(L.FeatureGroup.EVENTS,this._propagateEvent,this);L.LayerGroup.prototype.removeLayer.call(this,layer);if(this._popupContent){this.invoke('unbindPopup');}
return this.fire('layerremove',{layer:layer});},bindPopup:function(content,options){this._popupContent=content;this._popupOptions=options;return this.invoke('bindPopup',content,options);},openPopup:function(latlng){for(var id in this._layers){this._layers[id].openPopup(latlng);break;}
return this;},setStyle:function(style){return this.invoke('setStyle',style);},bringToFront:function(){return this.invoke('bringToFront');},bringToBack:function(){return this.invoke('bringToBack');},getBounds:function(){var bounds=new L.LatLngBounds();this.eachLayer(function(layer){bounds.extend(layer instanceof L.Marker?layer.getLatLng():layer.getBounds());});return bounds;},_propagateEvent:function(e){e=L.extend({layer:e.target,target:this},e);this.fire(e.type,e);}});L.featureGroup=function(layers){return new L.FeatureGroup(layers);};L.Path=L.Class.extend({includes:[L.Mixin.Events],statics:{CLIP_PADDING:(function(){var max=L.Browser.mobile?1280:2000,target=(max / Math.max(window.outerWidth,window.outerHeight)-1)/ 2;return Math.max(0,Math.min(0.5,target));})()},options:{stroke:true,color:'#0033ff',dashArray:null,lineCap:null,lineJoin:null,weight:5,opacity:0.5,fill:false,fillColor:null,fillOpacity:0.2,clickable:true},initialize:function(options){L.setOptions(this,options);},onAdd:function(map){this._map=map;if(!this._container){this._initElements();this._initEvents();}
this.projectLatlngs();this._updatePath();if(this._container){this._map._pathRoot.appendChild(this._container);}
this.fire('add');map.on({'viewreset':this.projectLatlngs,'moveend':this._updatePath},this);},addTo:function(map){map.addLayer(this);return this;},onRemove:function(map){map._pathRoot.removeChild(this._container);this.fire('remove');this._map=null;if(L.Browser.vml){this._container=null;this._stroke=null;this._fill=null;}
map.off({'viewreset':this.projectLatlngs,'moveend':this._updatePath},this);},projectLatlngs:function(){},setStyle:function(style){L.setOptions(this,style);if(this._container){this._updateStyle();}
return this;},redraw:function(){if(this._map){this.projectLatlngs();this._updatePath();}
return this;}});L.Map.include({_updatePathViewport:function(){var p=L.Path.CLIP_PADDING,size=this.getSize(),panePos=L.DomUtil.getPosition(this._mapPane),min=panePos.multiplyBy(-1)._subtract(size.multiplyBy(p)._round()),max=min.add(size.multiplyBy(1+p*2)._round());this._pathViewport=new L.Bounds(min,max);}});L.Path.SVG_NS='http://www.w3.org/2000/svg';L.Browser.svg=!!(document.createElementNS&&document.createElementNS(L.Path.SVG_NS,'svg').createSVGRect);L.Path=L.Path.extend({statics:{SVG:L.Browser.svg},bringToFront:function(){var root=this._map._pathRoot,path=this._container;if(path&&root.lastChild!==path){root.appendChild(path);}
return this;},bringToBack:function(){var root=this._map._pathRoot,path=this._container,first=root.firstChild;if(path&&first!==path){root.insertBefore(path,first);}
return this;},getPathString:function(){},_createElement:function(name){return document.createElementNS(L.Path.SVG_NS,name);},_initElements:function(){this._map._initPathRoot();this._initPath();this._initStyle();},_initPath:function(){this._container=this._createElement('g');this._path=this._createElement('path');if(this.options.className){L.DomUtil.addClass(this._path,this.options.className);}
this._container.appendChild(this._path);},_initStyle:function(){if(this.options.stroke){this._path.setAttribute('stroke-linejoin','round');this._path.setAttribute('stroke-linecap','round');}
if(this.options.fill){this._path.setAttribute('fill-rule','evenodd');}
if(this.options.pointerEvents){this._path.setAttribute('pointer-events',this.options.pointerEvents);}
if(!this.options.clickable&&!this.options.pointerEvents){this._path.setAttribute('pointer-events','none');}
this._updateStyle();},_updateStyle:function(){if(this.options.stroke){this._path.setAttribute('stroke',this.options.color);this._path.setAttribute('stroke-opacity',this.options.opacity);this._path.setAttribute('stroke-width',this.options.weight);if(this.options.dashArray){this._path.setAttribute('stroke-dasharray',this.options.dashArray);}else{this._path.removeAttribute('stroke-dasharray');}
if(this.options.lineCap){this._path.setAttribute('stroke-linecap',this.options.lineCap);}
if(this.options.lineJoin){this._path.setAttribute('stroke-linejoin',this.options.lineJoin);}}else{this._path.setAttribute('stroke','none');}
if(this.options.fill){this._path.setAttribute('fill',this.options.fillColor||this.options.color);this._path.setAttribute('fill-opacity',this.options.fillOpacity);}else{this._path.setAttribute('fill','none');}},_updatePath:function(){var str=this.getPathString();if(!str){str='M0 0';}
this._path.setAttribute('d',str);},_initEvents:function(){if(this.options.clickable){if(L.Browser.svg||!L.Browser.vml){L.DomUtil.addClass(this._path,'leaflet-clickable');}
L.DomEvent.on(this._container,'click',this._onMouseClick,this);var events=['dblclick','mousedown','mouseover','mouseout','mousemove','contextmenu'];for(var i=0;i<events.length;i++){L.DomEvent.on(this._container,events[i],this._fireMouseEvent,this);}}},_onMouseClick:function(e){if(this._map.dragging&&this._map.dragging.moved()){return;}
this._fireMouseEvent(e);},_fireMouseEvent:function(e){if(!this.hasEventListeners(e.type)){return;}
var map=this._map,containerPoint=map.mouseEventToContainerPoint(e),layerPoint=map.containerPointToLayerPoint(containerPoint),latlng=map.layerPointToLatLng(layerPoint);this.fire(e.type,{latlng:latlng,layerPoint:layerPoint,containerPoint:containerPoint,originalEvent:e});if(e.type==='contextmenu'){L.DomEvent.preventDefault(e);}
if(e.type!=='mousemove'){L.DomEvent.stopPropagation(e);}}});L.Map.include({_initPathRoot:function(){if(!this._pathRoot){this._pathRoot=L.Path.prototype._createElement('svg');this._panes.overlayPane.appendChild(this._pathRoot);if(this.options.zoomAnimation&&L.Browser.any3d){L.DomUtil.addClass(this._pathRoot,'leaflet-zoom-animated');this.on({'zoomanim':this._animatePathZoom,'zoomend':this._endPathZoom});}else{L.DomUtil.addClass(this._pathRoot,'leaflet-zoom-hide');}
this.on('moveend',this._updateSvgViewport);this._updateSvgViewport();}},_animatePathZoom:function(e){var scale=this.getZoomScale(e.zoom),offset=this._getCenterOffset(e.center)._multiplyBy(-scale)._add(this._pathViewport.min);this._pathRoot.style[L.DomUtil.TRANSFORM]=L.DomUtil.getTranslateString(offset)+' scale('+scale+') ';this._pathZooming=true;},_endPathZoom:function(){this._pathZooming=false;},_updateSvgViewport:function(){if(this._pathZooming){return;}
this._updatePathViewport();var vp=this._pathViewport,min=vp.min,max=vp.max,width=max.x-min.x,height=max.y-min.y,root=this._pathRoot,pane=this._panes.overlayPane;if(L.Browser.mobileWebkit){pane.removeChild(root);}
L.DomUtil.setPosition(root,min);root.setAttribute('width',width);root.setAttribute('height',height);root.setAttribute('viewBox',[min.x,min.y,width,height].join(' '));if(L.Browser.mobileWebkit){pane.appendChild(root);}}});L.Browser.vml=!L.Browser.svg&&(function(){try{var div=document.createElement('div');div.innerHTML='<v:shape adj="1"/>';var shape=div.firstChild;shape.style.behavior='url(#default#VML)';return shape&&(typeof shape.adj==='object');}catch(e){return false;}}());L.Path=L.Browser.svg||!L.Browser.vml?L.Path:L.Path.extend({statics:{VML:true,CLIP_PADDING:0.02},_createElement:(function(){try{document.namespaces.add('lvml','urn:schemas-microsoft-com:vml');return function(name){return document.createElement('<lvml:'+name+' class="lvml">');};}catch(e){return function(name){return document.createElement('<'+name+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">');};}}()),_initPath:function(){var container=this._container=this._createElement('shape');L.DomUtil.addClass(container,'leaflet-vml-shape'+
(this.options.className?' '+this.options.className:''));if(this.options.clickable){L.DomUtil.addClass(container,'leaflet-clickable');}
container.coordsize='1 1';this._path=this._createElement('path');container.appendChild(this._path);this._map._pathRoot.appendChild(container);},_initStyle:function(){this._updateStyle();},_updateStyle:function(){var stroke=this._stroke,fill=this._fill,options=this.options,container=this._container;container.stroked=options.stroke;container.filled=options.fill;if(options.stroke){if(!stroke){stroke=this._stroke=this._createElement('stroke');stroke.endcap='round';container.appendChild(stroke);}
stroke.weight=options.weight+'px';stroke.color=options.color;stroke.opacity=options.opacity;if(options.dashArray){stroke.dashStyle=L.Util.isArray(options.dashArray)?options.dashArray.join(' '):options.dashArray.replace(/( *, *)/g,' ');}else{stroke.dashStyle='';}
if(options.lineCap){stroke.endcap=options.lineCap.replace('butt','flat');}
if(options.lineJoin){stroke.joinstyle=options.lineJoin;}}else if(stroke){container.removeChild(stroke);this._stroke=null;}
if(options.fill){if(!fill){fill=this._fill=this._createElement('fill');container.appendChild(fill);}
fill.color=options.fillColor||options.color;fill.opacity=options.fillOpacity;}else if(fill){container.removeChild(fill);this._fill=null;}},_updatePath:function(){var style=this._container.style;style.display='none';this._path.v=this.getPathString()+' ';style.display='';}});L.Map.include(L.Browser.svg||!L.Browser.vml?{}:{_initPathRoot:function(){if(this._pathRoot){return;}
var root=this._pathRoot=document.createElement('div');root.className='leaflet-vml-container';this._panes.overlayPane.appendChild(root);this.on('moveend',this._updatePathViewport);this._updatePathViewport();}});L.Browser.canvas=(function(){return!!document.createElement('canvas').getContext;}());L.Path=(L.Path.SVG&&!window.L_PREFER_CANVAS)||!L.Browser.canvas?L.Path:L.Path.extend({statics:{CANVAS:true,SVG:false},redraw:function(){if(this._map){this.projectLatlngs();this._requestUpdate();}
return this;},setStyle:function(style){L.setOptions(this,style);if(this._map){this._updateStyle();this._requestUpdate();}
return this;},onRemove:function(map){map.off('viewreset',this.projectLatlngs,this).off('moveend',this._updatePath,this);if(this.options.clickable){this._map.off('click',this._onClick,this);this._map.off('mousemove',this._onMouseMove,this);}
this._requestUpdate();this.fire('remove');this._map=null;},_requestUpdate:function(){if(this._map&&!L.Path._updateRequest){L.Path._updateRequest=L.Util.requestAnimFrame(this._fireMapMoveEnd,this._map);}},_fireMapMoveEnd:function(){L.Path._updateRequest=null;this.fire('moveend');},_initElements:function(){this._map._initPathRoot();this._ctx=this._map._canvasCtx;},_updateStyle:function(){var options=this.options;if(options.stroke){this._ctx.lineWidth=options.weight;this._ctx.strokeStyle=options.color;}
if(options.fill){this._ctx.fillStyle=options.fillColor||options.color;}
if(options.lineCap){this._ctx.lineCap=options.lineCap;}
if(options.lineJoin){this._ctx.lineJoin=options.lineJoin;}},_drawPath:function(){var i,j,len,len2,point,drawMethod;this._ctx.beginPath();for(i=0,len=this._parts.length;i<len;i++){for(j=0,len2=this._parts[i].length;j<len2;j++){point=this._parts[i][j];drawMethod=(j===0?'move':'line')+'To';this._ctx[drawMethod](point.x,point.y);}
if(this instanceof L.Polygon){this._ctx.closePath();}}},_checkIfEmpty:function(){return!this._parts.length;},_updatePath:function(){if(this._checkIfEmpty()){return;}
var ctx=this._ctx,options=this.options;this._drawPath();ctx.save();this._updateStyle();if(options.fill){ctx.globalAlpha=options.fillOpacity;ctx.fill(options.fillRule||'evenodd');}
if(options.stroke){ctx.globalAlpha=options.opacity;ctx.stroke();}
ctx.restore();},_initEvents:function(){if(this.options.clickable){this._map.on('mousemove',this._onMouseMove,this);this._map.on('click dblclick contextmenu',this._fireMouseEvent,this);}},_fireMouseEvent:function(e){if(this._containsPoint(e.layerPoint)){this.fire(e.type,e);}},_onMouseMove:function(e){if(!this._map||this._map._animatingZoom){return;}
if(this._containsPoint(e.layerPoint)){this._ctx.canvas.style.cursor='pointer';this._mouseInside=true;this.fire('mouseover',e);}else if(this._mouseInside){this._ctx.canvas.style.cursor='';this._mouseInside=false;this.fire('mouseout',e);}}});L.Map.include((L.Path.SVG&&!window.L_PREFER_CANVAS)||!L.Browser.canvas?{}:{_initPathRoot:function(){var root=this._pathRoot,ctx;if(!root){root=this._pathRoot=document.createElement('canvas');root.style.position='absolute';ctx=this._canvasCtx=root.getContext('2d');ctx.lineCap='round';ctx.lineJoin='round';this._panes.overlayPane.appendChild(root);if(this.options.zoomAnimation){this._pathRoot.className='leaflet-zoom-animated';this.on('zoomanim',this._animatePathZoom);this.on('zoomend',this._endPathZoom);}
this.on('moveend',this._updateCanvasViewport);this._updateCanvasViewport();}},_updateCanvasViewport:function(){if(this._pathZooming){return;}
this._updatePathViewport();var vp=this._pathViewport,min=vp.min,size=vp.max.subtract(min),root=this._pathRoot;L.DomUtil.setPosition(root,min);root.width=size.x;root.height=size.y;root.getContext('2d').translate(-min.x,-min.y);}});L.LineUtil={simplify:function(points,tolerance){if(!tolerance||!points.length){return points.slice();}
var sqTolerance=tolerance*tolerance;points=this._reducePoints(points,sqTolerance);points=this._simplifyDP(points,sqTolerance);return points;},pointToSegmentDistance:function(p,p1,p2){return Math.sqrt(this._sqClosestPointOnSegment(p,p1,p2,true));},closestPointOnSegment:function(p,p1,p2){return this._sqClosestPointOnSegment(p,p1,p2);},_simplifyDP:function(points,sqTolerance){var len=points.length,ArrayConstructor=typeof Uint8Array!==undefined+''?Uint8Array:Array,markers=new ArrayConstructor(len);markers[0]=markers[len-1]=1;this._simplifyDPStep(points,markers,sqTolerance,0,len-1);var i,newPoints=[];for(i=0;i<len;i++){if(markers[i]){newPoints.push(points[i]);}}
return newPoints;},_simplifyDPStep:function(points,markers,sqTolerance,first,last){var maxSqDist=0,index,i,sqDist;for(i=first+1;i<=last-1;i++){sqDist=this._sqClosestPointOnSegment(points[i],points[first],points[last],true);if(sqDist>maxSqDist){index=i;maxSqDist=sqDist;}}
if(maxSqDist>sqTolerance){markers[index]=1;this._simplifyDPStep(points,markers,sqTolerance,first,index);this._simplifyDPStep(points,markers,sqTolerance,index,last);}},_reducePoints:function(points,sqTolerance){var reducedPoints=[points[0]];for(var i=1,prev=0,len=points.length;i<len;i++){if(this._sqDist(points[i],points[prev])>sqTolerance){reducedPoints.push(points[i]);prev=i;}}
if(prev<len-1){reducedPoints.push(points[len-1]);}
return reducedPoints;},clipSegment:function(a,b,bounds,useLastCode){var codeA=useLastCode?this._lastCode:this._getBitCode(a,bounds),codeB=this._getBitCode(b,bounds),codeOut,p,newCode;this._lastCode=codeB;while(true){if(!(codeA|codeB)){return[a,b];}else if(codeA&codeB){return false;}else{codeOut=codeA||codeB;p=this._getEdgeIntersection(a,b,codeOut,bounds);newCode=this._getBitCode(p,bounds);if(codeOut===codeA){a=p;codeA=newCode;}else{b=p;codeB=newCode;}}}},_getEdgeIntersection:function(a,b,code,bounds){var dx=b.x-a.x,dy=b.y-a.y,min=bounds.min,max=bounds.max;if(code&8){return new L.Point(a.x+dx*(max.y-a.y)/ dy,max.y);}else if(code&4){return new L.Point(a.x+dx*(min.y-a.y)/ dy,min.y);}else if(code&2){return new L.Point(max.x,a.y+dy*(max.x-a.x)/ dx);}else if(code&1){return new L.Point(min.x,a.y+dy*(min.x-a.x)/ dx);}},_getBitCode:function(p,bounds){var code=0;if(p.x<bounds.min.x){code|=1;}else if(p.x>bounds.max.x){code|=2;}
if(p.y<bounds.min.y){code|=4;}else if(p.y>bounds.max.y){code|=8;}
return code;},_sqDist:function(p1,p2){var dx=p2.x-p1.x,dy=p2.y-p1.y;return dx*dx+dy*dy;},_sqClosestPointOnSegment:function(p,p1,p2,sqDist){var x=p1.x,y=p1.y,dx=p2.x-x,dy=p2.y-y,dot=dx*dx+dy*dy,t;if(dot>0){t=((p.x-x)*dx+(p.y-y)*dy)/ dot;if(t>1){x=p2.x;y=p2.y;}else if(t>0){x+=dx*t;y+=dy*t;}}
dx=p.x-x;dy=p.y-y;return sqDist?dx*dx+dy*dy:new L.Point(x,y);}};L.Polyline=L.Path.extend({initialize:function(latlngs,options){L.Path.prototype.initialize.call(this,options);this._latlngs=this._convertLatLngs(latlngs);},options:{smoothFactor:1.0,noClip:false},projectLatlngs:function(){this._originalPoints=[];for(var i=0,len=this._latlngs.length;i<len;i++){this._originalPoints[i]=this._map.latLngToLayerPoint(this._latlngs[i]);}},getPathString:function(){for(var i=0,len=this._parts.length,str='';i<len;i++){str+=this._getPathPartStr(this._parts[i]);}
return str;},getLatLngs:function(){return this._latlngs;},setLatLngs:function(latlngs){this._latlngs=this._convertLatLngs(latlngs);return this.redraw();},addLatLng:function(latlng){this._latlngs.push(L.latLng(latlng));return this.redraw();},spliceLatLngs:function(){var removed=[].splice.apply(this._latlngs,arguments);this._convertLatLngs(this._latlngs,true);this.redraw();return removed;},closestLayerPoint:function(p){var minDistance=Infinity,parts=this._parts,p1,p2,minPoint=null;for(var j=0,jLen=parts.length;j<jLen;j++){var points=parts[j];for(var i=1,len=points.length;i<len;i++){p1=points[i-1];p2=points[i];var sqDist=L.LineUtil._sqClosestPointOnSegment(p,p1,p2,true);if(sqDist<minDistance){minDistance=sqDist;minPoint=L.LineUtil._sqClosestPointOnSegment(p,p1,p2);}}}
if(minPoint){minPoint.distance=Math.sqrt(minDistance);}
return minPoint;},getBounds:function(){return new L.LatLngBounds(this.getLatLngs());},_convertLatLngs:function(latlngs,overwrite){var i,len,target=overwrite?latlngs:[];for(i=0,len=latlngs.length;i<len;i++){if(L.Util.isArray(latlngs[i])&&typeof latlngs[i][0]!=='number'){return;}
target[i]=L.latLng(latlngs[i]);}
return target;},_initEvents:function(){L.Path.prototype._initEvents.call(this);},_getPathPartStr:function(points){var round=L.Path.VML;for(var j=0,len2=points.length,str='',p;j<len2;j++){p=points[j];if(round){p._round();}
str+=(j?'L':'M')+p.x+' '+p.y;}
return str;},_clipPoints:function(){var points=this._originalPoints,len=points.length,i,k,segment;if(this.options.noClip){this._parts=[points];return;}
this._parts=[];var parts=this._parts,vp=this._map._pathViewport,lu=L.LineUtil;for(i=0,k=0;i<len-1;i++){segment=lu.clipSegment(points[i],points[i+1],vp,i);if(!segment){continue;}
parts[k]=parts[k]||[];parts[k].push(segment[0]);if((segment[1]!==points[i+1])||(i===len-2)){parts[k].push(segment[1]);k++;}}},_simplifyPoints:function(){var parts=this._parts,lu=L.LineUtil;for(var i=0,len=parts.length;i<len;i++){parts[i]=lu.simplify(parts[i],this.options.smoothFactor);}},_updatePath:function(){if(!this._map){return;}
this._clipPoints();this._simplifyPoints();L.Path.prototype._updatePath.call(this);}});L.polyline=function(latlngs,options){return new L.Polyline(latlngs,options);};L.PolyUtil={};L.PolyUtil.clipPolygon=function(points,bounds){var clippedPoints,edges=[1,4,2,8],i,j,k,a,b,len,edge,p,lu=L.LineUtil;for(i=0,len=points.length;i<len;i++){points[i]._code=lu._getBitCode(points[i],bounds);}
for(k=0;k<4;k++){edge=edges[k];clippedPoints=[];for(i=0,len=points.length,j=len-1;i<len;j=i++){a=points[i];b=points[j];if(!(a._code&edge)){if(b._code&edge){p=lu._getEdgeIntersection(b,a,edge,bounds);p._code=lu._getBitCode(p,bounds);clippedPoints.push(p);}
clippedPoints.push(a);}else if(!(b._code&edge)){p=lu._getEdgeIntersection(b,a,edge,bounds);p._code=lu._getBitCode(p,bounds);clippedPoints.push(p);}}
points=clippedPoints;}
return points;};L.Polygon=L.Polyline.extend({options:{fill:true},initialize:function(latlngs,options){L.Polyline.prototype.initialize.call(this,latlngs,options);this._initWithHoles(latlngs);},_initWithHoles:function(latlngs){var i,len,hole;if(latlngs&&L.Util.isArray(latlngs[0])&&(typeof latlngs[0][0]!=='number')){this._latlngs=this._convertLatLngs(latlngs[0]);this._holes=latlngs.slice(1);for(i=0,len=this._holes.length;i<len;i++){hole=this._holes[i]=this._convertLatLngs(this._holes[i]);if(hole[0].equals(hole[hole.length-1])){hole.pop();}}}
latlngs=this._latlngs;if(latlngs.length>=2&&latlngs[0].equals(latlngs[latlngs.length-1])){latlngs.pop();}},projectLatlngs:function(){L.Polyline.prototype.projectLatlngs.call(this);this._holePoints=[];if(!this._holes){return;}
var i,j,len,len2;for(i=0,len=this._holes.length;i<len;i++){this._holePoints[i]=[];for(j=0,len2=this._holes[i].length;j<len2;j++){this._holePoints[i][j]=this._map.latLngToLayerPoint(this._holes[i][j]);}}},setLatLngs:function(latlngs){if(latlngs&&L.Util.isArray(latlngs[0])&&(typeof latlngs[0][0]!=='number')){this._initWithHoles(latlngs);return this.redraw();}else{return L.Polyline.prototype.setLatLngs.call(this,latlngs);}},_clipPoints:function(){var points=this._originalPoints,newParts=[];this._parts=[points].concat(this._holePoints);if(this.options.noClip){return;}
for(var i=0,len=this._parts.length;i<len;i++){var clipped=L.PolyUtil.clipPolygon(this._parts[i],this._map._pathViewport);if(clipped.length){newParts.push(clipped);}}
this._parts=newParts;},_getPathPartStr:function(points){var str=L.Polyline.prototype._getPathPartStr.call(this,points);return str+(L.Browser.svg?'z':'x');}});L.polygon=function(latlngs,options){return new L.Polygon(latlngs,options);};(function(){function createMulti(Klass){return L.FeatureGroup.extend({initialize:function(latlngs,options){this._layers={};this._options=options;this.setLatLngs(latlngs);},setLatLngs:function(latlngs){var i=0,len=latlngs.length;this.eachLayer(function(layer){if(i<len){layer.setLatLngs(latlngs[i++]);}else{this.removeLayer(layer);}},this);while(i<len){this.addLayer(new Klass(latlngs[i++],this._options));}
return this;},getLatLngs:function(){var latlngs=[];this.eachLayer(function(layer){latlngs.push(layer.getLatLngs());});return latlngs;}});}
L.MultiPolyline=createMulti(L.Polyline);L.MultiPolygon=createMulti(L.Polygon);L.multiPolyline=function(latlngs,options){return new L.MultiPolyline(latlngs,options);};L.multiPolygon=function(latlngs,options){return new L.MultiPolygon(latlngs,options);};}());L.Rectangle=L.Polygon.extend({initialize:function(latLngBounds,options){L.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(latLngBounds),options);},setBounds:function(latLngBounds){this.setLatLngs(this._boundsToLatLngs(latLngBounds));},_boundsToLatLngs:function(latLngBounds){latLngBounds=L.latLngBounds(latLngBounds);return[latLngBounds.getSouthWest(),latLngBounds.getNorthWest(),latLngBounds.getNorthEast(),latLngBounds.getSouthEast()];}});L.rectangle=function(latLngBounds,options){return new L.Rectangle(latLngBounds,options);};L.Circle=L.Path.extend({initialize:function(latlng,radius,options){L.Path.prototype.initialize.call(this,options);this._latlng=L.latLng(latlng);this._mRadius=radius;},options:{fill:true},setLatLng:function(latlng){this._latlng=L.latLng(latlng);return this.redraw();},setRadius:function(radius){this._mRadius=radius;return this.redraw();},projectLatlngs:function(){var lngRadius=this._getLngRadius(),latlng=this._latlng,pointLeft=this._map.latLngToLayerPoint([latlng.lat,latlng.lng-lngRadius]);this._point=this._map.latLngToLayerPoint(latlng);this._radius=Math.max(this._point.x-pointLeft.x,1);},getBounds:function(){var lngRadius=this._getLngRadius(),latRadius=(this._mRadius / 40075017)*360,latlng=this._latlng;return new L.LatLngBounds([latlng.lat-latRadius,latlng.lng-lngRadius],[latlng.lat+latRadius,latlng.lng+lngRadius]);},getLatLng:function(){return this._latlng;},getPathString:function(){var p=this._point,r=this._radius;if(this._checkIfEmpty()){return'';}
if(L.Browser.svg){return'M'+p.x+','+(p.y-r)+'A'+r+','+r+',0,1,1,'+
(p.x-0.1)+','+(p.y-r)+' z';}else{p._round();r=Math.round(r);return'AL '+p.x+','+p.y+' '+r+','+r+' 0,'+(65535*360);}},getRadius:function(){return this._mRadius;},_getLatRadius:function(){return(this._mRadius / 40075017)*360;},_getLngRadius:function(){return this._getLatRadius()/ Math.cos(L.LatLng.DEG_TO_RAD*this._latlng.lat);},_checkIfEmpty:function(){if(!this._map){return false;}
var vp=this._map._pathViewport,r=this._radius,p=this._point;return p.x-r>vp.max.x||p.y-r>vp.max.y||p.x+r<vp.min.x||p.y+r<vp.min.y;}});L.circle=function(latlng,radius,options){return new L.Circle(latlng,radius,options);};L.CircleMarker=L.Circle.extend({options:{radius:10,weight:2},initialize:function(latlng,options){L.Circle.prototype.initialize.call(this,latlng,null,options);this._radius=this.options.radius;},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng);},_updateStyle:function(){L.Circle.prototype._updateStyle.call(this);this.setRadius(this.options.radius);},setLatLng:function(latlng){L.Circle.prototype.setLatLng.call(this,latlng);if(this._popup&&this._popup._isOpen){this._popup.setLatLng(latlng);}
return this;},setRadius:function(radius){this.options.radius=this._radius=radius;return this.redraw();},getRadius:function(){return this._radius;}});L.circleMarker=function(latlng,options){return new L.CircleMarker(latlng,options);};L.Polyline.include(!L.Path.CANVAS?{}:{_containsPoint:function(p,closed){var i,j,k,len,len2,dist,part,w=this.options.weight / 2;if(L.Browser.touch){w+=10;}
for(i=0,len=this._parts.length;i<len;i++){part=this._parts[i];for(j=0,len2=part.length,k=len2-1;j<len2;k=j++){if(!closed&&(j===0)){continue;}
dist=L.LineUtil.pointToSegmentDistance(p,part[k],part[j]);if(dist<=w){return true;}}}
return false;}});L.Polygon.include(!L.Path.CANVAS?{}:{_containsPoint:function(p){var inside=false,part,p1,p2,i,j,k,len,len2;if(L.Polyline.prototype._containsPoint.call(this,p,true)){return true;}
for(i=0,len=this._parts.length;i<len;i++){part=this._parts[i];for(j=0,len2=part.length,k=len2-1;j<len2;k=j++){p1=part[j];p2=part[k];if(((p1.y>p.y)!==(p2.y>p.y))&&(p.x<(p2.x-p1.x)*(p.y-p1.y)/(p2.y-p1.y)+p1.x)){inside=!inside;}}}
return inside;}});L.Circle.include(!L.Path.CANVAS?{}:{_drawPath:function(){var p=this._point;this._ctx.beginPath();this._ctx.arc(p.x,p.y,this._radius,0,Math.PI*2,false);},_containsPoint:function(p){var center=this._point,w2=this.options.stroke?this.options.weight / 2:0;return(p.distanceTo(center)<=this._radius+w2);}});L.CircleMarker.include(!L.Path.CANVAS?{}:{_updateStyle:function(){L.Path.prototype._updateStyle.call(this);}});L.GeoJSON=L.FeatureGroup.extend({initialize:function(geojson,options){L.setOptions(this,options);this._layers={};if(geojson){this.addData(geojson);}},addData:function(geojson){var features=L.Util.isArray(geojson)?geojson:geojson.features,i,len,feature;if(features){for(i=0,len=features.length;i<len;i++){feature=features[i];if(feature.geometries||feature.geometry||feature.features||feature.coordinates){this.addData(features[i]);}}
return this;}
var options=this.options;if(options.filter&&!options.filter(geojson)){return;}
var layer=L.GeoJSON.geometryToLayer(geojson,options.pointToLayer,options.coordsToLatLng,options);layer.feature=L.GeoJSON.asFeature(geojson);layer.defaultOptions=layer.options;this.resetStyle(layer);if(options.onEachFeature){options.onEachFeature(geojson,layer);}
return this.addLayer(layer);},resetStyle:function(layer){var style=this.options.style;if(style){L.Util.extend(layer.options,layer.defaultOptions);this._setLayerStyle(layer,style);}},setStyle:function(style){this.eachLayer(function(layer){this._setLayerStyle(layer,style);},this);},_setLayerStyle:function(layer,style){if(typeof style==='function'){style=style(layer.feature);}
if(layer.setStyle){layer.setStyle(style);}}});L.extend(L.GeoJSON,{geometryToLayer:function(geojson,pointToLayer,coordsToLatLng,vectorOptions){var geometry=geojson.type==='Feature'?geojson.geometry:geojson,coords=geometry.coordinates,layers=[],latlng,latlngs,i,len;coordsToLatLng=coordsToLatLng||this.coordsToLatLng;switch(geometry.type){case'Point':latlng=coordsToLatLng(coords);return pointToLayer?pointToLayer(geojson,latlng):new L.Marker(latlng);case'MultiPoint':for(i=0,len=coords.length;i<len;i++){latlng=coordsToLatLng(coords[i]);layers.push(pointToLayer?pointToLayer(geojson,latlng):new L.Marker(latlng));}
return new L.FeatureGroup(layers);case'LineString':latlngs=this.coordsToLatLngs(coords,0,coordsToLatLng);return new L.Polyline(latlngs,vectorOptions);case'Polygon':if(coords.length===2&&!coords[1].length){throw new Error('Invalid GeoJSON object.');}
latlngs=this.coordsToLatLngs(coords,1,coordsToLatLng);return new L.Polygon(latlngs,vectorOptions);case'MultiLineString':latlngs=this.coordsToLatLngs(coords,1,coordsToLatLng);return new L.MultiPolyline(latlngs,vectorOptions);case'MultiPolygon':latlngs=this.coordsToLatLngs(coords,2,coordsToLatLng);return new L.MultiPolygon(latlngs,vectorOptions);case'GeometryCollection':for(i=0,len=geometry.geometries.length;i<len;i++){layers.push(this.geometryToLayer({geometry:geometry.geometries[i],type:'Feature',properties:geojson.properties},pointToLayer,coordsToLatLng,vectorOptions));}
return new L.FeatureGroup(layers);default:throw new Error('Invalid GeoJSON object.');}},coordsToLatLng:function(coords){return new L.LatLng(coords[1],coords[0],coords[2]);},coordsToLatLngs:function(coords,levelsDeep,coordsToLatLng){var latlng,i,len,latlngs=[];for(i=0,len=coords.length;i<len;i++){latlng=levelsDeep?this.coordsToLatLngs(coords[i],levelsDeep-1,coordsToLatLng):(coordsToLatLng||this.coordsToLatLng)(coords[i]);latlngs.push(latlng);}
return latlngs;},latLngToCoords:function(latlng){var coords=[latlng.lng,latlng.lat];if(latlng.alt!==undefined){coords.push(latlng.alt);}
return coords;},latLngsToCoords:function(latLngs){var coords=[];for(var i=0,len=latLngs.length;i<len;i++){coords.push(L.GeoJSON.latLngToCoords(latLngs[i]));}
return coords;},getFeature:function(layer,newGeometry){return layer.feature?L.extend({},layer.feature,{geometry:newGeometry}):L.GeoJSON.asFeature(newGeometry);},asFeature:function(geoJSON){if(geoJSON.type==='Feature'){return geoJSON;}
return{type:'Feature',properties:{},geometry:geoJSON};}});var PointToGeoJSON={toGeoJSON:function(){return L.GeoJSON.getFeature(this,{type:'Point',coordinates:L.GeoJSON.latLngToCoords(this.getLatLng())});}};L.Marker.include(PointToGeoJSON);L.Circle.include(PointToGeoJSON);L.CircleMarker.include(PointToGeoJSON);L.Polyline.include({toGeoJSON:function(){return L.GeoJSON.getFeature(this,{type:'LineString',coordinates:L.GeoJSON.latLngsToCoords(this.getLatLngs())});}});L.Polygon.include({toGeoJSON:function(){var coords=[L.GeoJSON.latLngsToCoords(this.getLatLngs())],i,len,hole;coords[0].push(coords[0][0]);if(this._holes){for(i=0,len=this._holes.length;i<len;i++){hole=L.GeoJSON.latLngsToCoords(this._holes[i]);hole.push(hole[0]);coords.push(hole);}}
return L.GeoJSON.getFeature(this,{type:'Polygon',coordinates:coords});}});(function(){function multiToGeoJSON(type){return function(){var coords=[];this.eachLayer(function(layer){coords.push(layer.toGeoJSON().geometry.coordinates);});return L.GeoJSON.getFeature(this,{type:type,coordinates:coords});};}
L.MultiPolyline.include({toGeoJSON:multiToGeoJSON('MultiLineString')});L.MultiPolygon.include({toGeoJSON:multiToGeoJSON('MultiPolygon')});L.LayerGroup.include({toGeoJSON:function(){var geometry=this.feature&&this.feature.geometry,jsons=[],json;if(geometry&&geometry.type==='MultiPoint'){return multiToGeoJSON('MultiPoint').call(this);}
var isGeometryCollection=geometry&&geometry.type==='GeometryCollection';this.eachLayer(function(layer){if(layer.toGeoJSON){json=layer.toGeoJSON();jsons.push(isGeometryCollection?json.geometry:L.GeoJSON.asFeature(json));}});if(isGeometryCollection){return L.GeoJSON.getFeature(this,{geometries:jsons,type:'GeometryCollection'});}
return{type:'FeatureCollection',features:jsons};}});}());L.geoJson=function(geojson,options){return new L.GeoJSON(geojson,options);};L.DomEvent={addListener:function(obj,type,fn,context){var id=L.stamp(fn),key='_leaflet_'+type+id,handler,originalHandler,newType;if(obj[key]){return this;}
handler=function(e){return fn.call(context||obj,e||L.DomEvent._getEvent());};if(L.Browser.pointer&&type.indexOf('touch')===0){return this.addPointerListener(obj,type,handler,id);}
if(L.Browser.touch&&(type==='dblclick')&&this.addDoubleTapListener){this.addDoubleTapListener(obj,handler,id);}
if('addEventListener'in obj){if(type==='mousewheel'){obj.addEventListener('DOMMouseScroll',handler,false);obj.addEventListener(type,handler,false);}else if((type==='mouseenter')||(type==='mouseleave')){originalHandler=handler;newType=(type==='mouseenter'?'mouseover':'mouseout');handler=function(e){if(!L.DomEvent._checkMouse(obj,e)){return;}
return originalHandler(e);};obj.addEventListener(newType,handler,false);}else if(type==='click'&&L.Browser.android){originalHandler=handler;handler=function(e){return L.DomEvent._filterClick(e,originalHandler);};obj.addEventListener(type,handler,false);}else{obj.addEventListener(type,handler,false);}}else if('attachEvent'in obj){obj.attachEvent('on'+type,handler);}
obj[key]=handler;return this;},removeListener:function(obj,type,fn){var id=L.stamp(fn),key='_leaflet_'+type+id,handler=obj[key];if(!handler){return this;}
if(L.Browser.pointer&&type.indexOf('touch')===0){this.removePointerListener(obj,type,id);}else if(L.Browser.touch&&(type==='dblclick')&&this.removeDoubleTapListener){this.removeDoubleTapListener(obj,id);}else if('removeEventListener'in obj){if(type==='mousewheel'){obj.removeEventListener('DOMMouseScroll',handler,false);obj.removeEventListener(type,handler,false);}else if((type==='mouseenter')||(type==='mouseleave')){obj.removeEventListener((type==='mouseenter'?'mouseover':'mouseout'),handler,false);}else{obj.removeEventListener(type,handler,false);}}else if('detachEvent'in obj){obj.detachEvent('on'+type,handler);}
obj[key]=null;return this;},stopPropagation:function(e){if(e.stopPropagation){e.stopPropagation();}else{e.cancelBubble=true;}
L.DomEvent._skipped(e);return this;},disableScrollPropagation:function(el){var stop=L.DomEvent.stopPropagation;return L.DomEvent.on(el,'mousewheel',stop).on(el,'MozMousePixelScroll',stop);},disableClickPropagation:function(el){var stop=L.DomEvent.stopPropagation;for(var i=L.Draggable.START.length-1;i>=0;i--){L.DomEvent.on(el,L.Draggable.START[i],stop);}
return L.DomEvent.on(el,'click',L.DomEvent._fakeStop).on(el,'dblclick',stop);},preventDefault:function(e){if(e.preventDefault){e.preventDefault();}else{e.returnValue=false;}
return this;},stop:function(e){return L.DomEvent.preventDefault(e).stopPropagation(e);},getMousePosition:function(e,container){if(!container){return new L.Point(e.clientX,e.clientY);}
var rect=container.getBoundingClientRect();return new L.Point(e.clientX-rect.left-container.clientLeft,e.clientY-rect.top-container.clientTop);},getWheelDelta:function(e){var delta=0;if(e.wheelDelta){delta=e.wheelDelta / 120;}
if(e.detail){delta=-e.detail / 3;}
return delta;},_skipEvents:{},_fakeStop:function(e){L.DomEvent._skipEvents[e.type]=true;},_skipped:function(e){var skipped=this._skipEvents[e.type];this._skipEvents[e.type]=false;return skipped;},_checkMouse:function(el,e){var related=e.relatedTarget;if(!related){return true;}
try{while(related&&(related!==el)){related=related.parentNode;}}catch(err){return false;}
return(related!==el);},_getEvent:function(){var e=window.event;if(!e){var caller=arguments.callee.caller;while(caller){e=caller['arguments'][0];if(e&&window.Event===e.constructor){break;}
caller=caller.caller;}}
return e;},_filterClick:function(e,handler){var timeStamp=(e.timeStamp||e.originalEvent.timeStamp),elapsed=L.DomEvent._lastClick&&(timeStamp-L.DomEvent._lastClick);if((elapsed&&elapsed>100&&elapsed<500)||(e.target._simulatedClick&&!e._simulated)){L.DomEvent.stop(e);return;}
L.DomEvent._lastClick=timeStamp;return handler(e);}};L.DomEvent.on=L.DomEvent.addListener;L.DomEvent.off=L.DomEvent.removeListener;L.Draggable=L.Class.extend({includes:L.Mixin.Events,statics:{START:L.Browser.touch?['touchstart','mousedown']:['mousedown'],END:{mousedown:'mouseup',touchstart:'touchend',pointerdown:'touchend',MSPointerDown:'touchend'},MOVE:{mousedown:'mousemove',touchstart:'touchmove',pointerdown:'touchmove',MSPointerDown:'touchmove'}},initialize:function(element,dragStartTarget){this._element=element;this._dragStartTarget=dragStartTarget||element;},enable:function(){if(this._enabled){return;}
for(var i=L.Draggable.START.length-1;i>=0;i--){L.DomEvent.on(this._dragStartTarget,L.Draggable.START[i],this._onDown,this);}
this._enabled=true;},disable:function(){if(!this._enabled){return;}
for(var i=L.Draggable.START.length-1;i>=0;i--){L.DomEvent.off(this._dragStartTarget,L.Draggable.START[i],this._onDown,this);}
this._enabled=false;this._moved=false;},_onDown:function(e){this._moved=false;if(e.shiftKey||((e.which!==1)&&(e.button!==1)&&!e.touches)){return;}
L.DomEvent.stopPropagation(e);if(L.Draggable._disabled){return;}
L.DomUtil.disableImageDrag();L.DomUtil.disableTextSelection();if(this._moving){return;}
var first=e.touches?e.touches[0]:e;this._startPoint=new L.Point(first.clientX,first.clientY);this._startPos=this._newPos=L.DomUtil.getPosition(this._element);L.DomEvent.on(document,L.Draggable.MOVE[e.type],this._onMove,this).on(document,L.Draggable.END[e.type],this._onUp,this);},_onMove:function(e){if(e.touches&&e.touches.length>1){this._moved=true;return;}
var first=(e.touches&&e.touches.length===1?e.touches[0]:e),newPoint=new L.Point(first.clientX,first.clientY),offset=newPoint.subtract(this._startPoint);if(!offset.x&&!offset.y){return;}
if(L.Browser.touch&&Math.abs(offset.x)+Math.abs(offset.y)<3){return;}
L.DomEvent.preventDefault(e);if(!this._moved){this.fire('dragstart');this._moved=true;this._startPos=L.DomUtil.getPosition(this._element).subtract(offset);L.DomUtil.addClass(document.body,'leaflet-dragging');this._lastTarget=e.target||e.srcElement;L.DomUtil.addClass(this._lastTarget,'leaflet-drag-target');}
this._newPos=this._startPos.add(offset);this._moving=true;L.Util.cancelAnimFrame(this._animRequest);this._animRequest=L.Util.requestAnimFrame(this._updatePosition,this,true,this._dragStartTarget);},_updatePosition:function(){this.fire('predrag');L.DomUtil.setPosition(this._element,this._newPos);this.fire('drag');},_onUp:function(){L.DomUtil.removeClass(document.body,'leaflet-dragging');if(this._lastTarget){L.DomUtil.removeClass(this._lastTarget,'leaflet-drag-target');this._lastTarget=null;}
for(var i in L.Draggable.MOVE){L.DomEvent.off(document,L.Draggable.MOVE[i],this._onMove).off(document,L.Draggable.END[i],this._onUp);}
L.DomUtil.enableImageDrag();L.DomUtil.enableTextSelection();if(this._moved&&this._moving){L.Util.cancelAnimFrame(this._animRequest);this.fire('dragend',{distance:this._newPos.distanceTo(this._startPos)});}
this._moving=false;}});L.Handler=L.Class.extend({initialize:function(map){this._map=map;},enable:function(){if(this._enabled){return;}
this._enabled=true;this.addHooks();},disable:function(){if(!this._enabled){return;}
this._enabled=false;this.removeHooks();},enabled:function(){return!!this._enabled;}});L.Map.mergeOptions({dragging:true,inertia:!L.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:Infinity,inertiaThreshold:L.Browser.touch?32:18,easeLinearity:0.25,worldCopyJump:false});L.Map.Drag=L.Handler.extend({addHooks:function(){if(!this._draggable){var map=this._map;this._draggable=new L.Draggable(map._mapPane,map._container);this._draggable.on({'dragstart':this._onDragStart,'drag':this._onDrag,'dragend':this._onDragEnd},this);if(map.options.worldCopyJump){this._draggable.on('predrag',this._onPreDrag,this);map.on('viewreset',this._onViewReset,this);map.whenReady(this._onViewReset,this);}}
this._draggable.enable();},removeHooks:function(){this._draggable.disable();},moved:function(){return this._draggable&&this._draggable._moved;},_onDragStart:function(){var map=this._map;if(map._panAnim){map._panAnim.stop();}
map.fire('movestart').fire('dragstart');if(map.options.inertia){this._positions=[];this._times=[];}},_onDrag:function(){if(this._map.options.inertia){var time=this._lastTime=+new Date(),pos=this._lastPos=this._draggable._newPos;this._positions.push(pos);this._times.push(time);if(time-this._times[0]>200){this._positions.shift();this._times.shift();}}
this._map.fire('move').fire('drag');},_onViewReset:function(){var pxCenter=this._map.getSize()._divideBy(2),pxWorldCenter=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=pxWorldCenter.subtract(pxCenter).x;this._worldWidth=this._map.project([0,180]).x;},_onPreDrag:function(){var worldWidth=this._worldWidth,halfWidth=Math.round(worldWidth / 2),dx=this._initialWorldOffset,x=this._draggable._newPos.x,newX1=(x-halfWidth+dx)%worldWidth+halfWidth-dx,newX2=(x+halfWidth+dx)%worldWidth-halfWidth-dx,newX=Math.abs(newX1+dx)<Math.abs(newX2+dx)?newX1:newX2;this._draggable._newPos.x=newX;},_onDragEnd:function(e){var map=this._map,options=map.options,delay=+new Date()-this._lastTime,noInertia=!options.inertia||delay>options.inertiaThreshold||!this._positions[0];map.fire('dragend',e);if(noInertia){map.fire('moveend');}else{var direction=this._lastPos.subtract(this._positions[0]),duration=(this._lastTime+delay-this._times[0])/ 1000,ease=options.easeLinearity,speedVector=direction.multiplyBy(ease / duration),speed=speedVector.distanceTo([0,0]),limitedSpeed=Math.min(options.inertiaMaxSpeed,speed),limitedSpeedVector=speedVector.multiplyBy(limitedSpeed / speed),decelerationDuration=limitedSpeed /(options.inertiaDeceleration*ease),offset=limitedSpeedVector.multiplyBy(-decelerationDuration / 2).round();if(!offset.x||!offset.y){map.fire('moveend');}else{offset=map._limitOffset(offset,map.options.maxBounds);L.Util.requestAnimFrame(function(){map.panBy(offset,{duration:decelerationDuration,easeLinearity:ease,noMoveStart:true});});}}}});L.Map.addInitHook('addHandler','dragging',L.Map.Drag);L.Map.mergeOptions({doubleClickZoom:true});L.Map.DoubleClickZoom=L.Handler.extend({addHooks:function(){this._map.on('dblclick',this._onDoubleClick,this);},removeHooks:function(){this._map.off('dblclick',this._onDoubleClick,this);},_onDoubleClick:function(e){var map=this._map,zoom=map.getZoom()+(e.originalEvent.shiftKey?-1:1);if(map.options.doubleClickZoom==='center'){map.setZoom(zoom);}else{map.setZoomAround(e.containerPoint,zoom);}}});L.Map.addInitHook('addHandler','doubleClickZoom',L.Map.DoubleClickZoom);L.Map.mergeOptions({scrollWheelZoom:true});L.Map.ScrollWheelZoom=L.Handler.extend({addHooks:function(){L.DomEvent.on(this._map._container,'mousewheel',this._onWheelScroll,this);L.DomEvent.on(this._map._container,'MozMousePixelScroll',L.DomEvent.preventDefault);this._delta=0;},removeHooks:function(){L.DomEvent.off(this._map._container,'mousewheel',this._onWheelScroll);L.DomEvent.off(this._map._container,'MozMousePixelScroll',L.DomEvent.preventDefault);},_onWheelScroll:function(e){var delta=L.DomEvent.getWheelDelta(e);this._delta+=delta;this._lastMousePos=this._map.mouseEventToContainerPoint(e);if(!this._startTime){this._startTime=+new Date();}
var left=Math.max(40-(+new Date()-this._startTime),0);clearTimeout(this._timer);this._timer=setTimeout(L.bind(this._performZoom,this),left);L.DomEvent.preventDefault(e);L.DomEvent.stopPropagation(e);},_performZoom:function(){var map=this._map,delta=this._delta,zoom=map.getZoom();delta=delta>0?Math.ceil(delta):Math.floor(delta);delta=Math.max(Math.min(delta,4),-4);delta=map._limitZoom(zoom+delta)-zoom;this._delta=0;this._startTime=null;if(!delta){return;}
if(map.options.scrollWheelZoom==='center'){map.setZoom(zoom+delta);}else{map.setZoomAround(this._lastMousePos,zoom+delta);}}});L.Map.addInitHook('addHandler','scrollWheelZoom',L.Map.ScrollWheelZoom);L.extend(L.DomEvent,{_touchstart:L.Browser.msPointer?'MSPointerDown':L.Browser.pointer?'pointerdown':'touchstart',_touchend:L.Browser.msPointer?'MSPointerUp':L.Browser.pointer?'pointerup':'touchend',addDoubleTapListener:function(obj,handler,id){var last,doubleTap=false,delay=250,touch,pre='_leaflet_',touchstart=this._touchstart,touchend=this._touchend,trackedTouches=[];function onTouchStart(e){var count;if(L.Browser.pointer){trackedTouches.push(e.pointerId);count=trackedTouches.length;}else{count=e.touches.length;}
if(count>1){return;}
var now=Date.now(),delta=now-(last||now);touch=e.touches?e.touches[0]:e;doubleTap=(delta>0&&delta<=delay);last=now;}
function onTouchEnd(e){if(L.Browser.pointer){var idx=trackedTouches.indexOf(e.pointerId);if(idx===-1){return;}
trackedTouches.splice(idx,1);}
if(doubleTap){if(L.Browser.pointer){var newTouch={},prop;for(var i in touch){prop=touch[i];if(typeof prop==='function'){newTouch[i]=prop.bind(touch);}else{newTouch[i]=prop;}}
touch=newTouch;}
touch.type='dblclick';handler(touch);last=null;}}
obj[pre+touchstart+id]=onTouchStart;obj[pre+touchend+id]=onTouchEnd;var endElement=L.Browser.pointer?document.documentElement:obj;obj.addEventListener(touchstart,onTouchStart,false);endElement.addEventListener(touchend,onTouchEnd,false);if(L.Browser.pointer){endElement.addEventListener(L.DomEvent.POINTER_CANCEL,onTouchEnd,false);}
return this;},removeDoubleTapListener:function(obj,id){var pre='_leaflet_';obj.removeEventListener(this._touchstart,obj[pre+this._touchstart+id],false);(L.Browser.pointer?document.documentElement:obj).removeEventListener(this._touchend,obj[pre+this._touchend+id],false);if(L.Browser.pointer){document.documentElement.removeEventListener(L.DomEvent.POINTER_CANCEL,obj[pre+this._touchend+id],false);}
return this;}});L.extend(L.DomEvent,{POINTER_DOWN:L.Browser.msPointer?'MSPointerDown':'pointerdown',POINTER_MOVE:L.Browser.msPointer?'MSPointerMove':'pointermove',POINTER_UP:L.Browser.msPointer?'MSPointerUp':'pointerup',POINTER_CANCEL:L.Browser.msPointer?'MSPointerCancel':'pointercancel',_pointers:[],_pointerDocumentListener:false,addPointerListener:function(obj,type,handler,id){switch(type){case'touchstart':return this.addPointerListenerStart(obj,type,handler,id);case'touchend':return this.addPointerListenerEnd(obj,type,handler,id);case'touchmove':return this.addPointerListenerMove(obj,type,handler,id);default:throw'Unknown touch event type';}},addPointerListenerStart:function(obj,type,handler,id){var pre='_leaflet_',pointers=this._pointers;var cb=function(e){L.DomEvent.preventDefault(e);var alreadyInArray=false;for(var i=0;i<pointers.length;i++){if(pointers[i].pointerId===e.pointerId){alreadyInArray=true;break;}}
if(!alreadyInArray){pointers.push(e);}
e.touches=pointers.slice();e.changedTouches=[e];handler(e);};obj[pre+'touchstart'+id]=cb;obj.addEventListener(this.POINTER_DOWN,cb,false);if(!this._pointerDocumentListener){var internalCb=function(e){for(var i=0;i<pointers.length;i++){if(pointers[i].pointerId===e.pointerId){pointers.splice(i,1);break;}}};document.documentElement.addEventListener(this.POINTER_UP,internalCb,false);document.documentElement.addEventListener(this.POINTER_CANCEL,internalCb,false);this._pointerDocumentListener=true;}
return this;},addPointerListenerMove:function(obj,type,handler,id){var pre='_leaflet_',touches=this._pointers;function cb(e){if((e.pointerType===e.MSPOINTER_TYPE_MOUSE||e.pointerType==='mouse')&&e.buttons===0){return;}
for(var i=0;i<touches.length;i++){if(touches[i].pointerId===e.pointerId){touches[i]=e;break;}}
e.touches=touches.slice();e.changedTouches=[e];handler(e);}
obj[pre+'touchmove'+id]=cb;obj.addEventListener(this.POINTER_MOVE,cb,false);return this;},addPointerListenerEnd:function(obj,type,handler,id){var pre='_leaflet_',touches=this._pointers;var cb=function(e){for(var i=0;i<touches.length;i++){if(touches[i].pointerId===e.pointerId){touches.splice(i,1);break;}}
e.touches=touches.slice();e.changedTouches=[e];handler(e);};obj[pre+'touchend'+id]=cb;obj.addEventListener(this.POINTER_UP,cb,false);obj.addEventListener(this.POINTER_CANCEL,cb,false);return this;},removePointerListener:function(obj,type,id){var pre='_leaflet_',cb=obj[pre+type+id];switch(type){case'touchstart':obj.removeEventListener(this.POINTER_DOWN,cb,false);break;case'touchmove':obj.removeEventListener(this.POINTER_MOVE,cb,false);break;case'touchend':obj.removeEventListener(this.POINTER_UP,cb,false);obj.removeEventListener(this.POINTER_CANCEL,cb,false);break;}
return this;}});L.Map.mergeOptions({touchZoom:L.Browser.touch&&!L.Browser.android23,bounceAtZoomLimits:true});L.Map.TouchZoom=L.Handler.extend({addHooks:function(){L.DomEvent.on(this._map._container,'touchstart',this._onTouchStart,this);},removeHooks:function(){L.DomEvent.off(this._map._container,'touchstart',this._onTouchStart,this);},_onTouchStart:function(e){var map=this._map;if(!e.touches||e.touches.length!==2||map._animatingZoom||this._zooming){return;}
var p1=map.mouseEventToLayerPoint(e.touches[0]),p2=map.mouseEventToLayerPoint(e.touches[1]),viewCenter=map._getCenterLayerPoint();this._startCenter=p1.add(p2)._divideBy(2);this._startDist=p1.distanceTo(p2);this._moved=false;this._zooming=true;this._centerOffset=viewCenter.subtract(this._startCenter);if(map._panAnim){map._panAnim.stop();}
L.DomEvent.on(document,'touchmove',this._onTouchMove,this).on(document,'touchend',this._onTouchEnd,this);L.DomEvent.preventDefault(e);},_onTouchMove:function(e){var map=this._map;if(!e.touches||e.touches.length!==2||!this._zooming){return;}
var p1=map.mouseEventToLayerPoint(e.touches[0]),p2=map.mouseEventToLayerPoint(e.touches[1]);this._scale=p1.distanceTo(p2)/ this._startDist;this._delta=p1._add(p2)._divideBy(2)._subtract(this._startCenter);if(this._scale===1){return;}
if(!map.options.bounceAtZoomLimits){if((map.getZoom()===map.getMinZoom()&&this._scale<1)||(map.getZoom()===map.getMaxZoom()&&this._scale>1)){return;}}
if(!this._moved){L.DomUtil.addClass(map._mapPane,'leaflet-touching');map.fire('movestart').fire('zoomstart');this._moved=true;}
L.Util.cancelAnimFrame(this._animRequest);this._animRequest=L.Util.requestAnimFrame(this._updateOnMove,this,true,this._map._container);L.DomEvent.preventDefault(e);},_updateOnMove:function(){var map=this._map,origin=this._getScaleOrigin(),center=map.layerPointToLatLng(origin),zoom=map.getScaleZoom(this._scale);map._animateZoom(center,zoom,this._startCenter,this._scale,this._delta,false,true);},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=false;return;}
var map=this._map;this._zooming=false;L.DomUtil.removeClass(map._mapPane,'leaflet-touching');L.Util.cancelAnimFrame(this._animRequest);L.DomEvent.off(document,'touchmove',this._onTouchMove).off(document,'touchend',this._onTouchEnd);var origin=this._getScaleOrigin(),center=map.layerPointToLatLng(origin),oldZoom=map.getZoom(),floatZoomDelta=map.getScaleZoom(this._scale)-oldZoom,roundZoomDelta=(floatZoomDelta>0?Math.ceil(floatZoomDelta):Math.floor(floatZoomDelta)),zoom=map._limitZoom(oldZoom+roundZoomDelta),scale=map.getZoomScale(zoom)/ this._scale;map._animateZoom(center,zoom,origin,scale);},_getScaleOrigin:function(){var centerOffset=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(centerOffset);}});L.Map.addInitHook('addHandler','touchZoom',L.Map.TouchZoom);L.Map.mergeOptions({tap:true,tapTolerance:15});L.Map.Tap=L.Handler.extend({addHooks:function(){L.DomEvent.on(this._map._container,'touchstart',this._onDown,this);},removeHooks:function(){L.DomEvent.off(this._map._container,'touchstart',this._onDown,this);},_onDown:function(e){if(!e.touches){return;}
L.DomEvent.preventDefault(e);this._fireClick=true;if(e.touches.length>1){this._fireClick=false;clearTimeout(this._holdTimeout);return;}
var first=e.touches[0],el=first.target;this._startPos=this._newPos=new L.Point(first.clientX,first.clientY);if(el.tagName&&el.tagName.toLowerCase()==='a'){L.DomUtil.addClass(el,'leaflet-active');}
this._holdTimeout=setTimeout(L.bind(function(){if(this._isTapValid()){this._fireClick=false;this._onUp();this._simulateEvent('contextmenu',first);}},this),1000);L.DomEvent.on(document,'touchmove',this._onMove,this).on(document,'touchend',this._onUp,this);},_onUp:function(e){clearTimeout(this._holdTimeout);L.DomEvent.off(document,'touchmove',this._onMove,this).off(document,'touchend',this._onUp,this);if(this._fireClick&&e&&e.changedTouches){var first=e.changedTouches[0],el=first.target;if(el&&el.tagName&&el.tagName.toLowerCase()==='a'){L.DomUtil.removeClass(el,'leaflet-active');}
if(this._isTapValid()){this._simulateEvent('click',first);}}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance;},_onMove:function(e){var first=e.touches[0];this._newPos=new L.Point(first.clientX,first.clientY);},_simulateEvent:function(type,e){var simulatedEvent=document.createEvent('MouseEvents');simulatedEvent._simulated=true;e.target._simulatedClick=true;simulatedEvent.initMouseEvent(type,true,true,window,1,e.screenX,e.screenY,e.clientX,e.clientY,false,false,false,false,0,null);e.target.dispatchEvent(simulatedEvent);}});if(L.Browser.touch&&!L.Browser.pointer){L.Map.addInitHook('addHandler','tap',L.Map.Tap);}
L.Map.mergeOptions({boxZoom:true});L.Map.BoxZoom=L.Handler.extend({initialize:function(map){this._map=map;this._container=map._container;this._pane=map._panes.overlayPane;this._moved=false;},addHooks:function(){L.DomEvent.on(this._container,'mousedown',this._onMouseDown,this);},removeHooks:function(){L.DomEvent.off(this._container,'mousedown',this._onMouseDown);this._moved=false;},moved:function(){return this._moved;},_onMouseDown:function(e){this._moved=false;if(!e.shiftKey||((e.which!==1)&&(e.button!==1))){return false;}
L.DomUtil.disableTextSelection();L.DomUtil.disableImageDrag();this._startLayerPoint=this._map.mouseEventToLayerPoint(e);L.DomEvent.on(document,'mousemove',this._onMouseMove,this).on(document,'mouseup',this._onMouseUp,this).on(document,'keydown',this._onKeyDown,this);},_onMouseMove:function(e){if(!this._moved){this._box=L.DomUtil.create('div','leaflet-zoom-box',this._pane);L.DomUtil.setPosition(this._box,this._startLayerPoint);this._container.style.cursor='crosshair';this._map.fire('boxzoomstart');}
var startPoint=this._startLayerPoint,box=this._box,layerPoint=this._map.mouseEventToLayerPoint(e),offset=layerPoint.subtract(startPoint),newPos=new L.Point(Math.min(layerPoint.x,startPoint.x),Math.min(layerPoint.y,startPoint.y));L.DomUtil.setPosition(box,newPos);this._moved=true;box.style.width=(Math.max(0,Math.abs(offset.x)-4))+'px';box.style.height=(Math.max(0,Math.abs(offset.y)-4))+'px';},_finish:function(){if(this._moved){this._pane.removeChild(this._box);this._container.style.cursor='';}
L.DomUtil.enableTextSelection();L.DomUtil.enableImageDrag();L.DomEvent.off(document,'mousemove',this._onMouseMove).off(document,'mouseup',this._onMouseUp).off(document,'keydown',this._onKeyDown);},_onMouseUp:function(e){this._finish();var map=this._map,layerPoint=map.mouseEventToLayerPoint(e);if(this._startLayerPoint.equals(layerPoint)){return;}
var bounds=new L.LatLngBounds(map.layerPointToLatLng(this._startLayerPoint),map.layerPointToLatLng(layerPoint));map.fitBounds(bounds);map.fire('boxzoomend',{boxZoomBounds:bounds});},_onKeyDown:function(e){if(e.keyCode===27){this._finish();}}});L.Map.addInitHook('addHandler','boxZoom',L.Map.BoxZoom);L.Map.mergeOptions({keyboard:true,keyboardPanOffset:80,keyboardZoomOffset:1});L.Map.Keyboard=L.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(map){this._map=map;this._setPanOffset(map.options.keyboardPanOffset);this._setZoomOffset(map.options.keyboardZoomOffset);},addHooks:function(){var container=this._map._container;if(container.tabIndex===-1){container.tabIndex='0';}
L.DomEvent.on(container,'focus',this._onFocus,this).on(container,'blur',this._onBlur,this).on(container,'mousedown',this._onMouseDown,this);this._map.on('focus',this._addHooks,this).on('blur',this._removeHooks,this);},removeHooks:function(){this._removeHooks();var container=this._map._container;L.DomEvent.off(container,'focus',this._onFocus,this).off(container,'blur',this._onBlur,this).off(container,'mousedown',this._onMouseDown,this);this._map.off('focus',this._addHooks,this).off('blur',this._removeHooks,this);},_onMouseDown:function(){if(this._focused){return;}
var body=document.body,docEl=document.documentElement,top=body.scrollTop||docEl.scrollTop,left=body.scrollLeft||docEl.scrollLeft;this._map._container.focus();window.scrollTo(left,top);},_onFocus:function(){this._focused=true;this._map.fire('focus');},_onBlur:function(){this._focused=false;this._map.fire('blur');},_setPanOffset:function(pan){var keys=this._panKeys={},codes=this.keyCodes,i,len;for(i=0,len=codes.left.length;i<len;i++){keys[codes.left[i]]=[-1*pan,0];}
for(i=0,len=codes.right.length;i<len;i++){keys[codes.right[i]]=[pan,0];}
for(i=0,len=codes.down.length;i<len;i++){keys[codes.down[i]]=[0,pan];}
for(i=0,len=codes.up.length;i<len;i++){keys[codes.up[i]]=[0,-1*pan];}},_setZoomOffset:function(zoom){var keys=this._zoomKeys={},codes=this.keyCodes,i,len;for(i=0,len=codes.zoomIn.length;i<len;i++){keys[codes.zoomIn[i]]=zoom;}
for(i=0,len=codes.zoomOut.length;i<len;i++){keys[codes.zoomOut[i]]=-zoom;}},_addHooks:function(){L.DomEvent.on(document,'keydown',this._onKeyDown,this);},_removeHooks:function(){L.DomEvent.off(document,'keydown',this._onKeyDown,this);},_onKeyDown:function(e){var key=e.keyCode,map=this._map;if(key in this._panKeys){if(map._panAnim&&map._panAnim._inProgress){return;}
map.panBy(this._panKeys[key]);if(map.options.maxBounds){map.panInsideBounds(map.options.maxBounds);}}else if(key in this._zoomKeys){map.setZoom(map.getZoom()+this._zoomKeys[key]);}else{return;}
L.DomEvent.stop(e);}});L.Map.addInitHook('addHandler','keyboard',L.Map.Keyboard);L.Handler.MarkerDrag=L.Handler.extend({initialize:function(marker){this._marker=marker;},addHooks:function(){var icon=this._marker._icon;if(!this._draggable){this._draggable=new L.Draggable(icon,icon);}
this._draggable.on('dragstart',this._onDragStart,this).on('drag',this._onDrag,this).on('dragend',this._onDragEnd,this);this._draggable.enable();L.DomUtil.addClass(this._marker._icon,'leaflet-marker-draggable');},removeHooks:function(){this._draggable.off('dragstart',this._onDragStart,this).off('drag',this._onDrag,this).off('dragend',this._onDragEnd,this);this._draggable.disable();L.DomUtil.removeClass(this._marker._icon,'leaflet-marker-draggable');},moved:function(){return this._draggable&&this._draggable._moved;},_onDragStart:function(){this._marker.fire('movestart').fire('dragstart');},_onDrag:function(){var marker=this._marker,shadow=marker._shadow,iconPos=L.DomUtil.getPosition(marker._icon),latlng=marker._map.layerPointToLatLng(iconPos);if(shadow){L.DomUtil.setPosition(shadow,iconPos);}
marker._latlng=latlng;marker.fire('move',{latlng:latlng}).fire('drag');},_onDragEnd:function(e){this._marker.fire('moveend').fire('dragend',e);}});L.Control=L.Class.extend({options:{position:'topright'},initialize:function(options){L.setOptions(this,options);},getPosition:function(){return this.options.position;},setPosition:function(position){var map=this._map;if(map){map.removeControl(this);}
this.options.position=position;if(map){map.addControl(this);}
return this;},getContainer:function(){return this._container;},addTo:function(map){this._map=map;var container=this._container=this.onAdd(map),pos=this.getPosition(),corner=map._controlCorners[pos];L.DomUtil.addClass(container,'leaflet-control');if(pos.indexOf('bottom')!==-1){corner.insertBefore(container,corner.firstChild);}else{corner.appendChild(container);}
return this;},removeFrom:function(map){var pos=this.getPosition(),corner=map._controlCorners[pos];corner.removeChild(this._container);this._map=null;if(this.onRemove){this.onRemove(map);}
return this;},_refocusOnMap:function(){if(this._map){this._map.getContainer().focus();}}});L.control=function(options){return new L.Control(options);};L.Map.include({addControl:function(control){control.addTo(this);return this;},removeControl:function(control){control.removeFrom(this);return this;},_initControlPos:function(){var corners=this._controlCorners={},l='leaflet-',container=this._controlContainer=L.DomUtil.create('div',l+'control-container',this._container);function createCorner(vSide,hSide){var className=l+vSide+' '+l+hSide;corners[vSide+hSide]=L.DomUtil.create('div',className,container);}
createCorner('top','left');createCorner('top','right');createCorner('bottom','left');createCorner('bottom','right');},_clearControlPos:function(){this._container.removeChild(this._controlContainer);}});L.Control.Zoom=L.Control.extend({options:{position:'topleft',zoomInText:'+',zoomInTitle:'Zoom in',zoomOutText:'-',zoomOutTitle:'Zoom out'},onAdd:function(map){var zoomName='leaflet-control-zoom',container=L.DomUtil.create('div',zoomName+' leaflet-bar');this._map=map;this._zoomInButton=this._createButton(this.options.zoomInText,this.options.zoomInTitle,zoomName+'-in',container,this._zoomIn,this);this._zoomOutButton=this._createButton(this.options.zoomOutText,this.options.zoomOutTitle,zoomName+'-out',container,this._zoomOut,this);this._updateDisabled();map.on('zoomend zoomlevelschange',this._updateDisabled,this);return container;},onRemove:function(map){map.off('zoomend zoomlevelschange',this._updateDisabled,this);},_zoomIn:function(e){this._map.zoomIn(e.shiftKey?3:1);},_zoomOut:function(e){this._map.zoomOut(e.shiftKey?3:1);},_createButton:function(html,title,className,container,fn,context){var link=L.DomUtil.create('a',className,container);link.innerHTML=html;link.href='#';link.title=title;var stop=L.DomEvent.stopPropagation;L.DomEvent.on(link,'click',stop).on(link,'mousedown',stop).on(link,'dblclick',stop).on(link,'click',L.DomEvent.preventDefault).on(link,'click',fn,context).on(link,'click',this._refocusOnMap,context);return link;},_updateDisabled:function(){var map=this._map,className='leaflet-disabled';L.DomUtil.removeClass(this._zoomInButton,className);L.DomUtil.removeClass(this._zoomOutButton,className);if(map._zoom===map.getMinZoom()){L.DomUtil.addClass(this._zoomOutButton,className);}
if(map._zoom===map.getMaxZoom()){L.DomUtil.addClass(this._zoomInButton,className);}}});L.Map.mergeOptions({zoomControl:true});L.Map.addInitHook(function(){if(this.options.zoomControl){this.zoomControl=new L.Control.Zoom();this.addControl(this.zoomControl);}});L.control.zoom=function(options){return new L.Control.Zoom(options);};L.Control.Attribution=L.Control.extend({options:{position:'bottomright',prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(options){L.setOptions(this,options);this._attributions={};},onAdd:function(map){this._container=L.DomUtil.create('div','leaflet-control-attribution');L.DomEvent.disableClickPropagation(this._container);for(var i in map._layers){if(map._layers[i].getAttribution){this.addAttribution(map._layers[i].getAttribution());}}
map.on('layeradd',this._onLayerAdd,this).on('layerremove',this._onLayerRemove,this);this._update();return this._container;},onRemove:function(map){map.off('layeradd',this._onLayerAdd).off('layerremove',this._onLayerRemove);},setPrefix:function(prefix){this.options.prefix=prefix;this._update();return this;},addAttribution:function(text){if(!text){return;}
if(!this._attributions[text]){this._attributions[text]=0;}
this._attributions[text]++;this._update();return this;},removeAttribution:function(text){if(!text){return;}
if(this._attributions[text]){this._attributions[text]--;this._update();}
return this;},_update:function(){if(!this._map){return;}
var attribs=[];for(var i in this._attributions){if(this._attributions[i]){attribs.push(i);}}
var prefixAndAttribs=[];if(this.options.prefix){prefixAndAttribs.push(this.options.prefix);}
if(attribs.length){prefixAndAttribs.push(attribs.join(', '));}
this._container.innerHTML=prefixAndAttribs.join(' | ');},_onLayerAdd:function(e){if(e.layer.getAttribution){this.addAttribution(e.layer.getAttribution());}},_onLayerRemove:function(e){if(e.layer.getAttribution){this.removeAttribution(e.layer.getAttribution());}}});L.Map.mergeOptions({attributionControl:true});L.Map.addInitHook(function(){if(this.options.attributionControl){this.attributionControl=(new L.Control.Attribution()).addTo(this);}});L.control.attribution=function(options){return new L.Control.Attribution(options);};L.Control.Scale=L.Control.extend({options:{position:'bottomleft',maxWidth:100,metric:true,imperial:true,updateWhenIdle:false},onAdd:function(map){this._map=map;var className='leaflet-control-scale',container=L.DomUtil.create('div',className),options=this.options;this._addScales(options,className,container);map.on(options.updateWhenIdle?'moveend':'move',this._update,this);map.whenReady(this._update,this);return container;},onRemove:function(map){map.off(this.options.updateWhenIdle?'moveend':'move',this._update,this);},_addScales:function(options,className,container){if(options.metric){this._mScale=L.DomUtil.create('div',className+'-line',container);}
if(options.imperial){this._iScale=L.DomUtil.create('div',className+'-line',container);}},_update:function(){var bounds=this._map.getBounds(),centerLat=bounds.getCenter().lat,halfWorldMeters=6378137*Math.PI*Math.cos(centerLat*Math.PI / 180),dist=halfWorldMeters*(bounds.getNorthEast().lng-bounds.getSouthWest().lng)/ 180,size=this._map.getSize(),options=this.options,maxMeters=0;if(size.x>0){maxMeters=dist*(options.maxWidth / size.x);}
this._updateScales(options,maxMeters);},_updateScales:function(options,maxMeters){if(options.metric&&maxMeters){this._updateMetric(maxMeters);}
if(options.imperial&&maxMeters){this._updateImperial(maxMeters);}},_updateMetric:function(maxMeters){var meters=this._getRoundNum(maxMeters);this._mScale.style.width=this._getScaleWidth(meters / maxMeters)+'px';this._mScale.innerHTML=meters<1000?meters+' m':(meters / 1000)+' km';},_updateImperial:function(maxMeters){var maxFeet=maxMeters*3.2808399,scale=this._iScale,maxMiles,miles,feet;if(maxFeet>5280){maxMiles=maxFeet / 5280;miles=this._getRoundNum(maxMiles);scale.style.width=this._getScaleWidth(miles / maxMiles)+'px';scale.innerHTML=miles+' mi';}else{feet=this._getRoundNum(maxFeet);scale.style.width=this._getScaleWidth(feet / maxFeet)+'px';scale.innerHTML=feet+' ft';}},_getScaleWidth:function(ratio){return Math.round(this.options.maxWidth*ratio)-10;},_getRoundNum:function(num){var pow10=Math.pow(10,(Math.floor(num)+'').length-1),d=num / pow10;d=d>=10?10:d>=5?5:d>=3?3:d>=2?2:1;return pow10*d;}});L.control.scale=function(options){return new L.Control.Scale(options);};L.Control.Layers=L.Control.extend({options:{collapsed:true,position:'topright',autoZIndex:true},initialize:function(baseLayers,overlays,options){L.setOptions(this,options);this._layers={};this._lastZIndex=0;this._handlingClick=false;for(var i in baseLayers){this._addLayer(baseLayers[i],i);}
for(i in overlays){this._addLayer(overlays[i],i,true);}},onAdd:function(map){this._initLayout();this._update();map.on('layeradd',this._onLayerChange,this).on('layerremove',this._onLayerChange,this);return this._container;},onRemove:function(map){map.off('layeradd',this._onLayerChange,this).off('layerremove',this._onLayerChange,this);},addBaseLayer:function(layer,name){this._addLayer(layer,name);this._update();return this;},addOverlay:function(layer,name){this._addLayer(layer,name,true);this._update();return this;},removeLayer:function(layer){var id=L.stamp(layer);delete this._layers[id];this._update();return this;},_initLayout:function(){var className='leaflet-control-layers',container=this._container=L.DomUtil.create('div',className);container.setAttribute('aria-haspopup',true);if(!L.Browser.touch){L.DomEvent.disableClickPropagation(container).disableScrollPropagation(container);}else{L.DomEvent.on(container,'click',L.DomEvent.stopPropagation);}
var form=this._form=L.DomUtil.create('form',className+'-list');if(this.options.collapsed){if(!L.Browser.android){L.DomEvent.on(container,'mouseover',this._expand,this).on(container,'mouseout',this._collapse,this);}
var link=this._layersLink=L.DomUtil.create('a',className+'-toggle',container);link.href='#';link.title='Layers';if(L.Browser.touch){L.DomEvent.on(link,'click',L.DomEvent.stop).on(link,'click',this._expand,this);}
else{L.DomEvent.on(link,'focus',this._expand,this);}
L.DomEvent.on(form,'click',function(){setTimeout(L.bind(this._onInputClick,this),0);},this);this._map.on('click',this._collapse,this);}else{this._expand();}
this._baseLayersList=L.DomUtil.create('div',className+'-base',form);this._separator=L.DomUtil.create('div',className+'-separator',form);this._overlaysList=L.DomUtil.create('div',className+'-overlays',form);container.appendChild(form);},_addLayer:function(layer,name,overlay){var id=L.stamp(layer);this._layers[id]={layer:layer,name:name,overlay:overlay};if(this.options.autoZIndex&&layer.setZIndex){this._lastZIndex++;layer.setZIndex(this._lastZIndex);}},_update:function(){if(!this._container){return;}
this._baseLayersList.innerHTML='';this._overlaysList.innerHTML='';var baseLayersPresent=false,overlaysPresent=false,i,obj;for(i in this._layers){obj=this._layers[i];this._addItem(obj);overlaysPresent=overlaysPresent||obj.overlay;baseLayersPresent=baseLayersPresent||!obj.overlay;}
this._separator.style.display=overlaysPresent&&baseLayersPresent?'':'none';},_onLayerChange:function(e){var obj=this._layers[L.stamp(e.layer)];if(!obj){return;}
if(!this._handlingClick){this._update();}
var type=obj.overlay?(e.type==='layeradd'?'overlayadd':'overlayremove'):(e.type==='layeradd'?'baselayerchange':null);if(type){this._map.fire(type,obj);}},_createRadioElement:function(name,checked){var radioHtml='<input type="radio" class="leaflet-control-layers-selector" name="'+name+'"';if(checked){radioHtml+=' checked="checked"';}
radioHtml+='/>';var radioFragment=document.createElement('div');radioFragment.innerHTML=radioHtml;return radioFragment.firstChild;},_addItem:function(obj){var label=document.createElement('label'),input,checked=this._map.hasLayer(obj.layer);if(obj.overlay){input=document.createElement('input');input.type='checkbox';input.className='leaflet-control-layers-selector';input.defaultChecked=checked;}else{input=this._createRadioElement('leaflet-base-layers',checked);}
input.layerId=L.stamp(obj.layer);L.DomEvent.on(input,'click',this._onInputClick,this);var name=document.createElement('span');name.innerHTML=' '+obj.name;label.appendChild(input);label.appendChild(name);var container=obj.overlay?this._overlaysList:this._baseLayersList;container.appendChild(label);return label;},_onInputClick:function(){var i,input,obj,inputs=this._form.getElementsByTagName('input'),inputsLen=inputs.length;this._handlingClick=true;for(i=0;i<inputsLen;i++){input=inputs[i];obj=this._layers[input.layerId];if(input.checked&&!this._map.hasLayer(obj.layer)){this._map.addLayer(obj.layer);}else if(!input.checked&&this._map.hasLayer(obj.layer)){this._map.removeLayer(obj.layer);}}
this._handlingClick=false;this._refocusOnMap();},_expand:function(){L.DomUtil.addClass(this._container,'leaflet-control-layers-expanded');},_collapse:function(){this._container.className=this._container.className.replace(' leaflet-control-layers-expanded','');}});L.control.layers=function(baseLayers,overlays,options){return new L.Control.Layers(baseLayers,overlays,options);};L.PosAnimation=L.Class.extend({includes:L.Mixin.Events,run:function(el,newPos,duration,easeLinearity){this.stop();this._el=el;this._inProgress=true;this._newPos=newPos;this.fire('start');el.style[L.DomUtil.TRANSITION]='all '+(duration||0.25)+'s cubic-bezier(0,0,'+(easeLinearity||0.5)+',1)';L.DomEvent.on(el,L.DomUtil.TRANSITION_END,this._onTransitionEnd,this);L.DomUtil.setPosition(el,newPos);L.Util.falseFn(el.offsetWidth);this._stepTimer=setInterval(L.bind(this._onStep,this),50);},stop:function(){if(!this._inProgress){return;}
L.DomUtil.setPosition(this._el,this._getPos());this._onTransitionEnd();L.Util.falseFn(this._el.offsetWidth);},_onStep:function(){var stepPos=this._getPos();if(!stepPos){this._onTransitionEnd();return;}
this._el._leaflet_pos=stepPos;this.fire('step');},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var left,top,matches,el=this._el,style=window.getComputedStyle(el);if(L.Browser.any3d){matches=style[L.DomUtil.TRANSFORM].match(this._transformRe);if(!matches){return;}
left=parseFloat(matches[1]);top=parseFloat(matches[2]);}else{left=parseFloat(style.left);top=parseFloat(style.top);}
return new L.Point(left,top,true);},_onTransitionEnd:function(){L.DomEvent.off(this._el,L.DomUtil.TRANSITION_END,this._onTransitionEnd,this);if(!this._inProgress){return;}
this._inProgress=false;this._el.style[L.DomUtil.TRANSITION]='';this._el._leaflet_pos=this._newPos;clearInterval(this._stepTimer);this.fire('step').fire('end');}});L.Map.include({setView:function(center,zoom,options){zoom=zoom===undefined?this._zoom:this._limitZoom(zoom);center=this._limitCenter(L.latLng(center),zoom,this.options.maxBounds);options=options||{};if(this._panAnim){this._panAnim.stop();}
if(this._loaded&&!options.reset&&options!==true){if(options.animate!==undefined){options.zoom=L.extend({animate:options.animate},options.zoom);options.pan=L.extend({animate:options.animate},options.pan);}
var animated=(this._zoom!==zoom)?this._tryAnimatedZoom&&this._tryAnimatedZoom(center,zoom,options.zoom):this._tryAnimatedPan(center,options.pan);if(animated){clearTimeout(this._sizeTimer);return this;}}
this._resetView(center,zoom);return this;},panBy:function(offset,options){offset=L.point(offset).round();options=options||{};if(!offset.x&&!offset.y){return this;}
if(!this._panAnim){this._panAnim=new L.PosAnimation();this._panAnim.on({'step':this._onPanTransitionStep,'end':this._onPanTransitionEnd},this);}
if(!options.noMoveStart){this.fire('movestart');}
if(options.animate!==false){L.DomUtil.addClass(this._mapPane,'leaflet-pan-anim');var newPos=this._getMapPanePos().subtract(offset);this._panAnim.run(this._mapPane,newPos,options.duration||0.25,options.easeLinearity);}else{this._rawPanBy(offset);this.fire('move').fire('moveend');}
return this;},_onPanTransitionStep:function(){this.fire('move');},_onPanTransitionEnd:function(){L.DomUtil.removeClass(this._mapPane,'leaflet-pan-anim');this.fire('moveend');},_tryAnimatedPan:function(center,options){var offset=this._getCenterOffset(center)._floor();if((options&&options.animate)!==true&&!this.getSize().contains(offset)){return false;}
this.panBy(offset,options);return true;}});L.PosAnimation=L.DomUtil.TRANSITION?L.PosAnimation:L.PosAnimation.extend({run:function(el,newPos,duration,easeLinearity){this.stop();this._el=el;this._inProgress=true;this._duration=duration||0.25;this._easeOutPower=1 / Math.max(easeLinearity||0.5,0.2);this._startPos=L.DomUtil.getPosition(el);this._offset=newPos.subtract(this._startPos);this._startTime=+new Date();this.fire('start');this._animate();},stop:function(){if(!this._inProgress){return;}
this._step();this._complete();},_animate:function(){this._animId=L.Util.requestAnimFrame(this._animate,this);this._step();},_step:function(){var elapsed=(+new Date())-this._startTime,duration=this._duration*1000;if(elapsed<duration){this._runFrame(this._easeOut(elapsed / duration));}else{this._runFrame(1);this._complete();}},_runFrame:function(progress){var pos=this._startPos.add(this._offset.multiplyBy(progress));L.DomUtil.setPosition(this._el,pos);this.fire('step');},_complete:function(){L.Util.cancelAnimFrame(this._animId);this._inProgress=false;this.fire('end');},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower);}});L.Map.mergeOptions({zoomAnimation:true,zoomAnimationThreshold:4});if(L.DomUtil.TRANSITION){L.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation&&L.DomUtil.TRANSITION&&L.Browser.any3d&&!L.Browser.android23&&!L.Browser.mobileOpera;if(this._zoomAnimated){L.DomEvent.on(this._mapPane,L.DomUtil.TRANSITION_END,this._catchTransitionEnd,this);}});}
L.Map.include(!L.DomUtil.TRANSITION?{}:{_catchTransitionEnd:function(e){if(this._animatingZoom&&e.propertyName.indexOf('transform')>=0){this._onZoomTransitionEnd();}},_nothingToAnimate:function(){return!this._container.getElementsByClassName('leaflet-zoom-animated').length;},_tryAnimatedZoom:function(center,zoom,options){if(this._animatingZoom){return true;}
options=options||{};if(!this._zoomAnimated||options.animate===false||this._nothingToAnimate()||Math.abs(zoom-this._zoom)>this.options.zoomAnimationThreshold){return false;}
var scale=this.getZoomScale(zoom),offset=this._getCenterOffset(center)._divideBy(1-1 / scale),origin=this._getCenterLayerPoint()._add(offset);if(options.animate!==true&&!this.getSize().contains(offset)){return false;}
this.fire('movestart').fire('zoomstart');this._animateZoom(center,zoom,origin,scale,null,true);return true;},_animateZoom:function(center,zoom,origin,scale,delta,backwards,forTouchZoom){if(!forTouchZoom){this._animatingZoom=true;}
L.DomUtil.addClass(this._mapPane,'leaflet-zoom-anim');this._animateToCenter=center;this._animateToZoom=zoom;if(L.Draggable){L.Draggable._disabled=true;}
L.Util.requestAnimFrame(function(){this.fire('zoomanim',{center:center,zoom:zoom,origin:origin,scale:scale,delta:delta,backwards:backwards});setTimeout(L.bind(this._onZoomTransitionEnd,this),250);},this);},_onZoomTransitionEnd:function(){if(!this._animatingZoom){return;}
this._animatingZoom=false;L.DomUtil.removeClass(this._mapPane,'leaflet-zoom-anim');this._resetView(this._animateToCenter,this._animateToZoom,true,true);if(L.Draggable){L.Draggable._disabled=false;}}});L.TileLayer.include({_animateZoom:function(e){if(!this._animating){this._animating=true;this._prepareBgBuffer();}
var bg=this._bgBuffer,transform=L.DomUtil.TRANSFORM,initialTransform=e.delta?L.DomUtil.getTranslateString(e.delta):bg.style[transform],scaleStr=L.DomUtil.getScaleString(e.scale,e.origin);bg.style[transform]=e.backwards?scaleStr+' '+initialTransform:initialTransform+' '+scaleStr;},_endZoomAnim:function(){var front=this._tileContainer,bg=this._bgBuffer;front.style.visibility='';front.parentNode.appendChild(front);L.Util.falseFn(bg.offsetWidth);var zoom=this._map.getZoom();if(zoom>this.options.maxZoom||zoom<this.options.minZoom){this._clearBgBuffer();}
this._animating=false;},_clearBgBuffer:function(){var map=this._map;if(map&&!map._animatingZoom&&!map.touchZoom._zooming){this._bgBuffer.innerHTML='';this._bgBuffer.style[L.DomUtil.TRANSFORM]='';}},_prepareBgBuffer:function(){var front=this._tileContainer,bg=this._bgBuffer;var bgLoaded=this._getLoadedTilesPercentage(bg),frontLoaded=this._getLoadedTilesPercentage(front);if(bg&&bgLoaded>0.5&&frontLoaded<0.5){front.style.visibility='hidden';this._stopLoadingImages(front);return;}
bg.style.visibility='hidden';bg.style[L.DomUtil.TRANSFORM]='';this._tileContainer=bg;bg=this._bgBuffer=front;this._stopLoadingImages(bg);clearTimeout(this._clearBgBufferTimer);},_getLoadedTilesPercentage:function(container){var tiles=container.getElementsByTagName('img'),i,len,count=0;for(i=0,len=tiles.length;i<len;i++){if(tiles[i].complete){count++;}}
return count / len;},_stopLoadingImages:function(container){var tiles=Array.prototype.slice.call(container.getElementsByTagName('img')),i,len,tile;for(i=0,len=tiles.length;i<len;i++){tile=tiles[i];if(!tile.complete){tile.onload=L.Util.falseFn;tile.onerror=L.Util.falseFn;tile.src=L.Util.emptyImageUrl;tile.parentNode.removeChild(tile);}}}});L.Map.include({_defaultLocateOptions:{watch:false,setView:false,maxZoom:Infinity,timeout:10000,maximumAge:0,enableHighAccuracy:false},locate:function(options){options=this._locateOptions=L.extend(this._defaultLocateOptions,options);if(!navigator.geolocation){this._handleGeolocationError({code:0,message:'Geolocation not supported.'});return this;}
var onResponse=L.bind(this._handleGeolocationResponse,this),onError=L.bind(this._handleGeolocationError,this);if(options.watch){this._locationWatchId=navigator.geolocation.watchPosition(onResponse,onError,options);}else{navigator.geolocation.getCurrentPosition(onResponse,onError,options);}
return this;},stopLocate:function(){if(navigator.geolocation){navigator.geolocation.clearWatch(this._locationWatchId);}
if(this._locateOptions){this._locateOptions.setView=false;}
return this;},_handleGeolocationError:function(error){var c=error.code,message=error.message||(c===1?'permission denied':(c===2?'position unavailable':'timeout'));if(this._locateOptions.setView&&!this._loaded){this.fitWorld();}
this.fire('locationerror',{code:c,message:'Geolocation error: '+message+'.'});},_handleGeolocationResponse:function(pos){var lat=pos.coords.latitude,lng=pos.coords.longitude,latlng=new L.LatLng(lat,lng),latAccuracy=180*pos.coords.accuracy / 40075017,lngAccuracy=latAccuracy / Math.cos(L.LatLng.DEG_TO_RAD*lat),bounds=L.latLngBounds([lat-latAccuracy,lng-lngAccuracy],[lat+latAccuracy,lng+lngAccuracy]),options=this._locateOptions;if(options.setView){var zoom=Math.min(this.getBoundsZoom(bounds),options.maxZoom);this.setView(latlng,zoom);}
var data={latlng:latlng,bounds:bounds,timestamp:pos.timestamp};for(var i in pos.coords){if(typeof pos.coords[i]==='number'){data[i]=pos.coords[i];}}
this.fire('locationfound',data);}});}(window,document));

/**
 * http://github.com/Leaflet/Leaflet.fullscreen  --  dist/Leaflet.fullscreen.js (3.2 kb)
 */
L.Control.Fullscreen=L.Control.extend({options:{position:'topleft',title:{'false':'View Fullscreen','true':'Exit Fullscreen'}},onAdd:function(map){var container=L.DomUtil.create('div','leaflet-control-fullscreen leaflet-bar leaflet-control');this.link=L.DomUtil.create('a','leaflet-control-fullscreen-button leaflet-bar-part',container);this.link.href='#';this._map=map;this._map.on('fullscreenchange',this._toggleTitle,this);this._toggleTitle();L.DomEvent.on(this.link,'click',this._click,this);return container;},_click:function(e){L.DomEvent.stopPropagation(e);L.DomEvent.preventDefault(e);this._map.toggleFullscreen();},_toggleTitle:function(){this.link.title=this.options.title[this._map.isFullscreen()];}});L.Map.include({isFullscreen:function(){return this._isFullscreen||false;},toggleFullscreen:function(){var container=this.getContainer();if(this.isFullscreen()){if(document.exitFullscreen){document.exitFullscreen();}else if(document.mozCancelFullScreen){document.mozCancelFullScreen();}else if(document.webkitCancelFullScreen){document.webkitCancelFullScreen();}else if(document.msExitFullscreen){document.msExitFullscreen();}else{L.DomUtil.removeClass(container,'leaflet-pseudo-fullscreen');this._setFullscreen(false);this.invalidateSize();this.fire('fullscreenchange');}}else{if(container.requestFullscreen){container.requestFullscreen();}else if(container.mozRequestFullScreen){container.mozRequestFullScreen();}else if(container.webkitRequestFullscreen){container.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);}else if(container.msRequestFullscreen){container.msRequestFullscreen();}else{L.DomUtil.addClass(container,'leaflet-pseudo-fullscreen');this._setFullscreen(true);this.invalidateSize();this.fire('fullscreenchange');}}},_setFullscreen:function(fullscreen){this._isFullscreen=fullscreen;var container=this.getContainer();if(fullscreen){L.DomUtil.addClass(container,'leaflet-fullscreen-on');}else{L.DomUtil.removeClass(container,'leaflet-fullscreen-on');}},_onFullscreenChange:function(e){var fullscreenElement=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;if(fullscreenElement===this.getContainer()&&!this._isFullscreen){this._setFullscreen(true);this.fire('fullscreenchange');}else if(fullscreenElement!==this.getContainer()&&this._isFullscreen){this._setFullscreen(false);this.fire('fullscreenchange');}}});L.Map.mergeOptions({fullscreenControl:false});L.Map.addInitHook(function(){if(this.options.fullscreenControl){this.fullscreenControl=new L.Control.Fullscreen();this.addControl(this.fullscreenControl);}
var fullscreenchange;if('onfullscreenchange'in document){fullscreenchange='fullscreenchange';}else if('onmozfullscreenchange'in document){fullscreenchange='mozfullscreenchange';}else if('onwebkitfullscreenchange'in document){fullscreenchange='webkitfullscreenchange';}else if('onmsfullscreenchange'in document){fullscreenchange='MSFullscreenChange';}
if(fullscreenchange){var onFullscreenChange=L.bind(this._onFullscreenChange,this);this.whenReady(function(){L.DomEvent.on(document,fullscreenchange,onFullscreenChange);});this.on('unload',function(){L.DomEvent.off(document,fullscreenchange,onFullscreenChange);});}});L.control.fullscreen=function(options){return new L.Control.Fullscreen(options);};

/**
 * http://github.com/stefanocudini/leaflet-gps  --  src/leaflet-gps.js (2.7 kb)
 */
(function(){L.Control.Gps=L.Control.extend({includes:L.Mixin.Events,options:{autoActive:false,autoCenter:false,maxZoom:null,textErr:null,callErr:null,style:{radius:5,weight:2,color:'#c20',opacity:1,fillColor:'#f23',fillOpacity:1},marker:null,accuracy:true,title:'Center map on your location',position:'topleft',transform:function(latlng){return latlng},setView:false},initialize:function(options){if(options&&options.style)
options.style=L.Util.extend({},this.options.style,options.style);L.Util.setOptions(this,options);this._errorFunc=this.options.callErr||this.showAlert;this._isActive=false;this._firstMoved=false;this._currentLocation=null;},onAdd:function(map){this._map=map;var container=L.DomUtil.create('div','leaflet-control-gps');this._button=L.DomUtil.create('a','gps-button',container);this._button.href='#';this._button.title=this.options.title;L.DomEvent.on(this._button,'click',L.DomEvent.stop,this).on(this._button,'click',this._switchGps,this);this._alert=L.DomUtil.create('div','gps-alert',container);this._alert.style.display='none';this._gpsMarker=this.options.marker?this.options.marker:new L.CircleMarker([0,0],this.options.style);this._map.on('locationfound',this._drawGps,this).on('locationerror',this._errorGps,this);if(this.options.autoActive)
this.activate();return container;},onRemove:function(map){this.deactivate();},_switchGps:function(){if(this._isActive)
this.deactivate();else
this.activate();},getLocation:function(){return this._currentLocation;},activate:function(){this._isActive=true;this._map.addLayer(this._gpsMarker);this._map.locate({enableHighAccuracy:true,watch:true,setView:this.options.setView,maxZoom:this.options.maxZoom});},deactivate:function(){this._isActive=false;this._firstMoved=false;this._map.stopLocate();L.DomUtil.removeClass(this._button,'active');this._map.removeLayer(this._gpsMarker);this.fire('gpsdisabled');},_drawGps:function(e){this._currentLocation=this.options.transform(e.latlng);this._gpsMarker.setLatLng(this._currentLocation);if(this._isActive&&(!this._firstMoved||this.options.autoCenter))
this._moveTo(this._currentLocation);this.fire('gpslocated',{latlng:this._currentLocation,marker:this._gpsMarker});L.DomUtil.addClass(this._button,'active');},_moveTo:function(latlng){this._firstMoved=true;if(this.options.maxZoom)
this._map.setView(latlng,Math.min(this._map.getZoom(),this.options.maxZoom));else
this._map.panTo(latlng);},_errorGps:function(e){this.deactivate();this._errorFunc.call(this,this.options.textErr||e.message);},showAlert:function(text){this._alert.style.display='block';this._alert.innerHTML=text;var that=this;clearTimeout(this.timerAlert);this.timerAlert=setTimeout(function(){that._alert.style.display='none';},2000);}});L.control.gps=function(options){return new L.Control.Gps(options);};}).call(this);

/**
 * http://github.com/shramov/leaflet-plugins  --  control/Permalink.js (3.2 kb)
 */
L.Control.Permalink=L.Control.extend({includes:L.Mixin.Events,options:{position:'bottomleft',useAnchor:true,useLocation:false,text:'Permalink'},initialize:function(options){L.Util.setOptions(this,options);this._params={};this._set_urlvars();this.on('update',this._set_center,this);for(var i in this){if(typeof(i)==='string'&&i.indexOf('initialize_')===0)
this[i]();}},onAdd:function(map){this._container=L.DomUtil.create('div','leaflet-control-attribution leaflet-control-permalink');L.DomEvent.disableClickPropagation(this._container);this._map=map;this._href=L.DomUtil.create('a',null,this._container);this._href.innerHTML=this.options.text;map.on('moveend',this._update_center,this);this.fire('update',{params:this._params});this._update_center();if(this.options.useAnchor&&'onhashchange'in window){var _this=this,fn=window.onhashchange;window.onhashchange=function(){_this._set_urlvars();if(fn)return fn();};}
this.fire('add',{map:map});return this._container;},_update_center:function(){if(!this._map)return;var center=this._round_point(this._map.getCenter());this._update({zoom:String(this._map.getZoom()),lat:String(center.lat),lon:String(center.lng)});},_update_href:function(){var params=L.Util.getParamString(this._params);var sep='?';if(this.options.useAnchor)sep='#';var url=this._url_base+sep+params.slice(1);if(this._href)this._href.setAttribute('href',url);if(this.options.useLocation)
location.replace('#'+params.slice(1));return url;},_round_point:function(point){var bounds=this._map.getBounds(),size=this._map.getSize();var ne=bounds.getNorthEast(),sw=bounds.getSouthWest();var round=function(x,p){if(p===0)return x;var shift=1;while(p<1&&p>-1){x*=10;p*=10;shift*=10;}
return Math.floor(x)/shift;};point.lat=round(point.lat,(ne.lat-sw.lat)/ size.y);point.lng=round(point.lng,(ne.lng-sw.lng)/ size.x);return point;},_update:function(obj,source){for(var i in obj){if(!obj.hasOwnProperty(i))continue;if(obj[i]!==null&&obj[i]!==undefined)
this._params[i]=obj[i];else
delete this._params[i];}
this._update_href();},_set_urlvars:function()
{this._url_base=window.location.href.split('#')[0].split('?')[0];var p;if(this.options.useAnchor)
p=L.UrlUtil.queryParse(L.UrlUtil.hash());else
p=L.UrlUtil.queryParse(L.UrlUtil.query());function eq(x,y){for(var i in x)
if(x.hasOwnProperty(i)&&x[i]!==y[i])
return false;return true;}
if(eq(p,this._params)&&eq(this._params,p))
return;this._params=p;this._update_href();this.fire('update',{params:this._params});},_set_center:function(e)
{var params=e.params;if(params.zoom===undefined||params.lat===undefined||params.lon===undefined)return;this._map.setView(new L.LatLng(params.lat,params.lon),params.zoom);}});L.UrlUtil={queryParse:function(s){var p={};var sep='&';if(s.search('&amp;')!==-1)
sep='&amp;';var params=s.split(sep);for(var i=0;i<params.length;i++){var tmp=params[i].split('=');if(tmp.length!==2)continue;p[tmp[0]]=decodeURI(tmp[1]);}
return p;},query:function(){var href=window.location.href.split('#')[0],idx=href.indexOf('?');if(idx<0)
return'';return href.slice(idx+1);},hash:function(){return window.location.hash.slice(1);},updateParamString:function(q,obj){var p=L.UrlUtil.queryParse(q);for(var i in obj){if(obj.hasOwnProperty(i))
p[i]=obj[i];}
return L.Util.getParamString(p).slice(1);}};

/**
 * http://github.com/MrMufflon/Leaflet.Coordinates  --  src/util/NumberFormatter.js (0.8 kb)
 */
L.NumberFormatter={round:function(num,dec,sep){var res=L.Util.formatNum(num,dec)+"",numbers=res.split(".");if(numbers[1]){var d=dec-numbers[1].length;for(;d>0;d--){numbers[1]+="0";}
res=numbers.join(sep||".");}
return res;},toDMS:function(deg){var d=Math.floor(Math.abs(deg));var minfloat=(Math.abs(deg)-d)*60;var m=Math.floor(minfloat);var secfloat=(minfloat-m)*60;var s=Math.round(secfloat);if(s==60){m++;s="00";}
if(m==60){d++;m="00";}
if(s<10){s="0"+s;}
if(m<10){m="0"+m;}
var dir="";if(deg<0){dir="-";}
return(""+dir+d+"&deg; "+m+"' "+s+"''");},createValidNumber:function(num,sep){if(num&&num.length>0){var numbers=num.split(sep||".");try{var numRes=Number(numbers.join("."));if(isNaN(numRes)){return undefined;}
return numRes;}catch(e){return undefined;}}
return undefined;}};

/**
 * http://github.com/MrMufflon/Leaflet.Coordinates  --  src/Control.Coordinates.js (5.4 kb)
 */
L.Control.Coordinates=L.Control.extend({options:{position:'bottomright',decimals:4,decimalSeperator:".",labelTemplateLat:"Lat: {y}",labelTemplateLng:"Lng: {x}",labelFormatterLat:undefined,labelFormatterLng:undefined,enableUserInput:true,useDMS:false,useLatLngOrder:false,centerUserCoordinates:false,markerType:L.marker,markerProps:{}},onAdd:function(map){this._map=map;var className='leaflet-control-coordinates',container=this._container=L.DomUtil.create('div',className),options=this.options;this._labelcontainer=L.DomUtil.create("div","uiElement label",container);this._label=L.DomUtil.create("span","labelFirst",this._labelcontainer);this._inputcontainer=L.DomUtil.create("div","uiElement input uiHidden",container);var xSpan,ySpan;if(options.useLatLngOrder){ySpan=L.DomUtil.create("span","",this._inputcontainer);this._inputY=this._createInput("inputY",this._inputcontainer);xSpan=L.DomUtil.create("span","",this._inputcontainer);this._inputX=this._createInput("inputX",this._inputcontainer);}else{xSpan=L.DomUtil.create("span","",this._inputcontainer);this._inputX=this._createInput("inputX",this._inputcontainer);ySpan=L.DomUtil.create("span","",this._inputcontainer);this._inputY=this._createInput("inputY",this._inputcontainer);}
xSpan.innerHTML=options.labelTemplateLng.replace("{x}","");ySpan.innerHTML=options.labelTemplateLat.replace("{y}","");L.DomEvent.on(this._inputX,'keyup',this._handleKeypress,this);L.DomEvent.on(this._inputY,'keyup',this._handleKeypress,this);map.on("mousemove",this._update,this);map.on('dragstart',this.collapse,this);map.whenReady(this._update,this);this._showsCoordinates=true;if(options.enableUserInput){L.DomEvent.addListener(this._container,"click",this._switchUI,this);}
return container;},_createInput:function(classname,container){var input=L.DomUtil.create("input",classname,container);input.type="text";L.DomEvent.disableClickPropagation(input);return input;},_clearMarker:function(){this._map.removeLayer(this._marker);},_handleKeypress:function(e){switch(e.keyCode){case 27:this.collapse();break;case 13:this._handleSubmit();this.collapse();break;default:this._handleSubmit();break;}},_handleSubmit:function(){var x=L.NumberFormatter.createValidNumber(this._inputX.value,this.options.decimalSeperator);var y=L.NumberFormatter.createValidNumber(this._inputY.value,this.options.decimalSeperator);if(x!==undefined&&y!==undefined){var marker=this._marker;if(!marker){marker=this._marker=this._createNewMarker();marker.on("click",this._clearMarker,this);}
var ll=new L.LatLng(y,x);marker.setLatLng(ll);marker.addTo(this._map);if(this.options.centerUserCoordinates){this._map.setView(ll,this._map.getZoom());}}},expand:function(){this._showsCoordinates=false;this._map.off("mousemove",this._update,this);L.DomEvent.addListener(this._container,"mousemove",L.DomEvent.stop);L.DomEvent.removeListener(this._container,"click",this._switchUI,this);L.DomUtil.addClass(this._labelcontainer,"uiHidden");L.DomUtil.removeClass(this._inputcontainer,"uiHidden");},_createCoordinateLabel:function(ll){var opts=this.options,x,y;if(opts.labelFormatterLng){x=opts.labelFormatterLng(ll.lng);}else{x=L.Util.template(opts.labelTemplateLng,{x:this._getNumber(ll.lng,opts)});}
if(opts.labelFormatterLat){y=opts.labelFormatterLat(ll.lat);}else{y=L.Util.template(opts.labelTemplateLat,{y:this._getNumber(ll.lat,opts)});}
if(opts.useLatLngOrder){return y+" "+x;}
return x+" "+y;},_getNumber:function(n,opts){var res;if(opts.useDMS){res=L.NumberFormatter.toDMS(n);}else{res=L.NumberFormatter.round(n,opts.decimals,opts.decimalSeperator);}
return res;},collapse:function(){if(!this._showsCoordinates){this._map.on("mousemove",this._update,this);this._showsCoordinates=true;var opts=this.options;L.DomEvent.addListener(this._container,"click",this._switchUI,this);L.DomEvent.removeListener(this._container,"mousemove",L.DomEvent.stop);L.DomUtil.addClass(this._inputcontainer,"uiHidden");L.DomUtil.removeClass(this._labelcontainer,"uiHidden");if(this._marker){var m=this._createNewMarker(),ll=this._marker.getLatLng();m.setLatLng(ll);var container=L.DomUtil.create("div","");var label=L.DomUtil.create("div","",container);label.innerHTML=this._createCoordinateLabel(ll);var close=L.DomUtil.create("a","",container);close.innerHTML="Remove";close.href="#";var stop=L.DomEvent.stopPropagation;L.DomEvent.on(close,'click',stop).on(close,'mousedown',stop).on(close,'dblclick',stop).on(close,'click',L.DomEvent.preventDefault).on(close,'click',function(){this._map.removeLayer(m);},this);m.bindPopup(container);m.addTo(this._map);this._map.removeLayer(this._marker);this._marker=null;}}},_switchUI:function(evt){L.DomEvent.stop(evt);L.DomEvent.stopPropagation(evt);L.DomEvent.preventDefault(evt);if(this._showsCoordinates){this.expand();}else{this.collapse();}},onRemove:function(map){map.off("mousemove",this._update,this);},_update:function(evt){var pos=evt.latlng,opts=this.options;if(pos){pos=pos.wrap();this._currentPos=pos;this._inputY.value=L.NumberFormatter.round(pos.lat,opts.decimals,opts.decimalSeperator);this._inputX.value=L.NumberFormatter.round(pos.lng,opts.decimals,opts.decimalSeperator);this._label.innerHTML=this._createCoordinateLabel(pos);}},_createNewMarker:function(){return this.options.markerType(null,this.options.markerProps);}});L.control.coordinates=function(options){return new L.Control.Coordinates(options);};L.Map.mergeOptions({coordinateControl:false});L.Map.addInitHook(function(){if(this.options.coordinateControl){this.coordinateControl=new L.Control.Coordinates();this.addControl(this.coordinateControl);}});

/**
 * http://github.com/k4r573n/leaflet-control-osm-geocoder  --  Control.OSMGeocoder.js (3.8 kb)
 */
if(typeof console=="undefined"){this.console={log:function(msg){}};}
L.Control.OSMGeocoder=L.Control.extend({options:{collapsed:true,position:'topright',text:'Locate',bounds:null,email:null,callback:function(results){if(results.length==0){console.log("ERROR: didn't find a result");return;}
var bbox=results[0].boundingbox,first=new L.LatLng(bbox[0],bbox[2]),second=new L.LatLng(bbox[1],bbox[3]),bounds=new L.LatLngBounds([first,second]);this._map.fitBounds(bounds);}},_callbackId:0,initialize:function(options){L.Util.setOptions(this,options);},onAdd:function(map){this._map=map;var className='leaflet-control-geocoder',container=this._container=L.DomUtil.create('div',className);L.DomEvent.disableClickPropagation(container);var form=this._form=L.DomUtil.create('form',className+'-form');var input=this._input=document.createElement('input');input.type="text";var submit=document.createElement('input');submit.type="submit";submit.value=this.options.text;form.appendChild(input);form.appendChild(submit);L.DomEvent.addListener(form,'submit',this._geocode,this);if(this.options.collapsed){L.DomEvent.addListener(container,'mouseover',this._expand,this);L.DomEvent.addListener(container,'mouseout',this._collapse,this);var link=this._layersLink=L.DomUtil.create('a',className+'-toggle',container);link.href='#';link.title='Nominatim Geocoder';L.DomEvent.addListener(link,L.Browser.touch?'click':'focus',this._expand,this);this._map.on('movestart',this._collapse,this);}else{this._expand();}
container.appendChild(form);return container;},_createSearchResult:function(lat,lon){var diff=0.005;var result=[];result[0]={};result[0]["boundingbox"]=[parseFloat(lat)-diff,parseFloat(lat)+diff,parseFloat(lon)-diff,parseFloat(lon)+diff];result[0]["class"]="boundary";result[0]["display_name"]="Position: "+lat+" "+lon;result[0]["lat"]=lat;result[0]["lon"]=lon;return result;},_isLatLon:function(q){var re=/(-?\d+\.\d+)\s(-?\d+\.\d+)/;var m=re.exec(q);if(m!=undefined)return m;re=/lat\D*(-?\d+\.\d+)\D*lon\D*(-?\d+\.\d+)/;m=re.exec(q);if(m!=undefined)return m;else return null;},_isLatLon_decMin:function(q){console.log("is LatLon?: "+q);re=/([ns])\s*(\d+)\D*(\d+\.\d+).?\s*([ew])\s*(\d+)\D*(\d+\.\d+)/i;m=re.exec(q.toLowerCase());if((m!=undefined))return m;else return null;},_geocode:function(event){L.DomEvent.preventDefault(event);var q=this._input.value;if(this._isLatLon(q)!=null)
{var m=this._isLatLon(q);console.log("LatLon: "+m[1]+" "+m[2]);this.options.callback.call(this,this._createSearchResult(m[1],m[2]));return;}
else if(this._isLatLon_decMin(q)!=null)
{var m=this._isLatLon_decMin(q);var temp=new Array();temp['n']=1;temp['s']=-1;temp['e']=1;temp['w']=-1;this.options.callback.call(this,this._createSearchResult(temp[m[1]]*(Number(m[2])+m[3]/60),temp[m[4]]*(Number(m[5])+m[6]/60)));return;}
console.log(this._callbackId);window[("_l_osmgeocoder_"+this._callbackId)]=L.Util.bind(this.options.callback,this);var params={q:this._input.value,json_callback:("_l_osmgeocoder_"+this._callbackId++),format:'json'};if(this.options.bounds&&this.options.bounds!=null){if(this.options.bounds instanceof L.LatLngBounds){params.viewbox=this.options.bounds.toBBoxString();params.bounded=1;}
else{console.log('bounds must be of type L.LatLngBounds');return;}}
if(this.options.email&&this.options.email!=null){if(typeof this.options.email=='string'){params.email=this.options.email;}
else{console.log('email must be a string');}}
var protocol=location.protocol;var url=protocol+"//nominatim.openstreetmap.org/search"+L.Util.getParamString(params),script=document.createElement("script");script.type="text/javascript";script.src=url;script.id=this._callbackId;document.getElementsByTagName("head")[0].appendChild(script);},_expand:function(){L.DomUtil.addClass(this._container,'leaflet-control-geocoder-expanded');},_collapse:function(){this._container.className=this._container.className.replace(' leaflet-control-geocoder-expanded','');}});

/**
 * http://github.com/Dominique92/MyLeaflet  --  src/MapAutoHeight.js (0.3 kb)
 */
L.Map.addInitHook(function(){if(!this._container.offsetHeight){this.autoHeight();L.DomEvent['on'](window,'resize',this.autoHeight,this);}});L.Map.include({autoHeight:function(){this._container.style.height=Math.min(this._container.offsetWidth,window.innerHeight-20)+'px';this._onResize();}});

/**
 * http://github.com/kartena/Proj4Leaflet  --  lib/proj4-compressed.js (69 kb)
 */
!function(t,s){"function"==typeof define&&define.amd?define(s):"undefined"!=typeof module?module.exports=s():t.proj4=s()}(this,function(){var t,s,i;return function(a){function h(t,s){return x.call(t,s)}function e(t,s){var i,a,h,e,n,r,o,l,u,c,M=s&&s.split("/"),f=y.map,m=f&&f["*"]||{};if(t&&"."===t.charAt(0))if(s){for(M=M.slice(0,M.length-1),t=M.concat(t.split("/")),l=0;l<t.length;l+=1)if(c=t[l],"."===c)t.splice(l,1),l-=1;else if(".."===c){if(1===l&&(".."===t[2]||".."===t[0]))break;l>0&&(t.splice(l-1,2),l-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((M||m)&&f){for(i=t.split("/"),l=i.length;l>0;l-=1){if(a=i.slice(0,l).join("/"),M)for(u=M.length;u>0;u-=1)if(h=f[M.slice(0,u).join("/")],h&&(h=h[a])){e=h,n=l;break}if(e)break;!r&&m&&m[a]&&(r=m[a],o=l)}!e&&r&&(e=r,n=o),e&&(i.splice(0,n,e),t=i.join("/"))}return t}function n(t,s){return function(){return f.apply(a,v.call(arguments,0).concat([t,s]))}}function r(t){return function(s){return e(s,t)}}function o(t){return function(s){_[t]=s}}function l(t){if(h(d,t)){var s=d[t];delete d[t],g[t]=!0,M.apply(a,s)}if(!h(_,t)&&!h(g,t))throw new Error("No "+t);return _[t]}function u(t){var s,i=t?t.indexOf("!"):-1;return i>-1&&(s=t.substring(0,i),t=t.substring(i+1,t.length)),[s,t]}function c(t){return function(){return y&&y.config&&y.config[t]||{}}}var M,f,m,p,_={},d={},y={},g={},x=Object.prototype.hasOwnProperty,v=[].slice;m=function(t,s){var i,a=u(t),h=a[0];return t=a[1],h&&(h=e(h,s),i=l(h)),h?t=i&&i.normalize?i.normalize(t,r(s)):e(t,s):(t=e(t,s),a=u(t),h=a[0],t=a[1],h&&(i=l(h))),{f:h?h+"!"+t:t,n:t,pr:h,p:i}},p={require:function(t){return n(t)},exports:function(t){var s=_[t];return"undefined"!=typeof s?s:_[t]={}},module:function(t){return{id:t,uri:"",exports:_[t],config:c(t)}}},M=function(t,s,i,e){var r,u,c,M,f,y,x=[];if(e=e||t,"function"==typeof i){for(s=!s.length&&i.length?["require","exports","module"]:s,f=0;f<s.length;f+=1)if(M=m(s[f],e),u=M.f,"require"===u)x[f]=p.require(t);else if("exports"===u)x[f]=p.exports(t),y=!0;else if("module"===u)r=x[f]=p.module(t);else if(h(_,u)||h(d,u)||h(g,u))x[f]=l(u);else{if(!M.p)throw new Error(t+" missing "+u);M.p.load(M.n,n(e,!0),o(u),{}),x[f]=_[u]}c=i.apply(_[t],x),t&&(r&&r.exports!==a&&r.exports!==_[t]?_[t]=r.exports:c===a&&y||(_[t]=c))}else t&&(_[t]=i)},t=s=f=function(t,s,i,h,e){return"string"==typeof t?p[t]?p[t](s):l(m(t,s).f):(t.splice||(y=t,s.splice?(t=s,s=i,i=null):t=a),s=s||function(){},"function"==typeof i&&(i=h,h=e),h?M(a,t,s,i):setTimeout(function(){M(a,t,s,i)},4),f)},f.config=function(t){return y=t,y.deps&&f(y.deps,y.callback),f},t._defined=_,i=function(t,s,i){s.splice||(i=s,s=[]),h(_,t)||h(d,t)||(d[t]=[t,s,i])},i.amd={jQuery:!0}}(),i("node_modules/almond/almond",function(){}),i("proj4/mgrs",["require","exports","module"],function(t,s){function i(t){return t*(Math.PI/180)}function a(t){return 180*(t/Math.PI)}function h(t){var s,a,h,e,r,o,l,u,c,M=t.lat,f=t.lon,m=6378137,p=.00669438,_=.9996,d=i(M),y=i(f);c=Math.floor((f+180)/6)+1,180===f&&(c=60),M>=56&&64>M&&f>=3&&12>f&&(c=32),M>=72&&84>M&&(f>=0&&9>f?c=31:f>=9&&21>f?c=33:f>=21&&33>f?c=35:f>=33&&42>f&&(c=37)),s=6*(c-1)-180+3,u=i(s),a=p/(1-p),h=m/Math.sqrt(1-p*Math.sin(d)*Math.sin(d)),e=Math.tan(d)*Math.tan(d),r=a*Math.cos(d)*Math.cos(d),o=Math.cos(d)*(y-u),l=m*((1-p/4-3*p*p/64-5*p*p*p/256)*d-(3*p/8+3*p*p/32+45*p*p*p/1024)*Math.sin(2*d)+(15*p*p/256+45*p*p*p/1024)*Math.sin(4*d)-35*p*p*p/3072*Math.sin(6*d));var g=_*h*(o+(1-e+r)*o*o*o/6+(5-18*e+e*e+72*r-58*a)*o*o*o*o*o/120)+5e5,x=_*(l+h*Math.tan(d)*(o*o/2+(5-e+9*r+4*r*r)*o*o*o*o/24+(61-58*e+e*e+600*r-330*a)*o*o*o*o*o*o/720));return 0>M&&(x+=1e7),{northing:Math.round(x),easting:Math.round(g),zoneNumber:c,zoneLetter:n(M)}}function e(t){var s=t.northing,i=t.easting,h=t.zoneLetter,n=t.zoneNumber;if(0>n||n>60)return null;var r,o,l,u,c,M,f,m,p,_,d=.9996,y=6378137,g=.00669438,x=(1-Math.sqrt(1-g))/(1+Math.sqrt(1-g)),v=i-5e5,P=s;"N">h&&(P-=1e7),m=6*(n-1)-180+3,r=g/(1-g),f=P/d,p=f/(y*(1-g/4-3*g*g/64-5*g*g*g/256)),_=p+(3*x/2-27*x*x*x/32)*Math.sin(2*p)+(21*x*x/16-55*x*x*x*x/32)*Math.sin(4*p)+151*x*x*x/96*Math.sin(6*p),o=y/Math.sqrt(1-g*Math.sin(_)*Math.sin(_)),l=Math.tan(_)*Math.tan(_),u=r*Math.cos(_)*Math.cos(_),c=y*(1-g)/Math.pow(1-g*Math.sin(_)*Math.sin(_),1.5),M=v/(o*d);var b=_-o*Math.tan(_)/c*(M*M/2-(5+3*l+10*u-4*u*u-9*r)*M*M*M*M/24+(61+90*l+298*u+45*l*l-252*r-3*u*u)*M*M*M*M*M*M/720);b=a(b);var C=(M-(1+2*l+u)*M*M*M/6+(5-2*u+28*l-3*u*u+8*r+24*l*l)*M*M*M*M*M/120)/Math.cos(_);C=m+a(C);var S;if(t.accuracy){var j=e({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});S={top:j.lat,right:j.lon,bottom:b,left:C}}else S={lat:b,lon:C};return S}function n(t){var s="Z";return 84>=t&&t>=72?s="X":72>t&&t>=64?s="W":64>t&&t>=56?s="V":56>t&&t>=48?s="U":48>t&&t>=40?s="T":40>t&&t>=32?s="S":32>t&&t>=24?s="R":24>t&&t>=16?s="Q":16>t&&t>=8?s="P":8>t&&t>=0?s="N":0>t&&t>=-8?s="M":-8>t&&t>=-16?s="L":-16>t&&t>=-24?s="K":-24>t&&t>=-32?s="J":-32>t&&t>=-40?s="H":-40>t&&t>=-48?s="G":-48>t&&t>=-56?s="F":-56>t&&t>=-64?s="E":-64>t&&t>=-72?s="D":-72>t&&t>=-80&&(s="C"),s}function r(t,s){var i=""+t.easting,a=""+t.northing;return t.zoneNumber+t.zoneLetter+o(t.easting,t.northing,t.zoneNumber)+i.substr(i.length-5,s)+a.substr(a.length-5,s)}function o(t,s,i){var a=l(i),h=Math.floor(t/1e5),e=Math.floor(s/1e5)%20;return u(h,e,a)}function l(t){var s=t%p;return 0===s&&(s=p),s}function u(t,s,i){var a=i-1,h=_.charCodeAt(a),e=d.charCodeAt(a),n=h+t-1,r=e+s,o=!1;n>P&&(n=n-P+y-1,o=!0),(n===g||g>h&&n>g||(n>g||g>h)&&o)&&n++,(n===x||x>h&&n>x||(n>x||x>h)&&o)&&(n++,n===g&&n++),n>P&&(n=n-P+y-1),r>v?(r=r-v+y-1,o=!0):o=!1,(r===g||g>e&&r>g||(r>g||g>e)&&o)&&r++,(r===x||x>e&&r>x||(r>x||x>e)&&o)&&(r++,r===g&&r++),r>v&&(r=r-v+y-1);var l=String.fromCharCode(n)+String.fromCharCode(r);return l}function c(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var s,i=t.length,a=null,h="",e=0;!/[A-Z]/.test(s=t.charAt(e));){if(e>=2)throw"MGRSPoint bad conversion from: "+t;h+=s,e++}var n=parseInt(h,10);if(0===e||e+3>i)throw"MGRSPoint bad conversion from: "+t;var r=t.charAt(e++);if("A">=r||"B"===r||"Y"===r||r>="Z"||"I"===r||"O"===r)throw"MGRSPoint zone letter "+r+" not handled: "+t;a=t.substring(e,e+=2);for(var o=l(n),u=M(a.charAt(0),o),c=f(a.charAt(1),o);c<m(r);)c+=2e6;var p=i-e;if(0!==p%2)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var _,d,y,g,x,v=p/2,P=0,b=0;return v>0&&(_=1e5/Math.pow(10,v),d=t.substring(e,e+v),P=parseFloat(d)*_,y=t.substring(e+v),b=parseFloat(y)*_),g=P+u,x=b+c,{easting:g,northing:x,zoneLetter:r,zoneNumber:n,accuracy:_}}function M(t,s){for(var i=_.charCodeAt(s-1),a=1e5,h=!1;i!==t.charCodeAt(0);){if(i++,i===g&&i++,i===x&&i++,i>P){if(h)throw"Bad character: "+t;i=y,h=!0}a+=1e5}return a}function f(t,s){if(t>"V")throw"MGRSPoint given invalid Northing "+t;for(var i=d.charCodeAt(s-1),a=0,h=!1;i!==t.charCodeAt(0);){if(i++,i===g&&i++,i===x&&i++,i>v){if(h)throw"Bad character: "+t;i=y,h=!0}a+=1e5}return a}function m(t){var s;switch(t){case"C":s=11e5;break;case"D":s=2e6;break;case"E":s=28e5;break;case"F":s=37e5;break;case"G":s=46e5;break;case"H":s=55e5;break;case"J":s=64e5;break;case"K":s=73e5;break;case"L":s=82e5;break;case"M":s=91e5;break;case"N":s=0;break;case"P":s=8e5;break;case"Q":s=17e5;break;case"R":s=26e5;break;case"S":s=35e5;break;case"T":s=44e5;break;case"U":s=53e5;break;case"V":s=62e5;break;case"W":s=7e6;break;case"X":s=79e5;break;default:s=-1}if(s>=0)return s;throw"Invalid zone letter: "+t}var p=6,_="AJSAJS",d="AFAFAF",y=65,g=73,x=79,v=86,P=90;s.forward=function(t,s){return s=s||5,r(h({lat:t.lat,lon:t.lon}),s)},s.inverse=function(t){var s=e(c(t.toUpperCase()));return[s.left,s.bottom,s.right,s.top]}}),i("proj4/Point",["./mgrs"],function(t){function s(t,i,a){if(!(this instanceof s))return new s(t,i,a);if("object"==typeof t)this.x=t[0],this.y=t[1],this.z=t[2]||0;else if("string"==typeof t&&"undefined"==typeof i){var h=t.split(",");this.x=parseFloat(h[0]),this.y=parseFloat(h[1]),this.z=parseFloat(h[2])||0}else this.x=t,this.y=i,this.z=a||0;this.clone=function(){return new s(this.x,this.y,this.z)},this.toString=function(){return"x="+this.x+",y="+this.y},this.toShortString=function(){return this.x+", "+this.y}}return s.fromMGRS=function(i){var a=t.inverse(i);return new s((a[2]+a[0])/2,(a[3]+a[1])/2)},s.prototype.toMGRS=function(s){return t.forward({lon:this.x,lat:this.y},s)},s}),i("proj4/extend",[],function(){return function(t,s){t=t||{};var i,a;if(!s)return t;for(a in s)i=s[a],void 0!==i&&(t[a]=i);return t}}),i("proj4/common",[],function(){var t={PI:3.141592653589793,HALF_PI:1.5707963267948966,TWO_PI:6.283185307179586,FORTPI:.7853981633974483,R2D:57.29577951308232,D2R:.017453292519943295,SEC_TO_RAD:484813681109536e-20,EPSLN:1e-10,MAX_ITER:20,COS_67P5:.3826834323650898,AD_C:1.0026,PJD_UNKNOWN:0,PJD_3PARAM:1,PJD_7PARAM:2,PJD_GRIDSHIFT:3,PJD_WGS84:4,PJD_NODATUM:5,SRS_WGS84_SEMIMAJOR:6378137,SRS_WGS84_ESQUARED:.006694379990141316,SIXTH:.16666666666666666,RA4:.04722222222222222,RA6:.022156084656084655,RV4:.06944444444444445,RV6:.04243827160493827,msfnz:function(t,s,i){var a=t*s;return i/Math.sqrt(1-a*a)},tsfnz:function(t,s,i){var a=t*i,h=.5*t;return a=Math.pow((1-a)/(1+a),h),Math.tan(.5*(this.HALF_PI-s))/a},phi2z:function(t,s){for(var i,a,h=.5*t,e=this.HALF_PI-2*Math.atan(s),n=0;15>=n;n++)if(i=t*Math.sin(e),a=this.HALF_PI-2*Math.atan(s*Math.pow((1-i)/(1+i),h))-e,e+=a,Math.abs(a)<=1e-10)return e;return-9999},qsfnz:function(t,s){var i;return t>1e-7?(i=t*s,(1-t*t)*(s/(1-i*i)-.5/t*Math.log((1-i)/(1+i)))):2*s},iqsfnz:function(s,i){var a=1-(1-s*s)/(2*s)*Math.log((1-s)/(1+s));if(Math.abs(Math.abs(i)-a)<1e-6)return 0>i?-1*t.HALF_PI:t.HALF_PI;for(var h,e,n,r,o=Math.asin(.5*i),l=0;30>l;l++)if(e=Math.sin(o),n=Math.cos(o),r=s*e,h=Math.pow(1-r*r,2)/(2*n)*(i/(1-s*s)-e/(1-r*r)+.5/s*Math.log((1-r)/(1+r))),o+=h,Math.abs(h)<=1e-10)return o;return 0/0},asinz:function(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)},e0fn:function(t){return 1-.25*t*(1+t/16*(3+1.25*t))},e1fn:function(t){return.375*t*(1+.25*t*(1+.46875*t))},e2fn:function(t){return.05859375*t*t*(1+.75*t)},e3fn:function(t){return t*t*t*(35/3072)},mlfn:function(t,s,i,a,h){return t*h-s*Math.sin(2*h)+i*Math.sin(4*h)-a*Math.sin(6*h)},imlfn:function(t,s,i,a,h){var e,n;e=t/s;for(var r=0;15>r;r++)if(n=(t-(s*e-i*Math.sin(2*e)+a*Math.sin(4*e)-h*Math.sin(6*e)))/(s-2*i*Math.cos(2*e)+4*a*Math.cos(4*e)-6*h*Math.cos(6*e)),e+=n,Math.abs(n)<=1e-10)return e;return 0/0},srat:function(t,s){return Math.pow((1-t)/(1+t),s)},sign:function(t){return 0>t?-1:1},adjust_lon:function(t){return t=Math.abs(t)<this.PI?t:t-this.sign(t)*this.TWO_PI},adjust_lat:function(t){return t=Math.abs(t)<this.HALF_PI?t:t-this.sign(t)*this.PI},latiso:function(t,s,i){if(Math.abs(s)>this.HALF_PI)return Number.NaN;if(s===this.HALF_PI)return Number.POSITIVE_INFINITY;if(s===-1*this.HALF_PI)return Number.NEGATIVE_INFINITY;var a=t*i;return Math.log(Math.tan((this.HALF_PI+s)/2))+t*Math.log((1-a)/(1+a))/2},fL:function(t,s){return 2*Math.atan(t*Math.exp(s))-this.HALF_PI},invlatiso:function(t,s){var i=this.fL(1,s),a=0,h=0;do a=i,h=t*Math.sin(a),i=this.fL(Math.exp(t*Math.log((1+h)/(1-h))/2),s);while(Math.abs(i-a)>1e-12);return i},sinh:function(t){var s=Math.exp(t);return s=(s-1/s)/2},cosh:function(t){var s=Math.exp(t);return s=(s+1/s)/2},tanh:function(t){var s=Math.exp(t);return s=(s-1/s)/(s+1/s)},asinh:function(t){var s=t>=0?1:-1;return s*Math.log(Math.abs(t)+Math.sqrt(t*t+1))},acosh:function(t){return 2*Math.log(Math.sqrt((t+1)/2)+Math.sqrt((t-1)/2))},atanh:function(t){return Math.log((t-1)/(t+1))/2},gN:function(t,s,i){var a=s*i;return t/Math.sqrt(1-a*a)},pj_enfn:function(t){var s=[];s[0]=this.C00-t*(this.C02+t*(this.C04+t*(this.C06+t*this.C08))),s[1]=t*(this.C22-t*(this.C04+t*(this.C06+t*this.C08)));var i=t*t;return s[2]=i*(this.C44-t*(this.C46+t*this.C48)),i*=t,s[3]=i*(this.C66-t*this.C68),s[4]=i*t*this.C88,s},pj_mlfn:function(t,s,i,a){return i*=s,s*=s,a[0]*t-i*(a[1]+s*(a[2]+s*(a[3]+s*a[4])))},pj_inv_mlfn:function(s,i,a){for(var h=1/(1-i),e=s,n=t.MAX_ITER;n;--n){var r=Math.sin(e),o=1-i*r*r;if(o=(this.pj_mlfn(e,r,Math.cos(e),a)-s)*o*Math.sqrt(o)*h,e-=o,Math.abs(o)<t.EPSLN)return e}return e},nad_intr:function(t,s){var i,a={x:(t.x-1e-7)/s.del[0],y:(t.y-1e-7)/s.del[1]},h={x:Math.floor(a.x),y:Math.floor(a.y)},e={x:a.x-1*h.x,y:a.y-1*h.y},n={x:Number.NaN,y:Number.NaN};if(h.x<0){if(!(-1===h.x&&e.x>.99999999999))return n;h.x++,e.x=0}else if(i=h.x+1,i>=s.lim[0]){if(!(i===s.lim[0]&&e.x<1e-11))return n;h.x--,e.x=1}if(h.y<0){if(!(-1===h.y&&e.y>.99999999999))return n;h.y++,e.y=0}else if(i=h.y+1,i>=s.lim[1]){if(!(i===s.lim[1]&&e.y<1e-11))return n;h.y++,e.y=1}i=h.y*s.lim[0]+h.x;var r={x:s.cvs[i][0],y:s.cvs[i][1]};i++;var o={x:s.cvs[i][0],y:s.cvs[i][1]};i+=s.lim[0];var l={x:s.cvs[i][0],y:s.cvs[i][1]};i--;var u={x:s.cvs[i][0],y:s.cvs[i][1]},c=e.x*e.y,M=e.x*(1-e.y),f=(1-e.x)*(1-e.y),m=(1-e.x)*e.y;return n.x=f*r.x+M*o.x+m*u.x+c*l.x,n.y=f*r.y+M*o.y+m*u.y+c*l.y,n},nad_cvt:function(s,i,a){var h={x:Number.NaN,y:Number.NaN};if(isNaN(s.x))return h;var e={x:s.x,y:s.y};e.x-=a.ll[0],e.y-=a.ll[1],e.x=t.adjust_lon(e.x-t.PI)+t.PI;var n=t.nad_intr(e,a);if(i){if(isNaN(n.x))return h;n.x=e.x+n.x,n.y=e.y-n.y;var r,o,l=9,u=1e-12;do{if(o=t.nad_intr(n,a),isNaN(o.x)){this.reportError("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}r={x:n.x-o.x-e.x,y:n.y+o.y-e.y},n.x-=r.x,n.y-=r.y}while(l--&&Math.abs(r.x)>u&&Math.abs(r.y)>u);if(0>l)return this.reportError("Inverse grid shift iterator failed to converge."),h;h.x=t.adjust_lon(n.x+a.ll[0]),h.y=n.y+a.ll[1]}else isNaN(n.x)||(h.x=s.x-n.x,h.y=s.y+n.y);return h},C00:1,C02:.25,C04:.046875,C06:.01953125,C08:.01068115234375,C22:.75,C44:.46875,C46:.013020833333333334,C48:.007120768229166667,C66:.3645833333333333,C68:.005696614583333333,C88:.3076171875};return t}),i("proj4/constants",[],function(){var t={};return t.PrimeMeridian={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},t.Ellipsoid={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},"APL4.":{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS72:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}},t.Datum={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"}},t.Datum.OSB36=t.Datum.OSGB36,t.wktProjections={"Lambert Tangential Conformal Conic Projection":"lcc",Lambert_Conformal_Conic:"lcc",Lambert_Conformal_Conic_2SP:"lcc",Mercator:"merc","Popular Visualisation Pseudo Mercator":"merc",Mercator_1SP:"merc",Transverse_Mercator:"tmerc","Transverse Mercator":"tmerc","Lambert Azimuthal Equal Area":"laea","Universal Transverse Mercator System":"utm",Hotine_Oblique_Mercator:"omerc","Hotine Oblique Mercator":"omerc",Hotine_Oblique_Mercator_Azimuth_Natural_Origin:"omerc",Hotine_Oblique_Mercator_Azimuth_Center:"omerc",Van_der_Grinten_I:"vandg",VanDerGrinten:"vandg",Stereographic_North_Pole:"sterea",Oblique_Stereographic:"sterea",Polar_Stereographic:"sterea",Polyconic:"poly",New_Zealand_Map_Grid:"nzmg",Miller_Cylindrical:"mill",Krovak:"krovak",Equirectangular:"eqc",Equidistant_Cylindrical:"eqc",Cassini:"cass",Cassini_Soldner:"cass",Azimuthal_Equidistant:"aeqd",Albers_Conic_Equal_Area:"aea",Albers:"aea",Mollweide:"moll",Lambert_Azimuthal_Equal_Area:"laea",Sinusoidal:"sinu",Equidistant_Conic:"eqdc",Mercator_Auxiliary_Sphere:"merc"},t.grids={"null":{ll:[-3.14159265,-1.57079633],del:[3.14159265,1.57079633],lim:[3,3],count:9,cvs:[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]]}},t}),i("proj4/global",[],function(){return function(t){t("WGS84","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}}),i("proj4/projString",["./common","./constants"],function(t,s){return function(i){var a={},h={};i.split("+").map(function(t){return t.trim()}).filter(function(t){return t}).forEach(function(t){var s=t.split("=");"@null"!==s[1]&&(s.push(!0),h[s[0].toLowerCase()]=s[1])});var e,n,r,o={proj:"projName",datum:"datumCode",rf:function(t){a.rf=parseFloat(t,10)},lat_0:function(s){a.lat0=s*t.D2R},lat_1:function(s){a.lat1=s*t.D2R},lat_2:function(s){a.lat2=s*t.D2R},lat_ts:function(s){a.lat_ts=s*t.D2R},lon_0:function(s){a.long0=s*t.D2R},lon_1:function(s){a.long1=s*t.D2R},lon_2:function(s){a.long2=s*t.D2R},alpha:function(s){a.alpha=parseFloat(s)*t.D2R},lonc:function(s){a.longc=s*t.D2R},x_0:function(t){a.x0=parseFloat(t,10)},y_0:function(t){a.y0=parseFloat(t,10)},k_0:function(t){a.k0=parseFloat(t,10)},k:function(t){a.k0=parseFloat(t,10)},r_a:function(){a.R_A=!0},zone:function(t){a.zone=parseInt(t,10)},south:function(){a.utmSouth=!0},towgs84:function(t){a.datum_params=t.split(",").map(function(t){return parseFloat(t,10)})},to_meter:function(t){a.to_meter=parseFloat(t,10)},from_greenwich:function(s){a.from_greenwich=s*t.D2R},pm:function(i){a.from_greenwich=(s.PrimeMeridian[i]?s.PrimeMeridian[i]:parseFloat(i,10))*t.D2R},axis:function(t){var s="ewnsud";3===t.length&&-1!==s.indexOf(t.substr(0,1))&&-1!==s.indexOf(t.substr(1,1))&&-1!==s.indexOf(t.substr(2,1))&&(a.axis=t)}};for(e in h)n=h[e],e in o?(r=o[e],"function"==typeof r?r(n):a[r]=n):a[e]=n;return a}}),i("proj4/wkt",["./extend","./constants","./common"],function(t,s,i){function a(s,i,a){s[i]=a.map(function(t){var s={};return h(t,s),s}).reduce(function(s,i){return t(s,i)},{})}function h(t,s){var i;return Array.isArray(t)?(i=t.shift(),"PARAMETER"===i&&(i=t.shift()),1===t.length?Array.isArray(t[0])?(s[i]={},h(t[0],s[i])):s[i]=t[0]:t.length?"TOWGS84"===i?s[i]=t:(s[i]={},["UNIT","PRIMEM","VERT_DATUM"].indexOf(i)>-1?(s[i]={name:t[0].toLowerCase(),convert:t[1]},3===t.length&&(s[i].auth=t[2])):"SPHEROID"===i?(s[i]={name:t[0],a:t[1],rf:t[2]},4===t.length&&(s[i].auth=t[3])):["GEOGCS","GEOCCS","DATUM","VERT_CS","COMPD_CS","LOCAL_CS","FITTED_CS","LOCAL_DATUM"].indexOf(i)>-1?(t[0]=["name",t[0]],a(s,i,t)):t.every(function(t){return Array.isArray(t)})?a(s,i,t):h(t,s[i])):s[i]=!0,void 0):(s[t]=!0,void 0)}function e(t,s){var i=s[0],a=s[1];!(i in t)&&a in t&&(t[i]=t[a],3===s.length&&(t[i]=s[2](t[i])))}function n(t){return t*i.D2R}function r(t){function i(s){var i=t.to_meter||1;return parseFloat(s,10)*i}"GEOGCS"===t.type?t.projName="longlat":"LOCAL_CS"===t.type?(t.projName="identity",t.local=!0):t.projName=s.wktProjections[t.PROJECTION],t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),"metre"===t.units&&(t.units="meter"),t.UNIT.convert&&(t.to_meter=parseFloat(t.UNIT.convert,10))),t.GEOGCS&&(t.datumCode=t.GEOGCS.DATUM?t.GEOGCS.DATUM.name.toLowerCase():t.GEOGCS.name.toLowerCase(),"d_"===t.datumCode.slice(0,2)&&(t.datumCode=t.datumCode.slice(2)),("new_zealand_geodetic_datum_1949"===t.datumCode||"new_zealand_1949"===t.datumCode)&&(t.datumCode="nzgd49"),"wgs_1984"===t.datumCode&&("Mercator_Auxiliary_Sphere"===t.PROJECTION&&(t.sphere=!0),t.datumCode="wgs84"),"_ferro"===t.datumCode.slice(-6)&&(t.datumCode=t.datumCode.slice(0,-6)),"_jakarta"===t.datumCode.slice(-8)&&(t.datumCode=t.datumCode.slice(0,-8)),t.GEOGCS.DATUM&&t.GEOGCS.DATUM.SPHEROID&&(t.ellps=t.GEOGCS.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===t.ellps.toLowerCase().slice(0,13)&&(t.ellps="intl"),t.a=t.GEOGCS.DATUM.SPHEROID.a,t.rf=parseFloat(t.GEOGCS.DATUM.SPHEROID.rf,10))),t.b&&!isFinite(t.b)&&(t.b=t.a);var a=function(s){return e(t,s)},h=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",n],["longitude_of_center","Longitude_Of_Center"],["longc","longitude_of_center",n],["x0","false_easting",i],["y0","false_northing",i],["long0","central_meridian",n],["lat0","latitude_of_origin",n],["lat0","standard_parallel_1",n],["lat1","standard_parallel_1",n],["lat2","standard_parallel_2",n],["alpha","azimuth",n],["srsCode","name"]];h.forEach(a),t.long0||!t.longc||"Albers_Conic_Equal_Area"!==t.PROJECTION&&"Lambert_Azimuthal_Equal_Area"!==t.PROJECTION||(t.long0=t.longc)}return function(s,i){var a=JSON.parse((","+s).replace(/\,([A-Z_0-9]+?)(\[)/g,',["$1",').slice(1).replace(/\,([A-Z_0-9]+?)\]/g,',"$1"]')),e=a.shift(),n=a.shift();a.unshift(["name",n]),a.unshift(["type",e]),a.unshift("output");var o={};return h(a,o),r(o.output),t(i,o.output)}}),i("proj4/defs",["./common","./constants","./global","./projString","./wkt"],function(t,s,i,a,h){function e(t){var s=this;if(2===arguments.length)e[t]="+"===arguments[1][0]?a(arguments[1]):h(arguments[1]);else if(1===arguments.length)return Array.isArray(t)?t.map(function(t){Array.isArray(t)?e.apply(s,t):e(t)}):("string"==typeof t||("EPSG"in t?e["EPSG:"+t.EPSG]=t:"ESRI"in t?e["ESRI:"+t.ESRI]=t:"IAU2000"in t?e["IAU2000:"+t.IAU2000]=t:console.log(t)),void 0)}return i(e),e}),i("proj4/datum",["./common"],function(t){var s=function(i){if(!(this instanceof s))return new s(i);if(this.datum_type=t.PJD_WGS84,i){if(i.datumCode&&"none"===i.datumCode&&(this.datum_type=t.PJD_NODATUM),i.datum_params){for(var a=0;a<i.datum_params.length;a++)i.datum_params[a]=parseFloat(i.datum_params[a]);(0!==i.datum_params[0]||0!==i.datum_params[1]||0!==i.datum_params[2])&&(this.datum_type=t.PJD_3PARAM),i.datum_params.length>3&&(0!==i.datum_params[3]||0!==i.datum_params[4]||0!==i.datum_params[5]||0!==i.datum_params[6])&&(this.datum_type=t.PJD_7PARAM,i.datum_params[3]*=t.SEC_TO_RAD,i.datum_params[4]*=t.SEC_TO_RAD,i.datum_params[5]*=t.SEC_TO_RAD,i.datum_params[6]=i.datum_params[6]/1e6+1)}this.datum_type=i.grids?t.PJD_GRIDSHIFT:this.datum_type,this.a=i.a,this.b=i.b,this.es=i.es,this.ep2=i.ep2,this.datum_params=i.datum_params,this.datum_type===t.PJD_GRIDSHIFT&&(this.grids=i.grids)}};return s.prototype={compare_datums:function(s){return this.datum_type!==s.datum_type?!1:this.a!==s.a||Math.abs(this.es-s.es)>5e-11?!1:this.datum_type===t.PJD_3PARAM?this.datum_params[0]===s.datum_params[0]&&this.datum_params[1]===s.datum_params[1]&&this.datum_params[2]===s.datum_params[2]:this.datum_type===t.PJD_7PARAM?this.datum_params[0]===s.datum_params[0]&&this.datum_params[1]===s.datum_params[1]&&this.datum_params[2]===s.datum_params[2]&&this.datum_params[3]===s.datum_params[3]&&this.datum_params[4]===s.datum_params[4]&&this.datum_params[5]===s.datum_params[5]&&this.datum_params[6]===s.datum_params[6]:this.datum_type===t.PJD_GRIDSHIFT||s.datum_type===t.PJD_GRIDSHIFT?this.nadgrids===s.nadgrids:!0},geodetic_to_geocentric:function(s){var i,a,h,e,n,r,o,l=s.x,u=s.y,c=s.z?s.z:0,M=0;if(u<-t.HALF_PI&&u>-1.001*t.HALF_PI)u=-t.HALF_PI;else if(u>t.HALF_PI&&u<1.001*t.HALF_PI)u=t.HALF_PI;else if(u<-t.HALF_PI||u>t.HALF_PI)return null;return l>t.PI&&(l-=2*t.PI),n=Math.sin(u),o=Math.cos(u),r=n*n,e=this.a/Math.sqrt(1-this.es*r),i=(e+c)*o*Math.cos(l),a=(e+c)*o*Math.sin(l),h=(e*(1-this.es)+c)*n,s.x=i,s.y=a,s.z=h,M},geocentric_to_geodetic:function(s){var i,a,h,e,n,r,o,l,u,c,M,f,m,p,_,d,y,g=1e-12,x=g*g,v=30,P=s.x,b=s.y,C=s.z?s.z:0;if(m=!1,i=Math.sqrt(P*P+b*b),a=Math.sqrt(P*P+b*b+C*C),i/this.a<g){if(m=!0,_=0,a/this.a<g)return d=t.HALF_PI,y=-this.b,void 0}else _=Math.atan2(b,P);h=C/a,e=i/a,n=1/Math.sqrt(1-this.es*(2-this.es)*e*e),l=e*(1-this.es)*n,u=h*n,p=0;do p++,o=this.a/Math.sqrt(1-this.es*u*u),y=i*l+C*u-o*(1-this.es*u*u),r=this.es*o/(o+y),n=1/Math.sqrt(1-r*(2-r)*e*e),c=e*(1-r)*n,M=h*n,f=M*l-c*u,l=c,u=M;while(f*f>x&&v>p);return d=Math.atan(M/Math.abs(c)),s.x=_,s.y=d,s.z=y,s},geocentric_to_geodetic_noniter:function(s){var i,a,h,e,n,r,o,l,u,c,M,f,m,p,_,d,y,g=s.x,x=s.y,v=s.z?s.z:0;if(g=parseFloat(g),x=parseFloat(x),v=parseFloat(v),y=!1,0!==g)i=Math.atan2(x,g);else if(x>0)i=t.HALF_PI;else if(0>x)i=-t.HALF_PI;else if(y=!0,i=0,v>0)a=t.HALF_PI;else{if(!(0>v))return a=t.HALF_PI,h=-this.b,void 0;a=-t.HALF_PI}return n=g*g+x*x,e=Math.sqrt(n),r=v*t.AD_C,l=Math.sqrt(r*r+n),c=r/l,f=e/l,M=c*c*c,o=v+this.b*this.ep2*M,d=e-this.a*this.es*f*f*f,u=Math.sqrt(o*o+d*d),m=o/u,p=d/u,_=this.a/Math.sqrt(1-this.es*m*m),h=p>=t.COS_67P5?e/p-_:p<=-t.COS_67P5?e/-p-_:v/m+_*(this.es-1),y===!1&&(a=Math.atan(m/p)),s.x=i,s.y=a,s.z=h,s},geocentric_to_wgs84:function(s){if(this.datum_type===t.PJD_3PARAM)s.x+=this.datum_params[0],s.y+=this.datum_params[1],s.z+=this.datum_params[2];else if(this.datum_type===t.PJD_7PARAM){var i=this.datum_params[0],a=this.datum_params[1],h=this.datum_params[2],e=this.datum_params[3],n=this.datum_params[4],r=this.datum_params[5],o=this.datum_params[6],l=o*(s.x-r*s.y+n*s.z)+i,u=o*(r*s.x+s.y-e*s.z)+a,c=o*(-n*s.x+e*s.y+s.z)+h;s.x=l,s.y=u,s.z=c}},geocentric_from_wgs84:function(s){if(this.datum_type===t.PJD_3PARAM)s.x-=this.datum_params[0],s.y-=this.datum_params[1],s.z-=this.datum_params[2];else if(this.datum_type===t.PJD_7PARAM){var i=this.datum_params[0],a=this.datum_params[1],h=this.datum_params[2],e=this.datum_params[3],n=this.datum_params[4],r=this.datum_params[5],o=this.datum_params[6],l=(s.x-i)/o,u=(s.y-a)/o,c=(s.z-h)/o;s.x=l+r*u-n*c,s.y=-r*l+u+e*c,s.z=n*l-e*u+c}}},s}),i("proj4/projCode/longlat",["require","exports","module"],function(t,s){function i(t){return t}s.init=function(){},s.forward=i,s.inverse=i}),i("proj4/projCode/tmerc",["../common"],function(t){return{init:function(){this.e0=t.e0fn(this.es),this.e1=t.e1fn(this.es),this.e2=t.e2fn(this.es),this.e3=t.e3fn(this.es),this.ml0=this.a*t.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(s){var i,a,h,e=s.x,n=s.y,r=t.adjust_lon(e-this.long0),o=Math.sin(n),l=Math.cos(n);if(this.sphere){var u=l*Math.sin(r);if(Math.abs(Math.abs(u)-1)<1e-10)return 93;a=.5*this.a*this.k0*Math.log((1+u)/(1-u)),i=Math.acos(l*Math.cos(r)/Math.sqrt(1-u*u)),0>n&&(i=-i),h=this.a*this.k0*(i-this.lat0)}else{var c=l*r,M=Math.pow(c,2),f=this.ep2*Math.pow(l,2),m=Math.tan(n),p=Math.pow(m,2);i=1-this.es*Math.pow(o,2);var _=this.a/Math.sqrt(i),d=this.a*t.mlfn(this.e0,this.e1,this.e2,this.e3,n);a=this.k0*_*c*(1+M/6*(1-p+f+M/20*(5-18*p+Math.pow(p,2)+72*f-58*this.ep2)))+this.x0,h=this.k0*(d-this.ml0+_*m*M*(.5+M/24*(5-p+9*f+4*Math.pow(f,2)+M/30*(61-58*p+Math.pow(p,2)+600*f-330*this.ep2))))+this.y0}return s.x=a,s.y=h,s},inverse:function(s){var i,a,h,e,n,r,o=6;if(this.sphere){var l=Math.exp(s.x/(this.a*this.k0)),u=.5*(l-1/l),c=this.lat0+s.y/(this.a*this.k0),M=Math.cos(c);i=Math.sqrt((1-M*M)/(1+u*u)),n=t.asinz(i),0>c&&(n=-n),r=0===u&&0===M?this.long0:t.adjust_lon(Math.atan2(u,M)+this.long0)}else{var f=s.x-this.x0,m=s.y-this.y0;for(i=(this.ml0+m/this.k0)/this.a,a=i,e=0;!0&&(h=(i+this.e1*Math.sin(2*a)-this.e2*Math.sin(4*a)+this.e3*Math.sin(6*a))/this.e0-a,a+=h,!(Math.abs(h)<=t.EPSLN));e++)if(e>=o)return 95;if(Math.abs(a)<t.HALF_PI){var p=Math.sin(a),_=Math.cos(a),d=Math.tan(a),y=this.ep2*Math.pow(_,2),g=Math.pow(y,2),x=Math.pow(d,2),v=Math.pow(x,2);i=1-this.es*Math.pow(p,2);var P=this.a/Math.sqrt(i),b=P*(1-this.es)/i,C=f/(P*this.k0),S=Math.pow(C,2);n=a-P*d*S/b*(.5-S/24*(5+3*x+10*y-4*g-9*this.ep2-S/30*(61+90*x+298*y+45*v-252*this.ep2-3*g))),r=t.adjust_lon(this.long0+C*(1-S/6*(1+2*x+y-S/20*(5-2*y+28*x-3*g+8*this.ep2+24*v)))/_)}else n=t.HALF_PI*t.sign(m),r=this.long0}return s.x=r,s.y=n,s}}}),i("proj4/projCode/utm",["../common","./tmerc"],function(t,s){return{dependsOn:"tmerc",init:function(){this.zone&&(this.lat0=0,this.long0=(6*Math.abs(this.zone)-183)*t.D2R,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,s.init.apply(this),this.forward=s.forward,this.inverse=s.inverse)}}}),i("proj4/projCode/gauss",["../common"],function(t){return{init:function(){var s=Math.sin(this.lat0),i=Math.cos(this.lat0);i*=i,this.rc=Math.sqrt(1-this.es)/(1-this.es*s*s),this.C=Math.sqrt(1+this.es*i*i/(1-this.es)),this.phic0=Math.asin(s/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+t.FORTPI)/(Math.pow(Math.tan(.5*this.lat0+t.FORTPI),this.C)*t.srat(this.e*s,this.ratexp))},forward:function(s){var i=s.x,a=s.y;return s.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*a+t.FORTPI),this.C)*t.srat(this.e*Math.sin(a),this.ratexp))-t.HALF_PI,s.x=this.C*i,s},inverse:function(s){for(var i=1e-14,a=s.x/this.C,h=s.y,e=Math.pow(Math.tan(.5*h+t.FORTPI)/this.K,1/this.C),n=t.MAX_ITER;n>0&&(h=2*Math.atan(e*t.srat(this.e*Math.sin(s.y),-.5*this.e))-t.HALF_PI,!(Math.abs(h-s.y)<i));--n)s.y=h;return n?(s.x=a,s.y=h,s):null}}}),i("proj4/projCode/sterea",["../common","./gauss"],function(t,s){return{init:function(){s.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(i){var a,h,e,n;return i.x=t.adjust_lon(i.x-this.long0),s.forward.apply(this,[i]),a=Math.sin(i.y),h=Math.cos(i.y),e=Math.cos(i.x),n=this.k0*this.R2/(1+this.sinc0*a+this.cosc0*h*e),i.x=n*h*Math.sin(i.x),i.y=n*(this.cosc0*a-this.sinc0*h*e),i.x=this.a*i.x+this.x0,i.y=this.a*i.y+this.y0,i},inverse:function(i){var a,h,e,n,r;if(i.x=(i.x-this.x0)/this.a,i.y=(i.y-this.y0)/this.a,i.x/=this.k0,i.y/=this.k0,r=Math.sqrt(i.x*i.x+i.y*i.y)){var o=2*Math.atan2(r,this.R2);a=Math.sin(o),h=Math.cos(o),n=Math.asin(h*this.sinc0+i.y*a*this.cosc0/r),e=Math.atan2(i.x*a,r*this.cosc0*h-i.y*this.sinc0*a)}else n=this.phic0,e=0;return i.x=e,i.y=n,s.inverse.apply(this,[i]),i.x=t.adjust_lon(i.x+this.long0),i}}}),i("proj4/projCode/somerc",[],function(){return{init:function(){var t=this.lat0;this.lambda0=this.long0;var s=Math.sin(t),i=this.a,a=this.rf,h=1/a,e=2*h-Math.pow(h,2),n=this.e=Math.sqrt(e);this.R=this.k0*i*Math.sqrt(1-e)/(1-e*Math.pow(s,2)),this.alpha=Math.sqrt(1+e/(1-e)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(s/this.alpha);var r=Math.log(Math.tan(Math.PI/4+this.b0/2)),o=Math.log(Math.tan(Math.PI/4+t/2)),l=Math.log((1+n*s)/(1-n*s));this.K=r-this.alpha*o+this.alpha*n/2*l},forward:function(t){var s=Math.log(Math.tan(Math.PI/4-t.y/2)),i=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),a=-this.alpha*(s+i)+this.K,h=2*(Math.atan(Math.exp(a))-Math.PI/4),e=this.alpha*(t.x-this.lambda0),n=Math.atan(Math.sin(e)/(Math.sin(this.b0)*Math.tan(h)+Math.cos(this.b0)*Math.cos(e))),r=Math.asin(Math.cos(this.b0)*Math.sin(h)-Math.sin(this.b0)*Math.cos(h)*Math.cos(e));return t.y=this.R/2*Math.log((1+Math.sin(r))/(1-Math.sin(r)))+this.y0,t.x=this.R*n+this.x0,t},inverse:function(t){for(var s=t.x-this.x0,i=t.y-this.y0,a=s/this.R,h=2*(Math.atan(Math.exp(i/this.R))-Math.PI/4),e=Math.asin(Math.cos(this.b0)*Math.sin(h)+Math.sin(this.b0)*Math.cos(h)*Math.cos(a)),n=Math.atan(Math.sin(a)/(Math.cos(this.b0)*Math.cos(a)-Math.sin(this.b0)*Math.tan(h))),r=this.lambda0+n/this.alpha,o=0,l=e,u=-1e3,c=0;Math.abs(l-u)>1e-7;){if(++c>20)return;o=1/this.alpha*(Math.log(Math.tan(Math.PI/4+e/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(l))/2)),u=l,l=2*Math.atan(Math.exp(o))-Math.PI/2}return t.x=r,t.y=l,t}}}),i("proj4/projCode/omerc",["../common"],function(t){return{init:function(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var s=Math.sin(this.lat0),i=Math.cos(this.lat0),a=this.e*s;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(i,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-a*a);var h=t.tsfnz(this.e,this.lat0,s),e=this.bl/i*Math.sqrt((1-this.es)/(1-a*a));1>e*e&&(e=1);var n,r;if(isNaN(this.longc)){var o=t.tsfnz(this.e,this.lat1,Math.sin(this.lat1)),l=t.tsfnz(this.e,this.lat2,Math.sin(this.lat2));this.el=this.lat0>=0?(e+Math.sqrt(e*e-1))*Math.pow(h,this.bl):(e-Math.sqrt(e*e-1))*Math.pow(h,this.bl);var u=Math.pow(o,this.bl),c=Math.pow(l,this.bl);n=this.el/u,r=.5*(n-1/n);var M=(this.el*this.el-c*u)/(this.el*this.el+c*u),f=(c-u)/(c+u),m=t.adjust_lon(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(M*Math.tan(.5*this.bl*m)/f)/this.bl,this.long0=t.adjust_lon(this.long0);var p=t.adjust_lon(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*p)/r),this.alpha=Math.asin(e*Math.sin(this.gamma0))}else n=this.lat0>=0?e+Math.sqrt(e*e-1):e-Math.sqrt(e*e-1),this.el=n*Math.pow(h,this.bl),r=.5*(n-1/n),this.gamma0=Math.asin(Math.sin(this.alpha)/e),this.long0=this.longc-Math.asin(r*Math.tan(this.gamma0))/this.bl;this.uc=this.no_off?0:this.lat0>=0?this.al/this.bl*Math.atan2(Math.sqrt(e*e-1),Math.cos(this.alpha)):-1*this.al/this.bl*Math.atan2(Math.sqrt(e*e-1),Math.cos(this.alpha))},forward:function(s){var i,a,h,e=s.x,n=s.y,r=t.adjust_lon(e-this.long0);if(Math.abs(Math.abs(n)-t.HALF_PI)<=t.EPSLN)h=n>0?-1:1,a=this.al/this.bl*Math.log(Math.tan(t.FORTPI+.5*h*this.gamma0)),i=-1*h*t.HALF_PI*this.al/this.bl;else{var o=t.tsfnz(this.e,n,Math.sin(n)),l=this.el/Math.pow(o,this.bl),u=.5*(l-1/l),c=.5*(l+1/l),M=Math.sin(this.bl*r),f=(u*Math.sin(this.gamma0)-M*Math.cos(this.gamma0))/c;a=Math.abs(Math.abs(f)-1)<=t.EPSLN?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-f)/(1+f))/this.bl,i=Math.abs(Math.cos(this.bl*r))<=t.EPSLN?this.al*this.bl*r:this.al*Math.atan2(u*Math.cos(this.gamma0)+M*Math.sin(this.gamma0),Math.cos(this.bl*r))/this.bl}return this.no_rot?(s.x=this.x0+i,s.y=this.y0+a):(i-=this.uc,s.x=this.x0+a*Math.cos(this.alpha)+i*Math.sin(this.alpha),s.y=this.y0+i*Math.cos(this.alpha)-a*Math.sin(this.alpha)),s},inverse:function(s){var i,a;this.no_rot?(a=s.y-this.y0,i=s.x-this.x0):(a=(s.x-this.x0)*Math.cos(this.alpha)-(s.y-this.y0)*Math.sin(this.alpha),i=(s.y-this.y0)*Math.cos(this.alpha)+(s.x-this.x0)*Math.sin(this.alpha),i+=this.uc);var h=Math.exp(-1*this.bl*a/this.al),e=.5*(h-1/h),n=.5*(h+1/h),r=Math.sin(this.bl*i/this.al),o=(r*Math.cos(this.gamma0)+e*Math.sin(this.gamma0))/n,l=Math.pow(this.el/Math.sqrt((1+o)/(1-o)),1/this.bl);return Math.abs(o-1)<t.EPSLN?(s.x=this.long0,s.y=t.HALF_PI):Math.abs(o+1)<t.EPSLN?(s.x=this.long0,s.y=-1*t.HALF_PI):(s.y=t.phi2z(this.e,l),s.x=t.adjust_lon(this.long0-Math.atan2(e*Math.cos(this.gamma0)-r*Math.sin(this.gamma0),Math.cos(this.bl*i/this.al))/this.bl)),s}}}),i("proj4/projCode/lcc",["../common"],function(t){return{init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),!(Math.abs(this.lat1+this.lat2)<t.EPSLN)){var s=this.b/this.a;this.e=Math.sqrt(1-s*s);var i=Math.sin(this.lat1),a=Math.cos(this.lat1),h=t.msfnz(this.e,i,a),e=t.tsfnz(this.e,this.lat1,i),n=Math.sin(this.lat2),r=Math.cos(this.lat2),o=t.msfnz(this.e,n,r),l=t.tsfnz(this.e,this.lat2,n),u=t.tsfnz(this.e,this.lat0,Math.sin(this.lat0));this.ns=Math.abs(this.lat1-this.lat2)>t.EPSLN?Math.log(h/o)/Math.log(e/l):i,isNaN(this.ns)&&(this.ns=i),this.f0=h/(this.ns*Math.pow(e,this.ns)),this.rh=this.a*this.f0*Math.pow(u,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(s){var i=s.x,a=s.y;Math.abs(2*Math.abs(a)-t.PI)<=t.EPSLN&&(a=t.sign(a)*(t.HALF_PI-2*t.EPSLN));var h,e,n=Math.abs(Math.abs(a)-t.HALF_PI);if(n>t.EPSLN)h=t.tsfnz(this.e,a,Math.sin(a)),e=this.a*this.f0*Math.pow(h,this.ns);else{if(n=a*this.ns,0>=n)return null;e=0}var r=this.ns*t.adjust_lon(i-this.long0);return s.x=this.k0*e*Math.sin(r)+this.x0,s.y=this.k0*(this.rh-e*Math.cos(r))+this.y0,s},inverse:function(s){var i,a,h,e,n,r=(s.x-this.x0)/this.k0,o=this.rh-(s.y-this.y0)/this.k0;this.ns>0?(i=Math.sqrt(r*r+o*o),a=1):(i=-Math.sqrt(r*r+o*o),a=-1);var l=0;if(0!==i&&(l=Math.atan2(a*r,a*o)),0!==i||this.ns>0){if(a=1/this.ns,h=Math.pow(i/(this.a*this.f0),a),e=t.phi2z(this.e,h),-9999===e)return null}else e=-t.HALF_PI;return n=t.adjust_lon(l/this.ns+this.long0),s.x=n,s.y=e,s}}}),i("proj4/projCode/krovak",["../common"],function(t){return{init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(s){var i,a,h,e,n,r,o,l=s.x,u=s.y,c=t.adjust_lon(l-this.long0);return i=Math.pow((1+this.e*Math.sin(u))/(1-this.e*Math.sin(u)),this.alfa*this.e/2),a=2*(Math.atan(this.k*Math.pow(Math.tan(u/2+this.s45),this.alfa)/i)-this.s45),h=-c*this.alfa,e=Math.asin(Math.cos(this.ad)*Math.sin(a)+Math.sin(this.ad)*Math.cos(a)*Math.cos(h)),n=Math.asin(Math.cos(a)*Math.sin(h)/Math.cos(e)),r=this.n*n,o=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(e/2+this.s45),this.n),s.y=o*Math.cos(r)/1,s.x=o*Math.sin(r)/1,this.czech||(s.y*=-1,s.x*=-1),s},inverse:function(t){var s,i,a,h,e,n,r,o,l=t.x;t.x=t.y,t.y=l,this.czech||(t.y*=-1,t.x*=-1),n=Math.sqrt(t.x*t.x+t.y*t.y),e=Math.atan2(t.y,t.x),h=e/Math.sin(this.s0),a=2*(Math.atan(Math.pow(this.ro0/n,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),s=Math.asin(Math.cos(this.ad)*Math.sin(a)-Math.sin(this.ad)*Math.cos(a)*Math.cos(h)),i=Math.asin(Math.cos(a)*Math.sin(h)/Math.cos(s)),t.x=this.long0-i/this.alfa,r=s,o=0;var u=0;do t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(s/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(r))/(1-this.e*Math.sin(r)),this.e/2))-this.s45),Math.abs(r-t.y)<1e-10&&(o=1),r=t.y,u+=1;while(0===o&&15>u);return u>=15?null:t}}}),i("proj4/projCode/cass",["../common"],function(t){return{init:function(){this.sphere||(this.e0=t.e0fn(this.es),this.e1=t.e1fn(this.es),this.e2=t.e2fn(this.es),this.e3=t.e3fn(this.es),this.ml0=this.a*t.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(s){var i,a,h=s.x,e=s.y;if(h=t.adjust_lon(h-this.long0),this.sphere)i=this.a*Math.asin(Math.cos(e)*Math.sin(h)),a=this.a*(Math.atan2(Math.tan(e),Math.cos(h))-this.lat0);else{var n=Math.sin(e),r=Math.cos(e),o=t.gN(this.a,this.e,n),l=Math.tan(e)*Math.tan(e),u=h*Math.cos(e),c=u*u,M=this.es*r*r/(1-this.es),f=this.a*t.mlfn(this.e0,this.e1,this.e2,this.e3,e);i=o*u*(1-c*l*(1/6-(8-l+8*M)*c/120)),a=f-this.ml0+o*n/r*c*(.5+(5-l+6*M)*c/24)}return s.x=i+this.x0,s.y=a+this.y0,s},inverse:function(s){s.x-=this.x0,s.y-=this.y0;var i,a,h=s.x/this.a,e=s.y/this.a;if(this.sphere){var n=e+this.lat0;i=Math.asin(Math.sin(n)*Math.cos(h)),a=Math.atan2(Math.tan(h),Math.cos(n))}else{var r=this.ml0/this.a+e,o=t.imlfn(r,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-t.HALF_PI)<=t.EPSLN)return s.x=this.long0,s.y=t.HALF_PI,0>e&&(s.y*=-1),s;var l=t.gN(this.a,this.e,Math.sin(o)),u=l*l*l/this.a/this.a*(1-this.es),c=Math.pow(Math.tan(o),2),M=h*this.a/l,f=M*M;i=o-l*Math.tan(o)/u*M*M*(.5-(1+3*c)*M*M/24),a=M*(1-f*(c/3+(1+3*c)*c*f/15))/Math.cos(o)}return s.x=t.adjust_lon(a+this.long0),s.y=t.adjust_lat(i),s}}}),i("proj4/projCode/laea",["../common"],function(t){return{S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4,init:function(){var s=Math.abs(this.lat0);if(this.mode=Math.abs(s-t.HALF_PI)<t.EPSLN?this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(s)<t.EPSLN?this.EQUIT:this.OBLIQ,this.es>0){var i;switch(this.qp=t.qsfnz(this.e,1),this.mmf=.5/(1-this.es),this.apa=this.authset(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),i=Math.sin(this.lat0),this.sinb1=t.qsfnz(this.e,i)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*i*i)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(s){var i,a,h,e,n,r,o,l,u,c,M=s.x,f=s.y;if(M=t.adjust_lon(M-this.long0),this.sphere){if(n=Math.sin(f),c=Math.cos(f),h=Math.cos(M),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(a=this.mode===this.EQUIT?1+c*h:1+this.sinph0*n+this.cosph0*c*h,a<=t.EPSLN)return null;a=Math.sqrt(2/a),i=a*c*Math.sin(M),a*=this.mode===this.EQUIT?n:this.cosph0*n-this.sinph0*c*h}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(h=-h),Math.abs(f+this.phi0)<t.EPSLN)return null;a=t.FORTPI-.5*f,a=2*(this.mode===this.S_POLE?Math.cos(a):Math.sin(a)),i=a*Math.sin(M),a*=h}}else{switch(o=0,l=0,u=0,h=Math.cos(M),e=Math.sin(M),n=Math.sin(f),r=t.qsfnz(this.e,n),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(o=r/this.qp,l=Math.sqrt(1-o*o)),this.mode){case this.OBLIQ:u=1+this.sinb1*o+this.cosb1*l*h;break;case this.EQUIT:u=1+l*h;break;case this.N_POLE:u=t.HALF_PI+f,r=this.qp-r;break;case this.S_POLE:u=f-t.HALF_PI,r=this.qp+r}if(Math.abs(u)<t.EPSLN)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:u=Math.sqrt(2/u),a=this.mode===this.OBLIQ?this.ymf*u*(this.cosb1*o-this.sinb1*l*h):(u=Math.sqrt(2/(1+l*h)))*o*this.ymf,i=this.xmf*u*l*e;break;case this.N_POLE:case this.S_POLE:r>=0?(i=(u=Math.sqrt(r))*e,a=h*(this.mode===this.S_POLE?u:-u)):i=a=0}}return s.x=this.a*i+this.x0,s.y=this.a*a+this.y0,s},inverse:function(s){s.x-=this.x0,s.y-=this.y0;var i,a,h,e,n,r,o,l=s.x/this.a,u=s.y/this.a;if(this.sphere){var c,M=0,f=0;if(c=Math.sqrt(l*l+u*u),a=.5*c,a>1)return null;switch(a=2*Math.asin(a),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(f=Math.sin(a),M=Math.cos(a)),this.mode){case this.EQUIT:a=Math.abs(c)<=t.EPSLN?0:Math.asin(u*f/c),l*=f,u=M*c;break;case this.OBLIQ:a=Math.abs(c)<=t.EPSLN?this.phi0:Math.asin(M*this.sinph0+u*f*this.cosph0/c),l*=f*this.cosph0,u=(M-Math.sin(a)*this.sinph0)*c;break;case this.N_POLE:u=-u,a=t.HALF_PI-a;break;case this.S_POLE:a-=t.HALF_PI}i=0!==u||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(l,u):0}else{if(o=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(l/=this.dd,u*=this.dd,r=Math.sqrt(l*l+u*u),r<t.EPSLN)return s.x=0,s.y=this.phi0,s;e=2*Math.asin(.5*r/this.rq),h=Math.cos(e),l*=e=Math.sin(e),this.mode===this.OBLIQ?(o=h*this.sinb1+u*e*this.cosb1/r,n=this.qp*o,u=r*this.cosb1*h-u*this.sinb1*e):(o=u*e/r,n=this.qp*o,u=r*h)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(u=-u),n=l*l+u*u,!n)return s.x=0,s.y=this.phi0,s;o=1-n/this.qp,this.mode===this.S_POLE&&(o=-o)}i=Math.atan2(l,u),a=this.authlat(Math.asin(o),this.apa)}return s.x=t.adjust_lon(this.long0+i),s.y=a,s},P00:.3333333333333333,P01:.17222222222222222,P02:.10257936507936508,P10:.06388888888888888,P11:.0664021164021164,P20:.016415012942191543,authset:function(t){var s,i=[];return i[0]=t*this.P00,s=t*t,i[0]+=s*this.P01,i[1]=s*this.P10,s*=t,i[0]+=s*this.P02,i[1]+=s*this.P11,i[2]=s*this.P20,i},authlat:function(t,s){var i=t+t;return t+s[0]*Math.sin(i)+s[1]*Math.sin(i+i)+s[2]*Math.sin(i+i+i)}}}),i("proj4/projCode/merc",["../common"],function(t){return{init:function(){var s=this.b/this.a;this.es=1-s*s,this.e=Math.sqrt(this.es),this.lat_ts?this.k0=this.sphere?Math.cos(this.lat_ts):t.msfnz(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k0=this.k?this.k:1)},forward:function(s){var i=s.x,a=s.y;if(a*t.R2D>90&&a*t.R2D<-90&&i*t.R2D>180&&i*t.R2D<-180)return null;var h,e;if(Math.abs(Math.abs(a)-t.HALF_PI)<=t.EPSLN)return null;if(this.sphere)h=this.x0+this.a*this.k0*t.adjust_lon(i-this.long0),e=this.y0+this.a*this.k0*Math.log(Math.tan(t.FORTPI+.5*a));else{var n=Math.sin(a),r=t.tsfnz(this.e,a,n);h=this.x0+this.a*this.k0*t.adjust_lon(i-this.long0),e=this.y0-this.a*this.k0*Math.log(r)}return s.x=h,s.y=e,s},inverse:function(s){var i,a,h=s.x-this.x0,e=s.y-this.y0;if(this.sphere)a=t.HALF_PI-2*Math.atan(Math.exp(-e/(this.a*this.k0)));else{var n=Math.exp(-e/(this.a*this.k0));if(a=t.phi2z(this.e,n),-9999===a)return null}return i=t.adjust_lon(this.long0+h/(this.a*this.k0)),s.x=i,s.y=a,s}}}),i("proj4/projCode/aea",["../common"],function(t){return{init:function(){Math.abs(this.lat1+this.lat2)<t.EPSLN||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=t.msfnz(this.e3,this.sin_po,this.cos_po),this.qs1=t.qsfnz(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=t.msfnz(this.e3,this.sin_po,this.cos_po),this.qs2=t.qsfnz(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=t.qsfnz(this.e3,this.sin_po,this.cos_po),this.ns0=Math.abs(this.lat1-this.lat2)>t.EPSLN?(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(s){var i=s.x,a=s.y;this.sin_phi=Math.sin(a),this.cos_phi=Math.cos(a);var h=t.qsfnz(this.e3,this.sin_phi,this.cos_phi),e=this.a*Math.sqrt(this.c-this.ns0*h)/this.ns0,n=this.ns0*t.adjust_lon(i-this.long0),r=e*Math.sin(n)+this.x0,o=this.rh-e*Math.cos(n)+this.y0;return s.x=r,s.y=o,s},inverse:function(s){var i,a,h,e,n,r;return s.x-=this.x0,s.y=this.rh-s.y+this.y0,this.ns0>=0?(i=Math.sqrt(s.x*s.x+s.y*s.y),h=1):(i=-Math.sqrt(s.x*s.x+s.y*s.y),h=-1),e=0,0!==i&&(e=Math.atan2(h*s.x,h*s.y)),h=i*this.ns0/this.a,this.sphere?r=Math.asin((this.c-h*h)/(2*this.ns0)):(a=(this.c-h*h)/this.ns0,r=this.phi1z(this.e3,a)),n=t.adjust_lon(e/this.ns0+this.long0),s.x=n,s.y=r,s},phi1z:function(s,i){var a,h,e,n,r,o=t.asinz(.5*i);if(s<t.EPSLN)return o;for(var l=s*s,u=1;25>=u;u++)if(a=Math.sin(o),h=Math.cos(o),e=s*a,n=1-e*e,r=.5*n*n/h*(i/(1-l)-a/n+.5/s*Math.log((1-e)/(1+e))),o+=r,Math.abs(r)<=1e-7)return o;return null}}}),i("proj4/projCode/gnom",["../common"],function(t){return{init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(s){var i,a,h,e,n,r,o,l,u=s.x,c=s.y;return h=t.adjust_lon(u-this.long0),i=Math.sin(c),a=Math.cos(c),e=Math.cos(h),r=this.sin_p14*i+this.cos_p14*a*e,n=1,r>0||Math.abs(r)<=t.EPSLN?(o=this.x0+this.a*n*a*Math.sin(h)/r,l=this.y0+this.a*n*(this.cos_p14*i-this.sin_p14*a*e)/r):(o=this.x0+this.infinity_dist*a*Math.sin(h),l=this.y0+this.infinity_dist*(this.cos_p14*i-this.sin_p14*a*e)),s.x=o,s.y=l,s},inverse:function(s){var i,a,h,e,n,r;return s.x=(s.x-this.x0)/this.a,s.y=(s.y-this.y0)/this.a,s.x/=this.k0,s.y/=this.k0,(i=Math.sqrt(s.x*s.x+s.y*s.y))?(e=Math.atan2(i,this.rc),a=Math.sin(e),h=Math.cos(e),r=t.asinz(h*this.sin_p14+s.y*a*this.cos_p14/i),n=Math.atan2(s.x*a,i*this.cos_p14*h-s.y*this.sin_p14*a),n=t.adjust_lon(this.long0+n)):(r=this.phic0,n=0),s.x=n,s.y=r,s}}}),i("proj4/projCode/cea",["../common"],function(t){return{init:function(){this.sphere||(this.k0=t.msfnz(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(s){var i,a,h=s.x,e=s.y,n=t.adjust_lon(h-this.long0);if(this.sphere)i=this.x0+this.a*n*Math.cos(this.lat_ts),a=this.y0+this.a*Math.sin(e)/Math.cos(this.lat_ts);else{var r=t.qsfnz(this.e,Math.sin(e));i=this.x0+this.a*this.k0*n,a=this.y0+.5*this.a*r/this.k0}return s.x=i,s.y=a,s},inverse:function(s){s.x-=this.x0,s.y-=this.y0;var i,a;return this.sphere?(i=t.adjust_lon(this.long0+s.x/this.a/Math.cos(this.lat_ts)),a=Math.asin(s.y/this.a*Math.cos(this.lat_ts))):(a=t.iqsfnz(this.e,2*s.y*this.k0/this.a),i=t.adjust_lon(this.long0+s.x/(this.a*this.k0))),s.x=i,s.y=a,s}}}),i("proj4/projCode/eqc",["../common"],function(t){return{init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_t||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(s){var i=s.x,a=s.y,h=t.adjust_lon(i-this.long0),e=t.adjust_lat(a-this.lat0);return s.x=this.x0+this.a*h*this.rc,s.y=this.y0+this.a*e,s},inverse:function(s){var i=s.x,a=s.y;return s.x=t.adjust_lon(this.long0+(i-this.x0)/(this.a*this.rc)),s.y=t.adjust_lat(this.lat0+(a-this.y0)/this.a),s}}}),i("proj4/projCode/poly",["../common"],function(t){return{init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=t.e0fn(this.es),this.e1=t.e1fn(this.es),this.e2=t.e2fn(this.es),this.e3=t.e3fn(this.es),this.ml0=this.a*t.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(s){var i,a,h,e=s.x,n=s.y,r=t.adjust_lon(e-this.long0);if(h=r*Math.sin(n),this.sphere)Math.abs(n)<=t.EPSLN?(i=this.a*r,a=-1*this.a*this.lat0):(i=this.a*Math.sin(h)/Math.tan(n),a=this.a*(t.adjust_lat(n-this.lat0)+(1-Math.cos(h))/Math.tan(n)));else if(Math.abs(n)<=t.EPSLN)i=this.a*r,a=-1*this.ml0;else{var o=t.gN(this.a,this.e,Math.sin(n))/Math.tan(n);i=o*Math.sin(h),a=this.a*t.mlfn(this.e0,this.e1,this.e2,this.e3,n)-this.ml0+o*(1-Math.cos(h))}return s.x=i+this.x0,s.y=a+this.y0,s},inverse:function(s){var i,a,h,e,n,r,o,l,u;if(h=s.x-this.x0,e=s.y-this.y0,this.sphere)if(Math.abs(e+this.a*this.lat0)<=t.EPSLN)i=t.adjust_lon(h/this.a+this.long0),a=0;else{r=this.lat0+e/this.a,o=h*h/this.a/this.a+r*r,l=r;var c;for(n=t.MAX_ITER;n;--n)if(c=Math.tan(l),u=-1*(r*(l*c+1)-l-.5*(l*l+o)*c)/((l-r)/c-1),l+=u,Math.abs(u)<=t.EPSLN){a=l;break}i=t.adjust_lon(this.long0+Math.asin(h*Math.tan(l)/this.a)/Math.sin(a))}else if(Math.abs(e+this.ml0)<=t.EPSLN)a=0,i=t.adjust_lon(this.long0+h/this.a);else{r=(this.ml0+e)/this.a,o=h*h/this.a/this.a+r*r,l=r;var M,f,m,p,_;for(n=t.MAX_ITER;n;--n)if(_=this.e*Math.sin(l),M=Math.sqrt(1-_*_)*Math.tan(l),f=this.a*t.mlfn(this.e0,this.e1,this.e2,this.e3,l),m=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),p=f/this.a,u=(r*(M*p+1)-p-.5*M*(p*p+o))/(this.es*Math.sin(2*l)*(p*p+o-2*r*p)/(4*M)+(r-p)*(M*m-2/Math.sin(2*l))-m),l-=u,Math.abs(u)<=t.EPSLN){a=l;break}M=Math.sqrt(1-this.es*Math.pow(Math.sin(a),2))*Math.tan(a),i=t.adjust_lon(this.long0+Math.asin(h*M/this.a)/Math.sin(a))}return s.x=i,s.y=a,s}}}),i("proj4/projCode/nzmg",["../common"],function(t){return{iterations:1,init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(s){var i,a=s.x,h=s.y,e=h-this.lat0,n=a-this.long0,r=1e-5*(e/t.SEC_TO_RAD),o=n,l=1,u=0;for(i=1;10>=i;i++)l*=r,u+=this.A[i]*l;var c,M,f=u,m=o,p=1,_=0,d=0,y=0;for(i=1;6>=i;i++)c=p*f-_*m,M=_*f+p*m,p=c,_=M,d=d+this.B_re[i]*p-this.B_im[i]*_,y=y+this.B_im[i]*p+this.B_re[i]*_;return s.x=y*this.a+this.x0,s.y=d*this.a+this.y0,s},inverse:function(s){var i,a,h,e=s.x,n=s.y,r=e-this.x0,o=n-this.y0,l=o/this.a,u=r/this.a,c=1,M=0,f=0,m=0;for(i=1;6>=i;i++)a=c*l-M*u,h=M*l+c*u,c=a,M=h,f=f+this.C_re[i]*c-this.C_im[i]*M,m=m+this.C_im[i]*c+this.C_re[i]*M;for(var p=0;p<this.iterations;p++){var _,d,y=f,g=m,x=l,v=u;for(i=2;6>=i;i++)_=y*f-g*m,d=g*f+y*m,y=_,g=d,x+=(i-1)*(this.B_re[i]*y-this.B_im[i]*g),v+=(i-1)*(this.B_im[i]*y+this.B_re[i]*g);y=1,g=0;var P=this.B_re[1],b=this.B_im[1];for(i=2;6>=i;i++)_=y*f-g*m,d=g*f+y*m,y=_,g=d,P+=i*(this.B_re[i]*y-this.B_im[i]*g),b+=i*(this.B_im[i]*y+this.B_re[i]*g);var C=P*P+b*b;f=(x*P+v*b)/C,m=(v*P-x*b)/C}var S=f,j=m,N=1,A=0;for(i=1;9>=i;i++)N*=S,A+=this.D[i]*N;var I=this.lat0+1e5*A*t.SEC_TO_RAD,E=this.long0+j;return s.x=E,s.y=I,s}}}),i("proj4/projCode/mill",["../common"],function(t){return{init:function(){},forward:function(s){var i=s.x,a=s.y,h=t.adjust_lon(i-this.long0),e=this.x0+this.a*h,n=this.y0+1.25*this.a*Math.log(Math.tan(t.PI/4+a/2.5));return s.x=e,s.y=n,s},inverse:function(s){s.x-=this.x0,s.y-=this.y0;var i=t.adjust_lon(this.long0+s.x/this.a),a=2.5*(Math.atan(Math.exp(.8*s.y/this.a))-t.PI/4);return s.x=i,s.y=a,s}}}),i("proj4/projCode/sinu",["../common"],function(t){return{init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=t.pj_enfn(this.es)},forward:function(s){var i,a,h=s.x,e=s.y;if(h=t.adjust_lon(h-this.long0),this.sphere){if(this.m)for(var n=this.n*Math.sin(e),r=t.MAX_ITER;r;--r){var o=(this.m*e+Math.sin(e)-n)/(this.m+Math.cos(e));if(e-=o,Math.abs(o)<t.EPSLN)break}else e=1!==this.n?Math.asin(this.n*Math.sin(e)):e;i=this.a*this.C_x*h*(this.m+Math.cos(e)),a=this.a*this.C_y*e}else{var l=Math.sin(e),u=Math.cos(e);a=this.a*t.pj_mlfn(e,l,u,this.en),i=this.a*h*u/Math.sqrt(1-this.es*l*l)}return s.x=i,s.y=a,s},inverse:function(s){var i,a,h;if(s.x-=this.x0,s.y-=this.y0,i=s.y/this.a,this.sphere)s.y/=this.C_y,i=this.m?Math.asin((this.m*s.y+Math.sin(s.y))/this.n):1!==this.n?Math.asin(Math.sin(s.y)/this.n):s.y,h=s.x/(this.C_x*(this.m+Math.cos(s.y)));else{i=t.pj_inv_mlfn(s.y/this.a,this.es,this.en);var e=Math.abs(i);e<t.HALF_PI?(e=Math.sin(i),a=this.long0+s.x*Math.sqrt(1-this.es*e*e)/(this.a*Math.cos(i)),h=t.adjust_lon(a)):e-t.EPSLN<t.HALF_PI&&(h=this.long0)}return s.x=h,s.y=i,s}}}),i("proj4/projCode/moll",["../common"],function(t){return{init:function(){},forward:function(s){for(var i=s.x,a=s.y,h=t.adjust_lon(i-this.long0),e=a,n=t.PI*Math.sin(a),r=0;!0;r++){var o=-(e+Math.sin(e)-n)/(1+Math.cos(e));if(e+=o,Math.abs(o)<t.EPSLN)break}e/=2,t.PI/2-Math.abs(a)<t.EPSLN&&(h=0);var l=.900316316158*this.a*h*Math.cos(e)+this.x0,u=1.4142135623731*this.a*Math.sin(e)+this.y0;return s.x=l,s.y=u,s},inverse:function(s){var i,a;s.x-=this.x0,s.y-=this.y0,a=s.y/(1.4142135623731*this.a),Math.abs(a)>.999999999999&&(a=.999999999999),i=Math.asin(a);var h=t.adjust_lon(this.long0+s.x/(.900316316158*this.a*Math.cos(i)));h<-t.PI&&(h=-t.PI),h>t.PI&&(h=t.PI),a=(2*i+Math.sin(2*i))/t.PI,Math.abs(a)>1&&(a=1);var e=Math.asin(a);return s.x=h,s.y=e,s}}}),i("proj4/projCode/eqdc",["../common"],function(t){return{init:function(){return Math.abs(this.lat1+this.lat2)<t.EPSLN?(t.reportError("eqdc:init: Equal Latitudes"),void 0):(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=t.e0fn(this.es),this.e1=t.e1fn(this.es),this.e2=t.e2fn(this.es),this.e3=t.e3fn(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=t.msfnz(this.e,this.sinphi,this.cosphi),this.ml1=t.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<t.EPSLN?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=t.msfnz(this.e,this.sinphi,this.cosphi),this.ml2=t.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=t.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0),void 0)},forward:function(s){var i,a=s.x,h=s.y;if(this.sphere)i=this.a*(this.g-h);else{var e=t.mlfn(this.e0,this.e1,this.e2,this.e3,h);i=this.a*(this.g-e)}var n=this.ns*t.adjust_lon(a-this.long0),r=this.x0+i*Math.sin(n),o=this.y0+this.rh-i*Math.cos(n);return s.x=r,s.y=o,s},inverse:function(s){s.x-=this.x0,s.y=this.rh-s.y+this.y0;var i,a,h,e;this.ns>=0?(a=Math.sqrt(s.x*s.x+s.y*s.y),i=1):(a=-Math.sqrt(s.x*s.x+s.y*s.y),i=-1);var n=0;if(0!==a&&(n=Math.atan2(i*s.x,i*s.y)),this.sphere)return e=t.adjust_lon(this.long0+n/this.ns),h=t.adjust_lat(this.g-a/this.a),s.x=e,s.y=h,s;var r=this.g-a/this.a;return h=t.imlfn(r,this.e0,this.e1,this.e2,this.e3),e=t.adjust_lon(this.long0+n/this.ns),s.x=e,s.y=h,s}}}),i("proj4/projCode/vandg",["../common"],function(t){return{init:function(){this.R=this.a},forward:function(s){var i,a,h=s.x,e=s.y,n=t.adjust_lon(h-this.long0);Math.abs(e)<=t.EPSLN&&(i=this.x0+this.R*n,a=this.y0);var r=t.asinz(2*Math.abs(e/t.PI));(Math.abs(n)<=t.EPSLN||Math.abs(Math.abs(e)-t.HALF_PI)<=t.EPSLN)&&(i=this.x0,a=e>=0?this.y0+t.PI*this.R*Math.tan(.5*r):this.y0+t.PI*this.R*-Math.tan(.5*r));var o=.5*Math.abs(t.PI/n-n/t.PI),l=o*o,u=Math.sin(r),c=Math.cos(r),M=c/(u+c-1),f=M*M,m=M*(2/u-1),p=m*m,_=t.PI*this.R*(o*(M-p)+Math.sqrt(l*(M-p)*(M-p)-(p+l)*(f-p)))/(p+l);0>n&&(_=-_),i=this.x0+_;var d=l+M;return _=t.PI*this.R*(m*d-o*Math.sqrt((p+l)*(l+1)-d*d))/(p+l),a=e>=0?this.y0+_:this.y0-_,s.x=i,s.y=a,s},inverse:function(s){var i,a,h,e,n,r,o,l,u,c,M,f,m;return s.x-=this.x0,s.y-=this.y0,M=t.PI*this.R,h=s.x/M,e=s.y/M,n=h*h+e*e,r=-Math.abs(e)*(1+n),o=r-2*e*e+h*h,l=-2*r+1+2*e*e+n*n,m=e*e/l+(2*o*o*o/l/l/l-9*r*o/l/l)/27,u=(r-o*o/3/l)/l,c=2*Math.sqrt(-u/3),M=3*m/u/c,Math.abs(M)>1&&(M=M>=0?1:-1),f=Math.acos(M)/3,a=s.y>=0?(-c*Math.cos(f+t.PI/3)-o/3/l)*t.PI:-(-c*Math.cos(f+t.PI/3)-o/3/l)*t.PI,i=Math.abs(h)<t.EPSLN?this.long0:t.adjust_lon(this.long0+t.PI*(n-1+Math.sqrt(1+2*(h*h-e*e)+n*n))/2/h),s.x=i,s.y=a,s}}}),i("proj4/projCode/aeqd",["../common"],function(t){return{init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(s){var i,a,h,e,n,r,o,l,u,c,M,f,m,p,_,d,y,g,x,v,P,b,C,S=s.x,j=s.y,N=Math.sin(s.y),A=Math.cos(s.y),I=t.adjust_lon(S-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=t.EPSLN?(s.x=this.x0+this.a*(t.HALF_PI-j)*Math.sin(I),s.y=this.y0-this.a*(t.HALF_PI-j)*Math.cos(I),s):Math.abs(this.sin_p12+1)<=t.EPSLN?(s.x=this.x0+this.a*(t.HALF_PI+j)*Math.sin(I),s.y=this.y0+this.a*(t.HALF_PI+j)*Math.cos(I),s):(g=this.sin_p12*N+this.cos_p12*A*Math.cos(I),d=Math.acos(g),y=d/Math.sin(d),s.x=this.x0+this.a*y*A*Math.sin(I),s.y=this.y0+this.a*y*(this.cos_p12*N-this.sin_p12*A*Math.cos(I)),s):(i=t.e0fn(this.es),a=t.e1fn(this.es),h=t.e2fn(this.es),e=t.e3fn(this.es),Math.abs(this.sin_p12-1)<=t.EPSLN?(n=this.a*t.mlfn(i,a,h,e,t.HALF_PI),r=this.a*t.mlfn(i,a,h,e,j),s.x=this.x0+(n-r)*Math.sin(I),s.y=this.y0-(n-r)*Math.cos(I),s):Math.abs(this.sin_p12+1)<=t.EPSLN?(n=this.a*t.mlfn(i,a,h,e,t.HALF_PI),r=this.a*t.mlfn(i,a,h,e,j),s.x=this.x0+(n+r)*Math.sin(I),s.y=this.y0+(n+r)*Math.cos(I),s):(o=N/A,l=t.gN(this.a,this.e,this.sin_p12),u=t.gN(this.a,this.e,N),c=Math.atan((1-this.es)*o+this.es*l*this.sin_p12/(u*A)),M=Math.atan2(Math.sin(I),this.cos_p12*Math.tan(c)-this.sin_p12*Math.cos(I)),x=0===M?Math.asin(this.cos_p12*Math.sin(c)-this.sin_p12*Math.cos(c)):Math.abs(Math.abs(M)-t.PI)<=t.EPSLN?-Math.asin(this.cos_p12*Math.sin(c)-this.sin_p12*Math.cos(c)):Math.asin(Math.sin(I)*Math.cos(c)/Math.sin(M)),f=this.e*this.sin_p12/Math.sqrt(1-this.es),m=this.e*this.cos_p12*Math.cos(M)/Math.sqrt(1-this.es),p=f*m,_=m*m,v=x*x,P=v*x,b=P*x,C=b*x,d=l*x*(1-v*_*(1-_)/6+P/8*p*(1-2*_)+b/120*(_*(4-7*_)-3*f*f*(1-7*_))-C/48*p),s.x=this.x0+d*Math.sin(M),s.y=this.y0+d*Math.cos(M),s))},inverse:function(s){s.x-=this.x0,s.y-=this.y0;var i,a,h,e,n,r,o,l,u,c,M,f,m,p,_,d,y,g,x,v,P,b,C;if(this.sphere){if(i=Math.sqrt(s.x*s.x+s.y*s.y),i>2*t.HALF_PI*this.a)return;return a=i/this.a,h=Math.sin(a),e=Math.cos(a),n=this.long0,Math.abs(i)<=t.EPSLN?r=this.lat0:(r=t.asinz(e*this.sin_p12+s.y*h*this.cos_p12/i),o=Math.abs(this.lat0)-t.HALF_PI,n=Math.abs(o)<=t.EPSLN?this.lat0>=0?t.adjust_lon(this.long0+Math.atan2(s.x,-s.y)):t.adjust_lon(this.long0-Math.atan2(-s.x,s.y)):t.adjust_lon(this.long0+Math.atan2(s.x*h,i*this.cos_p12*e-s.y*this.sin_p12*h))),s.x=n,s.y=r,s}return l=t.e0fn(this.es),u=t.e1fn(this.es),c=t.e2fn(this.es),M=t.e3fn(this.es),Math.abs(this.sin_p12-1)<=t.EPSLN?(f=this.a*t.mlfn(l,u,c,M,t.HALF_PI),i=Math.sqrt(s.x*s.x+s.y*s.y),m=f-i,r=t.imlfn(m/this.a,l,u,c,M),n=t.adjust_lon(this.long0+Math.atan2(s.x,-1*s.y)),s.x=n,s.y=r,s):Math.abs(this.sin_p12+1)<=t.EPSLN?(f=this.a*t.mlfn(l,u,c,M,t.HALF_PI),i=Math.sqrt(s.x*s.x+s.y*s.y),m=i-f,r=t.imlfn(m/this.a,l,u,c,M),n=t.adjust_lon(this.long0+Math.atan2(s.x,s.y)),s.x=n,s.y=r,s):(i=Math.sqrt(s.x*s.x+s.y*s.y),d=Math.atan2(s.x,s.y),p=t.gN(this.a,this.e,this.sin_p12),y=Math.cos(d),g=this.e*this.cos_p12*y,x=-g*g/(1-this.es),v=3*this.es*(1-x)*this.sin_p12*this.cos_p12*y/(1-this.es),P=i/p,b=P-x*(1+x)*Math.pow(P,3)/6-v*(1+3*x)*Math.pow(P,4)/24,C=1-x*b*b/2-P*b*b*b/6,_=Math.asin(this.sin_p12*Math.cos(b)+this.cos_p12*Math.sin(b)*y),n=t.adjust_lon(this.long0+Math.asin(Math.sin(d)*Math.sin(b)/Math.cos(_))),r=Math.atan((1-this.es*C*this.sin_p12/Math.sin(_))*Math.tan(_)/(1-this.es)),s.x=n,s.y=r,s)}}}),i("proj4/projections",["require","exports","module","./projCode/longlat","./projCode/tmerc","./projCode/utm","./projCode/sterea","./projCode/somerc","./projCode/omerc","./projCode/lcc","./projCode/krovak","./projCode/cass","./projCode/laea","./projCode/merc","./projCode/aea","./projCode/gnom","./projCode/cea","./projCode/eqc","./projCode/poly","./projCode/nzmg","./projCode/mill","./projCode/sinu","./projCode/moll","./projCode/eqdc","./projCode/vandg","./projCode/aeqd","./projCode/longlat"],function(t,s){s.longlat=t("./projCode/longlat"),s.identity=s.longlat,s.tmerc=t("./projCode/tmerc"),s.utm=t("./projCode/utm"),s.sterea=t("./projCode/sterea"),s.somerc=t("./projCode/somerc"),s.omerc=t("./projCode/omerc"),s.lcc=t("./projCode/lcc"),s.krovak=t("./projCode/krovak"),s.cass=t("./projCode/cass"),s.laea=t("./projCode/laea"),s.merc=t("./projCode/merc"),s.aea=t("./projCode/aea"),s.gnom=t("./projCode/gnom"),s.cea=t("./projCode/cea"),s.eqc=t("./projCode/eqc"),s.poly=t("./projCode/poly"),s.nzmg=t("./projCode/nzmg"),s.mill=t("./projCode/mill"),s.sinu=t("./projCode/sinu"),s.moll=t("./projCode/moll"),s.eqdc=t("./projCode/eqdc"),s.vandg=t("./projCode/vandg"),s.aeqd=t("./projCode/aeqd"),s.longlat=t("./projCode/longlat"),s.identity=s.longlat}),i("proj4/Proj",["./extend","./common","./defs","./constants","./datum","./projections","./wkt","./projString"],function(t,s,i,a,h,e,n,r){var o=function l(s){if(!(this instanceof l))return new l(s);this.srsCodeInput=s;var a;"string"==typeof s?s in i?(this.deriveConstants(i[s]),t(this,i[s])):s.indexOf("GEOGCS")>=0||s.indexOf("GEOCCS")>=0||s.indexOf("PROJCS")>=0||s.indexOf("LOCAL_CS")>=0?(a=n(s),this.deriveConstants(a),t(this,a)):"+"===s[0]&&(a=r(s),this.deriveConstants(a),t(this,a)):(this.deriveConstants(s),t(this,s)),this.initTransforms(this.projName)};return o.prototype={initTransforms:function(s){if(!(s in o.projections))throw"unknown projection "+s;t(this,o.projections[s]),this.init()},deriveConstants:function(i){if(i.nadgrids&&0===i.nadgrids.length&&(i.nadgrids=null),i.nadgrids){i.grids=i.nadgrids.split(",");var e=null,n=i.grids.length;if(n>0)for(var r=0;n>r;r++){e=i.grids[r];var o=e.split("@");""!==o[o.length-1]&&(i.grids[r]={mandatory:1===o.length,name:o[o.length-1],grid:a.grids[o[o.length-1]]},i.grids[r].mandatory&&!i.grids[r].grid)}}if(i.datumCode&&"none"!==i.datumCode){var l=a.Datum[i.datumCode];l&&(i.datum_params=l.towgs84?l.towgs84.split(","):null,i.ellps=l.ellipse,i.datumName=l.datumName?l.datumName:i.datumCode)}if(!i.a){var u=a.Ellipsoid[i.ellps]?a.Ellipsoid[i.ellps]:a.Ellipsoid.WGS84;t(i,u)}i.rf&&!i.b&&(i.b=(1-1/i.rf)*i.a),(0===i.rf||Math.abs(i.a-i.b)<s.EPSLN)&&(i.sphere=!0,i.b=i.a),i.a2=i.a*i.a,i.b2=i.b*i.b,i.es=(i.a2-i.b2)/i.a2,i.e=Math.sqrt(i.es),i.R_A&&(i.a*=1-i.es*(s.SIXTH+i.es*(s.RA4+i.es*s.RA6)),i.a2=i.a*i.a,i.b2=i.b*i.b,i.es=0),i.ep2=(i.a2-i.b2)/i.b2,i.k0||(i.k0=1),i.axis||(i.axis="enu"),i.datum=h(i)}},o.projections=e,o}),i("proj4/datum_transform",["./common"],function(t){return function(s,i,a){function h(s){return s===t.PJD_3PARAM||s===t.PJD_7PARAM}var e,n,r;if(s.compare_datums(i))return a;if(s.datum_type===t.PJD_NODATUM||i.datum_type===t.PJD_NODATUM)return a;var o=s.a,l=s.es,u=i.a,c=i.es,M=s.datum_type;if(M===t.PJD_GRIDSHIFT)if(0===this.apply_gridshift(s,0,a))s.a=t.SRS_WGS84_SEMIMAJOR,s.es=t.SRS_WGS84_ESQUARED;else{if(!s.datum_params)return s.a=o,s.es=s.es,a;for(e=1,n=0,r=s.datum_params.length;r>n;n++)e*=s.datum_params[n];if(0===e)return s.a=o,s.es=s.es,a;M=s.datum_params.length>3?t.PJD_7PARAM:t.PJD_3PARAM}return i.datum_type===t.PJD_GRIDSHIFT&&(i.a=t.SRS_WGS84_SEMIMAJOR,i.es=t.SRS_WGS84_ESQUARED),(s.es!==i.es||s.a!==i.a||h(M)||h(i.datum_type))&&(s.geodetic_to_geocentric(a),h(s.datum_type)&&s.geocentric_to_wgs84(a),h(i.datum_type)&&i.geocentric_from_wgs84(a),i.geocentric_to_geodetic(a)),i.datum_type===t.PJD_GRIDSHIFT&&this.apply_gridshift(i,1,a),s.a=o,s.es=l,i.a=u,i.es=c,a}}),i("proj4/adjust_axis",[],function(){return function(t,s,i){var a,h,e,n=i.x,r=i.y,o=i.z||0;for(e=0;3>e;e++)if(!s||2!==e||void 0!==i.z)switch(0===e?(a=n,h="x"):1===e?(a=r,h="y"):(a=o,h="z"),t.axis[e]){case"e":i[h]=a;break;case"w":i[h]=-a;break;case"n":i[h]=a;break;case"s":i[h]=-a;break;case"u":void 0!==i[h]&&(i.z=a);break;case"d":void 0!==i[h]&&(i.z=-a);break;default:return null}return i}}),i("proj4/transform",["./common","./datum_transform","./adjust_axis","./Proj"],function(t,s,i,a){return function(h,e,n){function r(s,i){return(s.datum.datum_type===t.PJD_3PARAM||s.datum.datum_type===t.PJD_7PARAM)&&"WGS84"!==i.datumCode}var o;return h.datum&&e.datum&&(r(h,e)||r(e,h))&&(o=new a("WGS84"),this.transform(h,o,n),h=o),"enu"!==h.axis&&i(h,!1,n),"longlat"===h.projName?(n.x*=t.D2R,n.y*=t.D2R):(h.to_meter&&(n.x*=h.to_meter,n.y*=h.to_meter),h.inverse(n)),h.from_greenwich&&(n.x+=h.from_greenwich),n=s(h.datum,e.datum,n),e.from_greenwich&&(n.x-=e.from_greenwich),"longlat"===e.projName?(n.x*=t.R2D,n.y*=t.R2D):(e.forward(n),e.to_meter&&(n.x/=e.to_meter,n.y/=e.to_meter)),"enu"!==e.axis&&i(e,!0,n),n}}),i("proj4/core",["./Point","./Proj","./transform"],function(t,s,i){var a=s("WGS84");return function(h,e,n){var r=function(s,a,n){var r;return Array.isArray(n)?(r=i(s,a,t(n)),3===n.length?[r.x,r.y,r.z]:[r.x,r.y]):i(h,e,n)};return h=h instanceof s?h:s(h),"undefined"==typeof e?(e=h,h=a):"string"==typeof e?e=s(e):"x"in e||Array.isArray(e)?(n=e,e=h,h=a):e=e instanceof s?e:s(e),n?r(h,e,n):{forward:function(t){return r(h,e,t)},inverse:function(t){return r(e,h,t)}}}}),i("proj4",["proj4/core","proj4/Proj","proj4/Point","proj4/defs","proj4/transform","proj4/mgrs"],function(t,s,i,a,h,e){return t.defaultDatum="WGS84",t.Proj=s,t.WGS84=new t.Proj("WGS84"),t.Point=i,t.defs=a,t.transform=h,t.mgrs=e,t}),s("proj4")});

/**
 * http://github.com/kartena/Proj4Leaflet  --  src/proj4leaflet.js (2.9 kb)
 */
(function(factory){var L,proj4;if(typeof define==='function'&&define.amd){define(['leaflet','proj4'],factory);}else if(typeof module!=='undefined'){L=require('leaflet');proj4=require('proj4');module.exports=factory(L,proj4);}else{if(typeof window.L==='undefined'||typeof window.proj4==='undefined')
throw'Leaflet and proj4 must be loaded first';factory(window.L,window.proj4);}}(function(L,proj4){L.Proj={};L.Proj._isProj4Obj=function(a){return(typeof a.inverse!=='undefined'&&typeof a.forward!=='undefined');};L.Proj.ScaleDependantTransformation=function(scaleTransforms){this.scaleTransforms=scaleTransforms;};L.Proj.ScaleDependantTransformation.prototype.transform=function(point,scale){return this.scaleTransforms[scale].transform(point,scale);};L.Proj.ScaleDependantTransformation.prototype.untransform=function(point,scale){return this.scaleTransforms[scale].untransform(point,scale);};L.Proj.Projection=L.Class.extend({initialize:function(a,def){if(L.Proj._isProj4Obj(a)){this._proj=a;}else{var code=a;if(def){proj4.defs(code,def);}else if(proj4.defs[code]===undefined){var urn=code.split(':');if(urn.length>3){code=urn[urn.length-3]+':'+urn[urn.length-1];}
if(proj4.defs[code]===undefined){throw'No projection definition for code '+code;}}
this._proj=proj4(code);}},project:function(latlng){var point=this._proj.forward([latlng.lng,latlng.lat]);return new L.Point(point[0],point[1]);},unproject:function(point,unbounded){var point2=this._proj.inverse([point.x,point.y]);return new L.LatLng(point2[1],point2[0],unbounded);}});L.Proj.CRS=L.Class.extend({includes:L.CRS,options:{transformation:new L.Transformation(1,0,-1,0)},initialize:function(a,b,c){var code,proj,def,options;if(L.Proj._isProj4Obj(a)){proj=a;code=proj.srsCode;options=b||{};this.projection=new L.Proj.Projection(proj);}else{code=a;def=b;options=c||{};this.projection=new L.Proj.Projection(code,def);}
L.Util.setOptions(this,options);this.code=code;this.transformation=this.options.transformation;if(this.options.origin){this.transformation=new L.Transformation(1,-this.options.origin[0],-1,this.options.origin[1]);}
if(this.options.scales){this._scales=this.options.scales;}else if(this.options.resolutions){this._scales=[];for(var i=this.options.resolutions.length-1;i>=0;i--){if(this.options.resolutions[i]){this._scales[i]=1 / this.options.resolutions[i];}}}},scale:function(zoom){var iZoom=Math.floor(zoom),baseScale,nextScale,scaleDiff,zDiff;if(zoom===iZoom){return this._scales[zoom];}else{baseScale=this._scales[iZoom];nextScale=this._scales[iZoom+1];scaleDiff=nextScale-baseScale;zDiff=(zoom-iZoom);return baseScale+scaleDiff*zDiff;}},getSize:function(zoom){var b=this.options.bounds,s,min,max;if(b){s=this.scale(zoom);min=this.transformation.transform(b.min,s);max=this.transformation.transform(b.max,s);return L.point(Math.abs(max.x-min.x),Math.abs(max.y-min.y));}else{s=256*Math.pow(2,zoom);return L.point(s,s);}}});return L.Proj;}));

/**
 * http://github.com/Dominique92/Leaflet.MapMultiCRS  --  MapMultiCRS.js (0.8 kb)
 */
L.Map.addInitHook(function(){for(l in this.options.layers)
if(this.options.layers[l].options.crs)
this.options.crs=this.options.layers[l].options.crs;this.on('baselayerchange',function(event){event.layer._map.setCRS(event.layer.options.crs);});});L.Map.include({setCRS:function(crs){if(!crs)
crs=L.CRS.EPSG3857;if(this.options.crs==crs)
return;var bounds=this.getBounds(),center=this.getCenter();this.options.crs=crs;var nw=bounds.getNorthWest(),se=bounds.getSouthEast(),diagMap=this.getSize().distanceTo(L.point(0,0)),ecartMin=Infinity;for(z=0;z<this.getMaxZoom();z++){var diagBoundsAtZoom=this.project(se,z).distanceTo(this.project(nw,z)),ecart=Math.abs(diagBoundsAtZoom-diagMap);if(ecart<ecartMin){ecartMin=ecart;closestZoom=z;}}
this._resetView(center,closestZoom);}});

/**
 * http://github.com/Dominique92/Leaflet.MapMultiCRS  --  IGN.js (1.9 kb)
 */
L.CRS.EPSG27571=L.extend(new L.Proj.CRS('EPSG:27571','+title=Lambert zone 1 , LCC +proj=lcc +lat_1=49.50000000000001 +lat_0=49.50000000000001 +lon_0=0 +k_0=0.999877341 +x_0=600000 +y_0=1200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs'),{bounds:L.bounds([-5.2,48.15],[8.23,51.1]),name:'Lambert I (Nord)'});L.CRS.EPSG27572=L.extend({},L.CRS.EPSG27571,new L.Proj.CRS('EPSG:27572','+title=Lambert 2 tendue, LCC +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs'),{bounds:L.bounds([-5.2,42.25],[8.23,51.1]),name:'Lambert II (Centre)'});L.CRS.EPSG27573=L.extend({},L.CRS.EPSG27571,new L.Proj.CRS('EPSG:27573','+title=Lambert zone 3, LCC +proj=lcc +lat_1=44.10000000000001 +lat_0=44.10000000000001 +lon_0=0 +k_0=0.999877499 +x_0=600000 +y_0=3200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs'),{bounds:L.bounds([-1.76,42.33],[7.77,45.45]),name:'Lambert III (Sud)'});L.CRS.EPSG27574=L.extend({},L.CRS.EPSG27571,new L.Proj.CRS('EPSG:27574','+title=Lambert zone 4, +proj=lcc +lat_1=42.16500000000001 +lat_0=42.16500000000001 +lon_0=0 +k_0=0.99994471 +x_0=234.358 +y_0=4185861.369 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs'),{bounds:L.bounds([8.5,41.33],[9.6,43.05]),name:'Lambert IV (Corse)'});L.TileLayer.IGN=L.TileLayer.extend({options:{l:'GEOGRAPHICALGRIDSYSTEMS.MAPS',attribution:'&copy; <a href="http://www.ign.fr/">IGN</a>',url:"http://gpp3-wxs.ign.fr/"+
(typeof key=='object'?key.ign:null)+"/wmts"+"?LAYER={l}"+"&EXCEPTIONS=text/xml"+"&FORMAT=image/jpeg"+"&SERVICE=WMTS"+"&VERSION=1.0.0"+"&REQUEST=GetTile"+"&STYLE=normal"+"&TILEMATRIXSET=PM"+"&TILEMATRIX={z}"+"&TILECOL={x}"+"&TILEROW={y}"},initialize:function(layer,options){L.setOptions(this,options);if(layer)
this.options.l=layer;L.TileLayer.prototype.initialize.call(this,this.options.url);}});

/**
 * http://github.com/Dominique92/Leaflet.MapMultiCRS  --  IGM.js (1.1 kb)
 */
L.TileLayer.WMS.IGM=L.TileLayer.WMS.extend({initialize:function(){L.TileLayer.WMS.prototype.initialize.call(this,'http://129.206.228.72/cached/osm?',{crs:L.CRS.EPSG900913,tileSize:512});},onAdd:function(map){L.TileLayer.WMS.prototype.onAdd.call(this,map);map.on('zoomend',this.onZoom,this);this.onZoom();},onZoom:function(){if(!this._map)
return;var np={url:'http://wms.pcn.minambiente.it/ogc?map=/ms_ogc/WMS_v1.3/raster/',urlExt:'',attribution:'&copy; <a href="http://www.pcn.minambiente.it/viewer">IGM</a>'};if(this._map._zoom<11){np.url='http://129.206.228.72/cached/osm?';np.layers='osm_auto:all';np.attribution='&copy; <a href="http://www.osm-wms.de/">OSM</a>'}else if(this._map._zoom<13){np.urlExt='IGM_250000.map';np.layers='CB.IGM250000';}else if(this._map._zoom<15){np.urlExt='IGM_100000.map';np.layers='MB.IGM100000';}else if(this._map._zoom<16){np.urlExt='IGM_25000.map';np.layers='CB.IGM25000';}
if(this.wmsParams.layers!=np.layers){this._url=np.url+np.urlExt;this.wmsParams.layers=np.layers;this.redraw();this.options.attribution=np.attribution;this._map.attributionControl._attributions=[];this._map.attributionControl.addAttribution(np.attribution);}}});

/**
 * http://github.com/Dominique92/Leaflet.MapMultiCRS  --  IDEE.js (0.5 kb)
 */
L.TileLayer.WMS.IDEE=L.TileLayer.WMS.extend({initialize:function(){L.TileLayer.WMS.prototype.initialize.call(this,'http://www.idee.es/wms/MTN-Raster/MTN-Raster',{layers:'mtn_rasterizado',attribution:'&copy; <a href="http://www.idee.es/">IDEE</a>'});}});L.TileLayer.WMS.IDEE.Photo=L.TileLayer.WMS.extend({initialize:function(){L.TileLayer.WMS.prototype.initialize.call(this,'http://www.ign.es/wms-inspire/pnoa-ma',{layers:'OI.OrthoimageCoverage',attribution:'&copy; <a href="http://www.ign.es/PNOA/">PNOA</a>'});}});

/**
 * http://github.com/Dominique92/Leaflet.MapMultiCRS  --  SwissTopo.js (1.1 kb)
 */
L.CRS.EPSG21781=L.extend(new L.Proj.CRS('EPSG:21781','+proj=somerc +lat_0=46.95240555555556 +lon_0=7.439583333333333 +x_0=600000 +y_0=200000 +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +units=m +no_defs',{resolutions:[4000,3750,3500,3250,3000,2750,2500,2250,2000,1750,1500,1250,1000,750,650,500,250,100,50,20,10,5,2.5,2,1.5,1,0.5],origin:[420000,350000]}),{bounds:L.bounds([5.97,45.83],[10.49,47.81]),name:'SwissGrid(CH1903/NV03)',title:{lng:'X',lat:'Y'}});L.TileLayer.SwissTopo=L.TileLayer.extend({options:{url:'http://wmts{s}.geo.admin.ch/1.0.0/',subdomains:'56789',layerName:'ch.swisstopo.pixelkarte-farbe',time:20120809,matrixSet:21781,scheme:'xyz',crs:L.CRS.EPSG21781,maxZoom:L.CRS.EPSG21781.options.resolutions.length-1,minZoom:0,continuousWorld:true,attribution:'Map data &copy; 2013 swisstopo, BAFU'},initialize:function(layer,options){L.setOptions(this,options);if(layer)
this.options.layerName=layer;L.TileLayer.prototype.initialize.call(this,this.options.url+this.options.layerName+'/default/'+this.options.time+'/'+this.options.matrixSet+'/{z}/{y}/{x}.jpeg',this.options);}});

/**
 * http://github.com/shramov/leaflet-plugins  --  layer/tile/Google.js (3.7 kb)
 */
L.Google=L.Class.extend({includes:L.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:'abc',errorTileUrl:'',attribution:'',opacity:1,continuousWorld:false,noWrap:false,mapOptions:{backgroundColor:'#dddddd'}},initialize:function(type,options){L.Util.setOptions(this,options);this._ready=google.maps.Map!==undefined;if(!this._ready)L.Google.asyncWait.push(this);this._type=type||'SATELLITE';},onAdd:function(map,insertAtTheBottom){this._map=map;this._insertAtTheBottom=insertAtTheBottom;this._initContainer();this._initMapObject();map.on('viewreset',this._resetCallback,this);this._limitedUpdate=L.Util.limitExecByInterval(this._update,150,this);map.on('move',this._update,this);map.on('zoomanim',this._handleZoomAnim,this);map._controlCorners.bottomright.style.marginBottom='20px';this._reset();this._update();},onRemove:function(map){map._container.removeChild(this._container);map.off('viewreset',this._resetCallback,this);map.off('move',this._update,this);map.off('zoomanim',this._handleZoomAnim,this);map._controlCorners.bottomright.style.marginBottom='0em';},getAttribution:function(){return this.options.attribution;},setOpacity:function(opacity){this.options.opacity=opacity;if(opacity<1){L.DomUtil.setOpacity(this._container,opacity);}},setElementSize:function(e,size){e.style.width=size.x+'px';e.style.height=size.y+'px';},_initContainer:function(){var tilePane=this._map._container,first=tilePane.firstChild;if(!this._container){this._container=L.DomUtil.create('div','leaflet-google-layer leaflet-top leaflet-left');this._container.id='_GMapContainer_'+L.Util.stamp(this);this._container.style.zIndex='auto';}
tilePane.insertBefore(this._container,first);this.setOpacity(this.options.opacity);this.setElementSize(this._container,this._map.getSize());},_initMapObject:function(){if(!this._ready)return;this._google_center=new google.maps.LatLng(0,0);var map=new google.maps.Map(this._container,{center:this._google_center,zoom:0,tilt:0,mapTypeId:google.maps.MapTypeId[this._type],disableDefaultUI:true,keyboardShortcuts:false,draggable:false,disableDoubleClickZoom:true,scrollwheel:false,streetViewControl:false,styles:this.options.mapOptions.styles,backgroundColor:this.options.mapOptions.backgroundColor});var _this=this;this._reposition=google.maps.event.addListenerOnce(map,'center_changed',function(){_this.onReposition();});this._google=map;google.maps.event.addListenerOnce(map,'idle',function(){_this._checkZoomLevels();});google.maps.event.addListenerOnce(map,'tilesloaded',function(){_this.fire('load');});this.fire('MapObjectInitialized',{mapObject:map});},_checkZoomLevels:function(){if(this._google.getZoom()!==this._map.getZoom()){this._map.setZoom(this._google.getZoom());}},_resetCallback:function(e){this._reset(e.hard);},_reset:function(clearOldContainer){this._initContainer();},_update:function(e){if(!this._google)return;this._resize();var center=this._map.getCenter();var _center=new google.maps.LatLng(center.lat,center.lng);this._google.setCenter(_center);this._google.setZoom(Math.round(this._map.getZoom()));this._checkZoomLevels();},_resize:function(){var size=this._map.getSize();if(this._container.style.width===size.x&&this._container.style.height===size.y)
return;this.setElementSize(this._container,size);this.onReposition();},_handleZoomAnim:function(e){var center=e.center;var _center=new google.maps.LatLng(center.lat,center.lng);this._google.setCenter(_center);this._google.setZoom(Math.round(e.zoom));},onReposition:function(){if(!this._google)return;google.maps.event.trigger(this._google,'resize');}});L.Google.asyncWait=[];L.Google.asyncInitialize=function(){var i;for(i=0;i<L.Google.asyncWait.length;i++){var o=L.Google.asyncWait[i];o._ready=true;if(o._container){o._initMapObject();o._update();}}
L.Google.asyncWait=[];};

/**
 * http://github.com/shramov/leaflet-plugins  --  layer/tile/Bing.js (3 kb)
 */
L.BingLayer=L.TileLayer.extend({options:{subdomains:[0,1,2,3],type:'Aerial',attribution:'Bing',culture:''},initialize:function(key,options){L.Util.setOptions(this,options);this._key=key;this._url=null;this.metaRequested=false;},tile2quad:function(x,y,z){var quad='';for(var i=z;i>0;i--){var digit=0;var mask=1<<(i-1);if((x&mask)!==0)digit+=1;if((y&mask)!==0)digit+=2;quad=quad+digit;}
return quad;},getTileUrl:function(p,z){var zoom=this._getZoomForUrl();var subdomains=this.options.subdomains,s=this.options.subdomains[Math.abs((p.x+p.y)%subdomains.length)];return this._url.replace('{subdomain}',s).replace('{quadkey}',this.tile2quad(p.x,p.y,zoom)).replace('{culture}',this.options.culture);},loadMetadata:function(){if(this.metaRequested)return;this.metaRequested=true;var _this=this;var cbid='_bing_metadata_'+L.Util.stamp(this);window[cbid]=function(meta){window[cbid]=undefined;var e=document.getElementById(cbid);e.parentNode.removeChild(e);if(meta.errorDetails){return;}
_this.initMetadata(meta);};var urlScheme=(document.location.protocol==='file:')?'http':document.location.protocol.slice(0,-1);var url=urlScheme+'://dev.virtualearth.net/REST/v1/Imagery/Metadata/'
+this.options.type+'?include=ImageryProviders&jsonp='+cbid+'&key='+this._key+'&UriScheme='+urlScheme;var script=document.createElement('script');script.type='text/javascript';script.src=url;script.id=cbid;document.getElementsByTagName('head')[0].appendChild(script);},initMetadata:function(meta){var r=meta.resourceSets[0].resources[0];this.options.subdomains=r.imageUrlSubdomains;this._url=r.imageUrl;this._providers=[];if(r.imageryProviders){for(var i=0;i<r.imageryProviders.length;i++){var p=r.imageryProviders[i];for(var j=0;j<p.coverageAreas.length;j++){var c=p.coverageAreas[j];var coverage={zoomMin:c.zoomMin,zoomMax:c.zoomMax,active:false};var bounds=new L.LatLngBounds(new L.LatLng(c.bbox[0]+0.01,c.bbox[1]+0.01),new L.LatLng(c.bbox[2]-0.01,c.bbox[3]-0.01));coverage.bounds=bounds;coverage.attrib=p.attribution;this._providers.push(coverage);}}}
this._update();},_update:function(){if(this._url===null||!this._map)return;this._update_attribution();L.TileLayer.prototype._update.apply(this,[]);},_update_attribution:function(){var bounds=this._map.getBounds();var zoom=this._map.getZoom();for(var i=0;i<this._providers.length;i++){var p=this._providers[i];if((zoom<=p.zoomMax&&zoom>=p.zoomMin)&&bounds.intersects(p.bounds)){if(!p.active&&this._map.attributionControl)
this._map.attributionControl.addAttribution(p.attrib);p.active=true;}else{if(p.active&&this._map.attributionControl)
this._map.attributionControl.removeAttribution(p.attrib);p.active=false;}}},onAdd:function(map){this.loadMetadata();L.TileLayer.prototype.onAdd.apply(this,[map]);},onRemove:function(map){for(var i=0;i<this._providers.length;i++){var p=this._providers[i];if(p.active&&this._map.attributionControl){this._map.attributionControl.removeAttribution(p.attrib);p.active=false;}}
L.TileLayer.prototype.onRemove.apply(this,[map]);}});L.bingLayer=function(key,options){return new L.BingLayer(key,options);};

/**
 * http://github.com/rob-murray/os-leaflet  --  src/osopenspace.js (2.7 kb)
 */
L.OSOpenSpace=L.Class.extend({statics:{RESOLUTIONS:[2500,1000,500,200,100,50,25,10,5,2.5],_OSGB36:{EPSG:'EPSG:27700',DEF:'+proj=tmerc +lat_0=49 +lon_0=-2 +k=0.999601 +x_0=400000 +y_0=-100000 +ellps=airy'+'+towgs84=446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894 +units=m +no_defs no_defs',EXTENT:[1393.0196,13494.9764,671196.3657,1230275.0454],PROJ_EXTENT:[0,0,700000,1300000]},getCRS:function(){if(typeof window.L==='undefined'||typeof window.proj4==='undefined'){throw'Leaflet and Proj4js libraries must be included before OSOpenSpace layer';}
var klass=L.OSOpenSpace,osgb36crs=new L.Proj.CRS(klass._OSGB36.EPSG,klass._OSGB36.DEF,{resolutions:klass.RESOLUTIONS,bounds:L.bounds([klass._OSGB36.PROJ_EXTENT[3],klass._OSGB36.PROJ_EXTENT[0]],[klass._OSGB36.PROJ_EXTENT[2],klass._OSGB36.PROJ_EXTENT[1]])});return osgb36crs;}}});L.TileLayer.OSOpenSpace=L.TileLayer.WMS.extend({defaultWmsParams:{SERVICE:'WMS',REQUEST:'GetMap',VERSION:'1.1.1',FORMAT:'image/png'},defaultLayerOptions:{maxZoom:null,minZoom:0,continuousWorld:true,worldCopyJump:false,tms:true,attribution:" OS.OpenSpace",},resolutions:[],_url:"http://openspace.ordnancesurvey.co.uk/osmapapi/ts",debug:false,initialize:function(apiKey,options){if(!apiKey){throw new Error("OSOpenSpace layer requires an API Key parameter to function.");}
var authParams={"KEY":apiKey,"URL":"file:///"};this.options.tileSize=200;this.resolutions=L.OSOpenSpace.RESOLUTIONS;this.defaultLayerOptions.maxZoom=L.OSOpenSpace.RESOLUTIONS.length-1;var wmsParams=L.extend(authParams,this.defaultWmsParams),tileSize=options.tileSize||this.options.tileSize;wmsParams.width=wmsParams.height=200;for(var i in options){if(!this.options.hasOwnProperty(i)&&i!=='crs'){wmsParams[i]=options[i];}
if(i==='debug'){this.debug=options[i];}}
this.wmsParams=wmsParams;L.setOptions(this,this.defaultLayerOptions);},getTileUrl:function(tilePoint){if(this.debug){console.log('>>tilePoint: ',tilePoint.toString())};var map=this._map,tileSizePixels=this.options.tileSize,crs=map.options.crs,zoom=tilePoint.z,resolutionMpp=this.resolutions[zoom],tileSizeMetres=tileSizePixels*resolutionMpp;var tileBboxX0=tileSizeMetres*tilePoint.x;var tileBboxY0=tileSizeMetres*tilePoint.y;if(this.debug){console.log(">>tileSizePixels: "+tileSizePixels+", zoom: "+zoom+", resolutionMpp: "+resolutionMpp+", tileSizeMetres: "+tileSizeMetres)};var bbox=[tileBboxX0,tileBboxY0,0,0].join(',');var url=L.Util.template(this._url,{});if(this.debug){console.log(">>Bbox: ",bbox)};return url+L.Util.getParamString(this.wmsParams)+"&BBOX="+bbox+'&WIDTH='+tileSizePixels+'&HEIGHT='+tileSizePixels+'&LAYERS='+resolutionMpp;}});L.tileLayer.osopenspace=function(apiKey,options){return new L.TileLayer.OSOpenSpace(apiKey,options);};

/**
 * http://github.com/Dominique92/Leaflet.MapMultiCRS  --  MapMultiVendors.js (2.8 kb)
 */
L.Map.maps=function(name){if(typeof L.Map._maps=='undefined'){var maps={'Maps.Refuges.Info':L.tileLayer('http://maps.refuges.info/hiking/{z}/{x}/{y}.png',{attribution:'&copy; <a href="http://osm.org/copyright">Contributeurs OpenStreetMap</a> & <a href="http://wiki.openstreetmap.org/wiki/Hiking/mri">MRI</a>'}),'OpenStreetMap':L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'&copy; <a href="http://osm.org/copyright">Contributeurs OpenStreetMap</a>'}),'OpenStreetMap-FR':L.tileLayer('http://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png',{attribution:'&copy; <a href="http://osm.org/copyright">Contributeurs OpenStreetMap</a>'}),'MapQuest':L.tileLayer('http://otile{s}.mqcdn.com/tiles/1.0.0/osm/{z}/{x}/{y}.png',{subdomains:'1234',attribution:'&copy; <a href="http://osm.org/copyright">Contributeurs OpenStreetMap</a>. Tiles courtesy of <a href="http://www.mapquest.com/">MapQuest</a>'}),'IGN':new L.TileLayer.IGN(),'IGN Photo':new L.TileLayer.IGN('ORTHOIMAGERY.ORTHOPHOTOS'),'IGN Topo':new L.TileLayer.IGN('GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.STANDARD'),'IGN Classique':new L.TileLayer.IGN('GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.CLASSIQUE'),'IGN Cadastre':new L.TileLayer.IGN('CADASTRALPARCELS.PARCELS'),'SwissTopo':new L.TileLayer.SwissTopo(),'Swiss Image':new L.TileLayer.SwissTopo('ch.swisstopo.swissimage'),'Swiss Siegfried':new L.TileLayer.SwissTopo('ch.swisstopo.hiks-siegfried'),'Swiss Dufour':new L.TileLayer.SwissTopo('ch.swisstopo.hiks-dufour'),'Espagne':new L.TileLayer.WMS.IDEE(),'Espagne photo':new L.TileLayer.WMS.IDEE.Photo(),'Italie':new L.TileLayer.WMS.IGM(),};if(typeof L.Google!='undefined'&&typeof google!='undefined')
L.Util.extend(maps,{'Google Road':new L.Google('ROADMAP'),'Google Terrain':new L.Google('TERRAIN'),'Google Photo':new L.Google(),'Google Hybrid':new L.Google('HYBRID')});if(typeof L.BingLayer!='undefined'&&typeof key!='undefined'&&typeof key.bing!='undefined')
L.Util.extend(maps,{'Bing Road':new L.BingLayer(key.bing,{type:'Road'}),'Bing Photo':new L.BingLayer(key.bing),'Bing Hybrid':new L.BingLayer(key.bing,{type:'AerialWithLabels'}),});var ft=['Landscape','Outdoors','Cycle','Transport'];for(m in ft)
maps['OSM-'+ft[m]]=new L.tileLayer('http://{s}.tile.thunderforest.com/'+ft[m].toLowerCase()+'/{z}/{x}/{y}.png',{attribution:'&copy; <a href="http://osm.org/copyright">Contributeurs OpenStreetMap</a> & '+'<a href="http://www.thunderforest.com">Thunderforest '+ft[m]+'</a>'});if(typeof L.OSOpenSpace!='undefined'&&typeof key!='undefined'&&typeof key.os!='undefined'){maps['OS-GB']=new L.TileLayer.OSOpenSpace(key.os,{});maps['OS-GB'].options.crs=L.OSOpenSpace.getCRS();}
L.Map._maps={};var keys=Object.keys(maps).sort();for(k in keys)
L.Map._maps[keys[k]]=maps[keys[k]];}
return typeof L.Map._maps[name]!='undefined'?L.Map._maps[name]:L.Map._maps;}

/**
 * http://github.com/makinacorpus/Leaflet.FileLayer  --  leaflet.filelayer.js (3.6 kb)
 */
var FileLoader=L.Class.extend({includes:L.Mixin.Events,options:{layerOptions:{},fileSizeLimit:1024},initialize:function(map,options){this._map=map;L.Util.setOptions(this,options);this._parsers={'geojson':this._loadGeoJSON,'gpx':this._convertToGeoJSON,'kml':this._convertToGeoJSON};},load:function(file){var fileSize=(file.size / 1024).toFixed(4);if(fileSize>this.options.fileSizeLimit){this.fire('data:error',{error:new Error('File size exceeds limit ('+fileSize+' > '+this.options.fileSizeLimit+'kb)')});return;}
var ext=file.name.split('.').pop(),parser=this._parsers[ext];if(!parser){this.fire('data:error',{error:new Error('Unsupported file type '+file.type+'('+ext+')')});return;}
var reader=new FileReader();reader.onload=L.Util.bind(function(e){try{this.fire('data:loading',{filename:file.name,format:ext});var layer=parser.call(this,e.target.result,ext);this.fire('data:loaded',{layer:layer,filename:file.name,format:ext});}
catch(err){this.fire('data:error',{error:err});}},this);reader.readAsText(file);return reader;},_loadGeoJSON:function(content){if(typeof content=='string'){content=JSON.parse(content);}
var layer=L.geoJson(content,this.options.layerOptions);if(layer.getLayers().length===0){throw new Error('GeoJSON has no valid layers.');}
if(this.options.addToMap){layer.addTo(this._map);}
return layer;},_convertToGeoJSON:function(content,format){if(typeof content=='string'){content=(new window.DOMParser()).parseFromString(content,"text/xml");}
var geojson=toGeoJSON[format](content);return this._loadGeoJSON(geojson);}});L.Control.FileLayerLoad=L.Control.extend({statics:{TITLE:'Load local file (GPX, KML, GeoJSON)',LABEL:'&#8965;'},options:{position:'topleft',fitBounds:true,layerOptions:{},addToMap:true,fileSizeLimit:1024},initialize:function(options){L.Util.setOptions(this,options);this.loader=null;},onAdd:function(map){this.loader=new FileLoader(map,this.options);this.loader.on('data:loaded',function(e){if(this.options.fitBounds){window.setTimeout(function(){map.fitBounds(e.layer.getBounds());},500);}},this);this._initDragAndDrop(map);return this._initContainer();},_initDragAndDrop:function(map){var fileLoader=this.loader,dropbox=map._container;var callbacks={dragenter:function(){map.scrollWheelZoom.disable();},dragleave:function(){map.scrollWheelZoom.enable();},dragover:function(e){e.stopPropagation();e.preventDefault();},drop:function(e){e.stopPropagation();e.preventDefault();var files=Array.prototype.slice.apply(e.dataTransfer.files),i=files.length;setTimeout(function(){fileLoader.load(files.shift());if(files.length>0){setTimeout(arguments.callee,25);}},25);map.scrollWheelZoom.enable();}};for(var name in callbacks)
dropbox.addEventListener(name,callbacks[name],false);},_initContainer:function(){var zoomName='leaflet-control-filelayer leaflet-control-zoom',barName='leaflet-bar',partName=barName+'-part',container=L.DomUtil.create('div',zoomName+' '+barName);var link=L.DomUtil.create('a',zoomName+'-in '+partName,container);link.innerHTML=L.Control.FileLayerLoad.LABEL;link.href='#';link.title=L.Control.FileLayerLoad.TITLE;var fileInput=L.DomUtil.create('input','hidden',container);fileInput.type='file';if(!this.options.formats){fileInput.accept='.gpx,.kml,.geojson';}else{fileInput.accept=this.options.formats.join(',');}
fileInput.style.display='none';var fileLoader=this.loader;fileInput.addEventListener("change",function(e){fileLoader.load(this.files[0]);this.value='';},false);L.DomEvent.disableClickPropagation(link);L.DomEvent.on(link,'click',function(e){fileInput.click();e.preventDefault();});return container;}});L.Control.fileLayerLoad=function(options){return new L.Control.FileLayerLoad(options);};

/**
 * http://github.com/mapbox/togeojson  --  togeojson.js (8 kb)
 */
var toGeoJSON=(function(){'use strict';var removeSpace=/\s*/g,trimSpace=/^\s*|\s*$/g,splitSpace=/\s+/;function okhash(x){if(!x||!x.length)return 0;for(var i=0,h=0;i<x.length;i++){h=((h<<5)-h)+x.charCodeAt(i)|0;}return h;}
function get(x,y){return x.getElementsByTagName(y);}
function attr(x,y){return x.getAttribute(y);}
function attrf(x,y){return parseFloat(attr(x,y));}
function get1(x,y){var n=get(x,y);return n.length?n[0]:null;}
function norm(el){if(el.normalize){el.normalize();}return el;}
function numarray(x){for(var j=0,o=[];j<x.length;j++){o[j]=parseFloat(x[j]);}
return o;}
function clean(x){var o={};for(var i in x){if(x[i]){o[i]=x[i];}}
return o;}
function nodeVal(x){if(x){norm(x);}
return(x&&x.textContent)||'';}
function coord1(v){return numarray(v.replace(removeSpace,'').split(','));}
function coord(v){var coords=v.replace(trimSpace,'').split(splitSpace),o=[];for(var i=0;i<coords.length;i++){o.push(coord1(coords[i]));}
return o;}
function coordPair(x){var ll=[attrf(x,'lon'),attrf(x,'lat')],ele=get1(x,'ele'),heartRate=get1(x,'gpxtpx:hr')||get1(x,'hr'),time=get1(x,'time'),e;if(ele){e=parseFloat(nodeVal(ele));if(!isNaN(e)){ll.push(e);}}
return{coordinates:ll,time:time?nodeVal(time):null,heartRate:heartRate?parseFloat(nodeVal(heartRate)):null};}
function fc(){return{type:'FeatureCollection',features:[]};}
var serializer;if(typeof XMLSerializer!=='undefined'){serializer=new XMLSerializer();}else if(typeof exports==='object'&&typeof process==='object'&&!process.browser){serializer=new(require('xmldom').XMLSerializer)();}
function xml2str(str){if(str.xml!==undefined)return str.xml;return serializer.serializeToString(str);}
var t={kml:function(doc){var gj=fc(),styleIndex={},geotypes=['Polygon','LineString','Point','Track','gx:Track'],placemarks=get(doc,'Placemark'),styles=get(doc,'Style'),styleMaps=get(doc,'StyleMap');for(var k=0;k<styles.length;k++){styleIndex['#'+attr(styles[k],'id')]=okhash(xml2str(styles[k])).toString(16);}
for(var l=0;l<styleMaps.length;l++){styleIndex['#'+attr(styleMaps[l],'id')]=okhash(xml2str(styleMaps[l])).toString(16);}
for(var j=0;j<placemarks.length;j++){gj.features=gj.features.concat(getPlacemark(placemarks[j]));}
function kmlColor(v){var color,opacity;v=v||'';if(v.substr(0,1)==='#'){v=v.substr(1);}
if(v.length===6||v.length===3){color=v;}
if(v.length===8){opacity=parseInt(v.substr(0,2),16)/ 255;color='#'+v.substr(2);}
return[color,isNaN(opacity)?undefined:opacity];}
function gxCoord(v){return numarray(v.split(' '));}
function gxCoords(root){var elems=get(root,'coord','gx'),coords=[],times=[];if(elems.length===0)elems=get(root,'gx:coord');for(var i=0;i<elems.length;i++)coords.push(gxCoord(nodeVal(elems[i])));var timeElems=get(root,'when');for(var j=0;j<timeElems.length;j++)times.push(nodeVal(timeElems[j]));return{coords:coords,times:times};}
function getGeometry(root){var geomNode,geomNodes,i,j,k,geoms=[],coordTimes=[];if(get1(root,'MultiGeometry')){return getGeometry(get1(root,'MultiGeometry'));}
if(get1(root,'MultiTrack')){return getGeometry(get1(root,'MultiTrack'));}
if(get1(root,'gx:MultiTrack')){return getGeometry(get1(root,'gx:MultiTrack'));}
for(i=0;i<geotypes.length;i++){geomNodes=get(root,geotypes[i]);if(geomNodes){for(j=0;j<geomNodes.length;j++){geomNode=geomNodes[j];if(geotypes[i]==='Point'){geoms.push({type:'Point',coordinates:coord1(nodeVal(get1(geomNode,'coordinates')))});}else if(geotypes[i]==='LineString'){geoms.push({type:'LineString',coordinates:coord(nodeVal(get1(geomNode,'coordinates')))});}else if(geotypes[i]==='Polygon'){var rings=get(geomNode,'LinearRing'),coords=[];for(k=0;k<rings.length;k++){coords.push(coord(nodeVal(get1(rings[k],'coordinates'))));}
geoms.push({type:'Polygon',coordinates:coords});}else if(geotypes[i]==='Track'||geotypes[i]==='gx:Track'){var track=gxCoords(geomNode);geoms.push({type:'LineString',coordinates:track.coords});if(track.times.length)coordTimes.push(track.times);}}}}
return{geoms:geoms,coordTimes:coordTimes};}
function getPlacemark(root){var geomsAndTimes=getGeometry(root),i,properties={},name=nodeVal(get1(root,'name')),styleUrl=nodeVal(get1(root,'styleUrl')),description=nodeVal(get1(root,'description')),timeSpan=get1(root,'TimeSpan'),extendedData=get1(root,'ExtendedData'),lineStyle=get1(root,'LineStyle'),polyStyle=get1(root,'PolyStyle');if(!geomsAndTimes.geoms.length)return[];if(name)properties.name=name;if(styleUrl[0]!=='#'){styleUrl='#'+styleUrl;}
if(styleUrl&&styleIndex[styleUrl]){properties.styleUrl=styleUrl;properties.styleHash=styleIndex[styleUrl];}
if(description)properties.description=description;if(timeSpan){var begin=nodeVal(get1(timeSpan,'begin'));var end=nodeVal(get1(timeSpan,'end'));properties.timespan={begin:begin,end:end};}
if(lineStyle){var linestyles=kmlColor(nodeVal(get1(lineStyle,'color'))),color=linestyles[0],opacity=linestyles[1],width=parseFloat(nodeVal(get1(lineStyle,'width')));if(color)properties.stroke=color;if(!isNaN(opacity))properties['stroke-opacity']=opacity;if(!isNaN(width))properties['stroke-width']=width;}
if(polyStyle){var polystyles=kmlColor(nodeVal(get1(polyStyle,'color'))),pcolor=polystyles[0],popacity=polystyles[1],fill=nodeVal(get1(polyStyle,'fill')),outline=nodeVal(get1(polyStyle,'outline'));if(pcolor)properties.fill=pcolor;if(!isNaN(popacity))properties['fill-opacity']=popacity;if(fill)properties['fill-opacity']=fill==='1'?1:0;if(outline)properties['stroke-opacity']=outline==='1'?1:0;}
if(extendedData){var datas=get(extendedData,'Data'),simpleDatas=get(extendedData,'SimpleData');for(i=0;i<datas.length;i++){properties[datas[i].getAttribute('name')]=nodeVal(get1(datas[i],'value'));}
for(i=0;i<simpleDatas.length;i++){properties[simpleDatas[i].getAttribute('name')]=nodeVal(simpleDatas[i]);}}
if(geomsAndTimes.coordTimes.length){properties.coordTimes=(geomsAndTimes.coordTimes.length===1)?geomsAndTimes.coordTimes[0]:geomsAndTimes.coordTimes;}
var feature={type:'Feature',geometry:(geomsAndTimes.geoms.length===1)?geomsAndTimes.geoms[0]:{type:'GeometryCollection',geometries:geomsAndTimes.geoms},properties:properties};if(attr(root,'id'))feature.id=attr(root,'id');return[feature];}
return gj;},gpx:function(doc){var i,tracks=get(doc,'trk'),routes=get(doc,'rte'),waypoints=get(doc,'wpt'),gj=fc(),feature;for(i=0;i<tracks.length;i++){feature=getTrack(tracks[i]);if(feature)gj.features.push(feature);}
for(i=0;i<routes.length;i++){feature=getRoute(routes[i]);if(feature)gj.features.push(feature);}
for(i=0;i<waypoints.length;i++){gj.features.push(getPoint(waypoints[i]));}
function getPoints(node,pointname){var pts=get(node,pointname),line=[],times=[],heartRates=[],l=pts.length;if(l<2)return{};for(var i=0;i<l;i++){var c=coordPair(pts[i]);line.push(c.coordinates);if(c.time)times.push(c.time);if(c.heartRate)heartRates.push(c.heartRate);}
return{line:line,times:times,heartRates:heartRates};}
function getTrack(node){var segments=get(node,'trkseg'),track=[],times=[],heartRates=[],line;for(var i=0;i<segments.length;i++){line=getPoints(segments[i],'trkpt');if(line.line)track.push(line.line);if(line.times&&line.times.length)times.push(line.times);if(line.heartRates&&line.heartRates.length)heartRates.push(line.heartRates);}
if(track.length===0)return;var properties=getProperties(node);if(times.length)properties.coordTimes=track.length===1?times[0]:times;if(heartRates.length)properties.heartRates=track.length===1?heartRates[0]:heartRates;return{type:'Feature',properties:properties,geometry:{type:track.length===1?'LineString':'MultiLineString',coordinates:track.length===1?track[0]:track}};}
function getRoute(node){var line=getPoints(node,'rtept');if(!line.line)return;var routeObj={type:'Feature',properties:getProperties(node),geometry:{type:'LineString',coordinates:line.line}};return routeObj;}
function getPoint(node){var prop=getProperties(node);prop.sym=nodeVal(get1(node,'sym'));return{type:'Feature',properties:prop,geometry:{type:'Point',coordinates:coordPair(node).coordinates}};}
function getProperties(node){var meta=['name','desc','author','copyright','link','time','keywords'],prop={},k;for(k=0;k<meta.length;k++){prop[meta[k]]=nodeVal(get1(node,meta[k]));}
return clean(prop);}
return gj;}};return t;})();if(typeof module!=='undefined')module.exports=toGeoJSON;

/**
 * http://github.com/erictheise/rrose  --  rrose-src.js (3.1 kb)
 */
L.Rrose=L.Popup.extend({_initLayout:function(){var prefix='leaflet-rrose',container=this._container=L.DomUtil.create('div',prefix+' '+this.options.className+' leaflet-zoom-animated'),closeButton,wrapper;if(this.options.closeButton){closeButton=this._closeButton=L.DomUtil.create('a',prefix+'-close-button',container);closeButton.href='#close';closeButton.innerHTML='&#215;';L.DomEvent.on(closeButton,'click',this._onCloseButtonClick,this);}
var x_bound=80,y_bound=80;this.options.position='n';var y_diff=y_bound-this._map.latLngToContainerPoint(this._latlng).y;if(y_diff>0){this.options.position='s'}
var x_diff=this._map.latLngToContainerPoint(this._latlng).x-(this._map.getSize().x-x_bound);if(x_diff>0){this.options.position+='w'}else{x_diff=x_bound-this._map.latLngToContainerPoint(this._latlng).x;if(x_diff>0){this.options.position+='e'}}
if(/s/.test(this.options.position)){if(this.options.position==='s'){this._tipContainer=L.DomUtil.create('div',prefix+'-tip-container',container);wrapper=this._wrapper=L.DomUtil.create('div',prefix+'-content-wrapper',container);}
else{this._tipContainer=L.DomUtil.create('div',prefix+'-tip-container'+' '+prefix+'-tip-container-'+this.options.position,container);wrapper=this._wrapper=L.DomUtil.create('div',prefix+'-content-wrapper'+' '+prefix+'-content-wrapper-'+this.options.position,container);}
this._tip=L.DomUtil.create('div',prefix+'-tip'+' '+prefix+'-tip-'+this.options.position,this._tipContainer);L.DomEvent.disableClickPropagation(wrapper);this._contentNode=L.DomUtil.create('div',prefix+'-content',wrapper);L.DomEvent.on(this._contentNode,'mousewheel',L.DomEvent.stopPropagation);}
else{if(this.options.position==='n'){wrapper=this._wrapper=L.DomUtil.create('div',prefix+'-content-wrapper',container);this._tipContainer=L.DomUtil.create('div',prefix+'-tip-container',container);}
else{wrapper=this._wrapper=L.DomUtil.create('div',prefix+'-content-wrapper'+' '+prefix+'-content-wrapper-'+this.options.position,container);this._tipContainer=L.DomUtil.create('div',prefix+'-tip-container'+' '+prefix+'-tip-container-'+this.options.position,container);}
L.DomEvent.disableClickPropagation(wrapper);this._contentNode=L.DomUtil.create('div',prefix+'-content',wrapper);L.DomEvent.on(this._contentNode,'mousewheel',L.DomEvent.stopPropagation);this._tip=L.DomUtil.create('div',prefix+'-tip'+' '+prefix+'-tip-'+this.options.position,this._tipContainer);}},_updatePosition:function(){var pos=this._map.latLngToLayerPoint(this._latlng),is3d=L.Browser.any3d,offset=this.options.offset;if(is3d){L.DomUtil.setPosition(this._container,pos);}
if(/s/.test(this.options.position)){this._containerBottom=-this._container.offsetHeight+offset.y-(is3d?0:pos.y);}else{this._containerBottom=-offset.y-(is3d?0:pos.y);}
if(/e/.test(this.options.position)){this._containerLeft=offset.x+(is3d?0:pos.x);}
else if(/w/.test(this.options.position)){this._containerLeft=-Math.round(this._containerWidth)+offset.x+(is3d?0:pos.x);}
else{this._containerLeft=-Math.round(this._containerWidth / 2)+offset.x+(is3d?0:pos.x);}
this._container.style.bottom=this._containerBottom+'px';this._container.style.left=this._containerLeft+'px';}});

/**
 * http://github.com/Dominique92/Leaflet.GeoJSON.Ajax  --  GeoJSON.Ajax.js (3.4 kb)
 */
L.GeoJSON.Ajax=L.GeoJSON.extend({ajaxRequest:null,initialize:function(urlGeoJSON,options){if(urlGeoJSON)
options.urlGeoJSON=urlGeoJSON;L.GeoJSON.prototype.initialize.call(this,null,options);},onAdd:function(map){L.GeoJSON.prototype.onAdd.call(this,map);if(this.options.bbox)
map.on('moveend',this.reload,this);this.reload();},reload:function(argsGeoJSON){L.Util.extend(this.options.argsGeoJSON,argsGeoJSON);if(this.options.bbox&&this._map){var bounds=this._map.getBounds();if(bounds){var minll=bounds.getSouthWest();var maxll=bounds.getNorthEast();this.options.argsGeoJSON['bbox']=minll.lng+','+minll.lat+','+maxll.lng+','+maxll.lat;}}
this.args='';if(this.options.argsGeoJSON)
for(a in this.options.argsGeoJSON)
if(this.options.argsGeoJSON[a])
this.args+=(this.args?'&':'?')+a+'='+this.options.argsGeoJSON[a];if(!this.ajaxRequest){if(window.XMLHttpRequest)
this.ajaxRequest=new XMLHttpRequest();else if(window.ActiveXObject)
this.ajaxRequest=new ActiveXObject('Microsoft.XMLHTTP');else{alert('Ce navigateur ne supporte pas les requettes AJAX.');exit;}
this.ajaxRequest.context=this;}
this.url=this.options.proxy+this.options.urlGeoJSON+this.args;if(this.url==this.actual)
this.redraw(this.responseText);else{this.ajaxRequest.onreadystatechange=function(e){if(e.target.readyState==4&&e.target.status==200){e.target.context.redraw(e.target.responseText);e.target.context.actual=e.target.context.url;}}
this.ajaxRequest.open('GET',this.url,true);this.ajaxRequest.send(null);}},redraw:function(geojson){for(l in this._layers)
if(this._map)
this._map.removeLayer(this._layers[l]);try{eval('this.addData(['+geojson+'])');}catch(e){if(e instanceof SyntaxError)
alert('Json syntax error on '+this.options.urlGeoJSON+this.args+' :\n'+geojson);}
for(i in this._layers)
L.extend(this._layers[i],{_geojson:this,_ll_init:this._layers[i]._latlng});},options:{proxy:'',urlGeoJSON:null,argsGeoJSON:{},onEachFeature:function(feature,layer){if(this.icon){var icon=this.icon;if(typeof icon==='function')
icon=icon(feature);layer.setIcon(L.icon({iconUrl:icon.url,iconSize:[icon.size,icon.size],iconAnchor:[icon.size / 2,icon.size / 2],popupAnchor:[icon.size / 2,0]}));}
layer.on('mouseover mousemove',function(e){if(this._geojson&&this._geojson.options.degroup&&this._latlng.equals(this._ll_init)){var xysi=this._map.latLngToLayerPoint(this._ll_init),dm=this._geojson.options.degroup;for(p in this._geojson._layers){var point=this._geojson._layers[p];if(point._leaflet_id!=this._leaflet_id){var xypi=this._map.latLngToLayerPoint(point._ll_init),dp=xypi.distanceTo(xysi);if(!dp){xypi.x+=dm;point.setLatLng(this._map.layerPointToLatLng(xypi));}else
point.setLatLng(dp>dm?point._ll_init:[this._ll_init.lat+(point._ll_init.lat-this._ll_init.lat)*dm / dp,this._ll_init.lng+(point._ll_init.lng-this._ll_init.lng)*dm / dp]);}}}
var hover_bubble=new L.Rrose({offset:new L.Point(-1,-3),closeButton:false,autoPan:false}).setContent(feature.properties.nom).setLatLng(e.latlng).openOn(this._map);});if(typeof this.hover=='function')
layer.on('mouseover',function(e){e.target._options.hover(e.target,'in');});layer.on('mouseout',function(e){if(this._map)
this._map.closePopup();if(typeof e.target._options=='object'&&typeof e.target._options.hover=='function')
e.target._options.hover(e.target,'out');});if(typeof this.url=='function'){var url=this.url(layer);if(url)
layer.on('click',function(e){if(e.originalEvent.shiftKey||e.originalEvent.ctrlKey)
window.open(url);else
document.location.href=url;});}}}});

/**
 * http://github.com/Dominique92/MyLeaflet  --  src/MarkerPosition.js (3.7 kb)
 */
L.CRS.decimal=L.extend({},L.CRS.EPSG4326,{name:'Degrs dcimaux',format:function(v){return Math.round(v*100000)/ 100000;}});L.CRS.degminsec=L.extend({},L.CRS.decimal,{name:'Deg Min Sec',format:function(v){var d=Math.floor(Math.abs(v));var mf=(Math.abs(v)-d)*60;var m=Math.floor(mf);var s=Math.round((mf-m)*600)/ 10;if(s>=60){m++;s-=60;}
if(m>=60){d++;m-=60;}
return(v<0?'-':'')+d+''+(m<10?'0':'')+m+"'"+(s<10?'0':'')+s+'"';},unformat:function(v){va='0'+v.replace(/\s/g,'').replace(/,/g,'.').replace(/-/g,'')+'0';vs=va.replace(/'|"/g,'').split('');return(v[0]=='-'?-1:1)*(parseFloat(vs[0])+parseFloat(0+vs[1])/ 60+parseFloat(0+vs[2])/ 3600);}});L.CRS.degmin=L.extend({},L.CRS.degminsec,{name:'Deg Min',format:function(v){var d=Math.floor(Math.abs(v));var m=Math.round((Math.abs(v)-d)*60*1000)/ 1000;if(m>=60){d++;m-=60;}
return(v<0?'-':'')+d+''+(m<10?'0':'')+m+"'";}});for(var u=28;u<=35;u++)
L.CRS['EPSG326'+u]=L.extend(new L.Proj.CRS('EPSG:326'+u,'+proj=utm +zone='+u+' +ellps=WGS84 +datum=WGS84 +units=m +no_defs'),{bounds:L.bounds([6*u-186,0],[6*u-180,84]),name:'UTM '+u+'N'});L.CRS.EPSG32630.name+=' (France ouest)';L.CRS.EPSG32631.name+=' (France centre)';L.CRS.EPSG32632.name+=' (France est)';L.CRS.EPSG32633.name+=' (Autriche)';L.Marker.Position=L.Marker.extend({options:{projectionType:'decimal',prefixe:'',prefixeId:{title:'titre-',decimal:'',projette:'proj-',affiche:'aff-',select:'select-'},idll:{lat:'lat',lng:'lng',prj:'projection'}},onAdd:function(map){L.Marker.prototype.onAdd.call(this,map);for(var id in this.options.prefixeId)
for(var l in this.options.idll){this[id+l]=document.getElementById(this.options.prefixe+this.options.prefixeId[id]+this.options.idll[l]);if(this[id+l])
this[id+l].el=this;}
if(this.projettelat)
this.projettelat.onchange=function(e){this.el.affiche('lat',this.value);}
if(this.projettelng)
this.projettelng.onchange=function(e){this.el.affiche('lng',this.value);}
if(this.selectprj)
this.selectprj.onchange=function(e){this.el.options.projectionType=this.value;this.el.affiche();}
this.on('drag',function(e){this._latlng=e.target.getLatLng();this.affiche();});this.on('move',function(){this.affiche();});this.affiche();},affiche:function(coord,val){var proj=L.extend({title:{lng:'Longitude',lat:'Latitude'},format:function(v){if(v<1000)
return Math.round(v);var mm=Math.floor(v / 1000000);var m=Math.floor((v-mm*1000000)/ 1000);var u=Math.round(v-mm*1000000-m*1000);if(u>=1000){m++;u-=1000;}
if(m>=1000){mm++;m-=1000;}
return(mm==0?'':mm+' ')+(mm+m==0?'':(m<100?'0':'')+(m<10?'0':'')+m+' ')+(u<100?'0':'')+(u<10?'0':'')+u;},unformat:function(v){if(!v)
return 0;else
return v.replace(/\s/g,'').replace(/,/g,'.');}},L.CRS[this.options.projectionType]);var pp=proj.projection.project(this._latlng);var ll={lng:pp.x,lat:pp.y};if(coord){ll[coord]=proj.unformat(val);this._latlng=proj.projection.unproject(new L.Point(ll.lng,ll.lat));this.setLatLng(this._latlng);}
for(var l in this.options.idll){if(this['decimal'+l])
this['decimal'+l].value=L.CRS.decimal.format(this._latlng[l]);if(this['affiche'+l])
this['affiche'+l].innerHTML=proj.format(ll[l]);if(this['projette'+l])
this['projette'+l].value=proj.format(ll[l]);if(this['title'+l])
this['title'+l].innerHTML=proj.title[l];}
if(this.selectprj){while(this.selectprj.hasChildNodes())
this.selectprj.removeChild(this.selectprj.firstChild);var centre=new L.Point(this._latlng.lng,this._latlng.lat);for(c in L.CRS)
if(L.CRS[c]&&L.CRS[c].name&&(!L.CRS[c].bounds||L.CRS[c].bounds.contains(centre))){var option=document.createElement('option');option.value=c;if(c==this.options.projectionType)
option.selected='selected';option.appendChild(document.createTextNode(L.CRS[c].name));this.selectprj.appendChild(option);}
this.options.projectionType=this.selectprj.value;}}});

/**
 * http://github.com/Leaflet/Leaflet.draw  --  dist/leaflet.draw-src.js (51.2 kb)
 */
(function(window,document,undefined){L.drawVersion='0.2.4-dev';L.drawLocal={draw:{toolbar:{actions:{title:'Cancel drawing',text:'Cancel'},undo:{title:'Delete last point drawn',text:'Delete last point'},buttons:{polyline:'Draw a polyline',polygon:'Draw a polygon',rectangle:'Draw a rectangle',circle:'Draw a circle',marker:'Draw a marker'}},handlers:{circle:{tooltip:{start:'Click and drag to draw circle.'},radius:'Radius'},marker:{tooltip:{start:'Click map to place marker.'}},polygon:{tooltip:{start:'Click to start drawing shape.',cont:'Click to continue drawing shape.',end:'Click first point to close this shape.'}},polyline:{error:'<strong>Error:</strong> shape edges cannot cross!',tooltip:{start:'Click to start drawing line.',cont:'Click to continue drawing line.',end:'Click last point to finish line.'}},rectangle:{tooltip:{start:'Click and drag to draw rectangle.'}},simpleshape:{tooltip:{end:'Release mouse to finish drawing.'}}}},edit:{toolbar:{actions:{save:{title:'Save changes.',text:'Save'},cancel:{title:'Cancel editing, discards all changes.',text:'Cancel'}},buttons:{edit:'Edit layers.',editDisabled:'No layers to edit.',remove:'Delete layers.',removeDisabled:'No layers to delete.'}},handlers:{edit:{tooltip:{text:'Drag handles, or marker to edit feature.',subtext:'Click cancel to undo changes.'}},remove:{tooltip:{text:'Click on a feature to remove'}}}}};L.Draw={};L.Draw.Feature=L.Handler.extend({includes:L.Mixin.Events,initialize:function(map,options){this._map=map;this._container=map._container;this._overlayPane=map._panes.overlayPane;this._popupPane=map._panes.popupPane;if(options&&options.shapeOptions){options.shapeOptions=L.Util.extend({},this.options.shapeOptions,options.shapeOptions);}
L.setOptions(this,options);},enable:function(){if(this._enabled){return;}
L.Handler.prototype.enable.call(this);this.fire('enabled',{handler:this.type});this._map.fire('draw:drawstart',{layerType:this.type});},disable:function(){if(!this._enabled){return;}
L.Handler.prototype.disable.call(this);this._map.fire('draw:drawstop',{layerType:this.type});this.fire('disabled',{handler:this.type});},addHooks:function(){var map=this._map;if(map){L.DomUtil.disableTextSelection();map.getContainer().focus();this._tooltip=new L.Tooltip(this._map);L.DomEvent.on(this._container,'keyup',this._cancelDrawing,this);}},removeHooks:function(){if(this._map){L.DomUtil.enableTextSelection();this._tooltip.dispose();this._tooltip=null;L.DomEvent.off(this._container,'keyup',this._cancelDrawing,this);}},setOptions:function(options){L.setOptions(this,options);},_fireCreatedEvent:function(layer){this._map.fire('draw:created',{layer:layer,layerType:this.type});},_cancelDrawing:function(e){if(e.keyCode===27){this.disable();}}});L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:'polyline'},Poly:L.Polyline,options:{allowIntersection:true,repeatMode:false,drawError:{color:'#b00b00',timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:'leaflet-div-icon leaflet-editing-icon'}),guidelineDistance:20,maxGuideLineLength:4000,shapeOptions:{stroke:true,color:'#f06eaa',weight:4,opacity:0.5,fill:false,clickable:true},metric:true,showLength:true,zIndexOffset:2000},initialize:function(map,options){this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error;if(options&&options.drawError){options.drawError=L.Util.extend({},this.options.drawError,options.drawError);}
this.type=L.Draw.Polyline.TYPE;L.Draw.Feature.prototype.initialize.call(this,map,options);},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this);if(this._map){this._markers=[];this._markerGroup=new L.LayerGroup();this._map.addLayer(this._markerGroup);this._poly=new L.Polyline([],this.options.shapeOptions);this._tooltip.updateContent(this._getTooltipText());if(!this._mouseMarker){this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:'leaflet-mouse-marker',iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset});}
this._mouseMarker.on('mousedown',this._onMouseDown,this).addTo(this._map);this._map.on('mousemove',this._onMouseMove,this).on('mouseup',this._onMouseUp,this).on('zoomend',this._onZoomEnd,this);}},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this);this._clearHideErrorTimeout();this._cleanUpShape();this._map.removeLayer(this._markerGroup);delete this._markerGroup;delete this._markers;this._map.removeLayer(this._poly);delete this._poly;this._mouseMarker.off('mousedown',this._onMouseDown,this).off('mouseup',this._onMouseUp,this);this._map.removeLayer(this._mouseMarker);delete this._mouseMarker;this._clearGuides();this._map.off('mousemove',this._onMouseMove,this).off('zoomend',this._onZoomEnd,this);},deleteLastVertex:function(){if(this._markers.length<=1){return;}
var lastMarker=this._markers.pop(),poly=this._poly,latlng=this._poly.spliceLatLngs(poly.getLatLngs().length-1,1)[0];this._markerGroup.removeLayer(lastMarker);if(poly.getLatLngs().length<2){this._map.removeLayer(poly);}
this._vertexChanged(latlng,false);},addVertex:function(latlng){var markersLength=this._markers.length;if(markersLength>0&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(latlng)){this._showErrorTooltip();return;}
else if(this._errorShown){this._hideErrorTooltip();}
this._markers.push(this._createMarker(latlng));this._poly.addLatLng(latlng);if(this._poly.getLatLngs().length===2){this._map.addLayer(this._poly);}
this._vertexChanged(latlng,true);},_finishShape:function(){var intersects=this._poly.newLatLngIntersects(this._poly.getLatLngs()[0],true);if((!this.options.allowIntersection&&intersects)||!this._shapeIsValid()){this._showErrorTooltip();return;}
this._fireCreatedEvent();this.disable();if(this.options.repeatMode){this.enable();}},_shapeIsValid:function(){return true;},_onZoomEnd:function(){this._updateGuide();},_onMouseMove:function(e){var newPos=e.layerPoint,latlng=e.latlng;this._currentLatLng=latlng;this._updateTooltip(latlng);this._updateGuide(newPos);this._mouseMarker.setLatLng(latlng);L.DomEvent.preventDefault(e.originalEvent);},_vertexChanged:function(latlng,added){this._updateFinishHandler();this._updateRunningMeasure(latlng,added);this._clearGuides();this._updateTooltip();},_onMouseDown:function(e){var originalEvent=e.originalEvent;this._mouseDownOrigin=L.point(originalEvent.clientX,originalEvent.clientY);},_onMouseUp:function(e){if(this._mouseDownOrigin){var distance=L.point(e.originalEvent.clientX,e.originalEvent.clientY).distanceTo(this._mouseDownOrigin);if(Math.abs(distance)<9*(window.devicePixelRatio||1)){this.addVertex(e.latlng);}}
this._mouseDownOrigin=null;},_updateFinishHandler:function(){var markerCount=this._markers.length;if(markerCount>1){this._markers[markerCount-1].on('click',this._finishShape,this);}
if(markerCount>2){this._markers[markerCount-2].off('click',this._finishShape,this);}},_createMarker:function(latlng){var marker=new L.Marker(latlng,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset*2});this._markerGroup.addLayer(marker);return marker;},_updateGuide:function(newPos){var markerCount=this._markers.length;if(markerCount>0){newPos=newPos||this._map.latLngToLayerPoint(this._currentLatLng);this._clearGuides();this._drawGuide(this._map.latLngToLayerPoint(this._markers[markerCount-1].getLatLng()),newPos);}},_updateTooltip:function(latLng){var text=this._getTooltipText();if(latLng){this._tooltip.updatePosition(latLng);}
if(!this._errorShown){this._tooltip.updateContent(text);}},_drawGuide:function(pointA,pointB){var length=Math.floor(Math.sqrt(Math.pow((pointB.x-pointA.x),2)+Math.pow((pointB.y-pointA.y),2))),guidelineDistance=this.options.guidelineDistance,maxGuideLineLength=this.options.maxGuideLineLength,i=length>maxGuideLineLength?length-maxGuideLineLength:guidelineDistance,fraction,dashPoint,dash;if(!this._guidesContainer){this._guidesContainer=L.DomUtil.create('div','leaflet-draw-guides',this._overlayPane);}
for(;i<length;i+=this.options.guidelineDistance){fraction=i / length;dashPoint={x:Math.floor((pointA.x*(1-fraction))+(fraction*pointB.x)),y:Math.floor((pointA.y*(1-fraction))+(fraction*pointB.y))};dash=L.DomUtil.create('div','leaflet-draw-guide-dash',this._guidesContainer);dash.style.backgroundColor=!this._errorShown?this.options.shapeOptions.color:this.options.drawError.color;L.DomUtil.setPosition(dash,dashPoint);}},_updateGuideColor:function(color){if(this._guidesContainer){for(var i=0,l=this._guidesContainer.childNodes.length;i<l;i++){this._guidesContainer.childNodes[i].style.backgroundColor=color;}}},_clearGuides:function(){if(this._guidesContainer){while(this._guidesContainer.firstChild){this._guidesContainer.removeChild(this._guidesContainer.firstChild);}}},_getTooltipText:function(){var showLength=this.options.showLength,labelText,distanceStr;if(this._markers.length===0){labelText={text:L.drawLocal.draw.handlers.polyline.tooltip.start};}else{distanceStr=showLength?this._getMeasurementString():'';if(this._markers.length===1){labelText={text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:distanceStr};}else{labelText={text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:distanceStr};}}
return labelText;},_updateRunningMeasure:function(latlng,added){var markersLength=this._markers.length,previousMarkerIndex,distance;if(this._markers.length===1){this._measurementRunningTotal=0;}else{previousMarkerIndex=markersLength-(added?2:1);distance=latlng.distanceTo(this._markers[previousMarkerIndex].getLatLng());this._measurementRunningTotal+=distance*(added?1:-1);}},_getMeasurementString:function(){var currentLatLng=this._currentLatLng,previousLatLng=this._markers[this._markers.length-1].getLatLng(),distance;distance=this._measurementRunningTotal+currentLatLng.distanceTo(previousLatLng);return L.GeometryUtil.readableDistance(distance,this.options.metric);},_showErrorTooltip:function(){this._errorShown=true;this._tooltip.showAsError().updateContent({text:this.options.drawError.message});this._updateGuideColor(this.options.drawError.color);this._poly.setStyle({color:this.options.drawError.color});this._clearHideErrorTimeout();this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout);},_hideErrorTooltip:function(){this._errorShown=false;this._clearHideErrorTimeout();this._tooltip.removeError().updateContent(this._getTooltipText());this._updateGuideColor(this.options.shapeOptions.color);this._poly.setStyle({color:this.options.shapeOptions.color});},_clearHideErrorTimeout:function(){if(this._hideErrorTimeout){clearTimeout(this._hideErrorTimeout);this._hideErrorTimeout=null;}},_cleanUpShape:function(){if(this._markers.length>1){this._markers[this._markers.length-1].off('click',this._finishShape,this);}},_fireCreatedEvent:function(){var poly=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,poly);}});L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:'polygon'},Poly:L.Polygon,options:{showArea:false,shapeOptions:{stroke:true,color:'#f06eaa',weight:4,opacity:0.5,fill:true,fillColor:null,fillOpacity:0.2,clickable:true}},initialize:function(map,options){L.Draw.Polyline.prototype.initialize.call(this,map,options);this.type=L.Draw.Polygon.TYPE;},_updateFinishHandler:function(){var markerCount=this._markers.length;if(markerCount===1){this._markers[0].on('click',this._finishShape,this);}
if(markerCount>2){this._markers[markerCount-1].on('dblclick',this._finishShape,this);if(markerCount>3){this._markers[markerCount-2].off('dblclick',this._finishShape,this);}}},_getTooltipText:function(){var text,subtext;if(this._markers.length===0){text=L.drawLocal.draw.handlers.polygon.tooltip.start;}else if(this._markers.length<3){text=L.drawLocal.draw.handlers.polygon.tooltip.cont;}else{text=L.drawLocal.draw.handlers.polygon.tooltip.end;subtext=this._getMeasurementString();}
return{text:text,subtext:subtext};},_getMeasurementString:function(){var area=this._area;if(!area){return null;}
return L.GeometryUtil.readableArea(area,this.options.metric);},_shapeIsValid:function(){return this._markers.length>=3;},_vertexChanged:function(latlng,added){var latLngs;if(!this.options.allowIntersection&&this.options.showArea){latLngs=this._poly.getLatLngs();this._area=L.GeometryUtil.geodesicArea(latLngs);}
L.Draw.Polyline.prototype._vertexChanged.call(this,latlng,added);},_cleanUpShape:function(){var markerCount=this._markers.length;if(markerCount>0){this._markers[0].off('click',this._finishShape,this);if(markerCount>2){this._markers[markerCount-1].off('dblclick',this._finishShape,this);}}}});L.SimpleShape={};L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:false},initialize:function(map,options){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end;L.Draw.Feature.prototype.initialize.call(this,map,options);},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this);if(this._map){this._mapDraggable=this._map.dragging.enabled();if(this._mapDraggable){this._map.dragging.disable();}
this._container.style.cursor='crosshair';this._tooltip.updateContent({text:this._initialLabelText});this._map.on('mousedown',this._onMouseDown,this).on('mousemove',this._onMouseMove,this);}},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this);if(this._map){if(this._mapDraggable){this._map.dragging.enable();}
this._container.style.cursor='';this._map.off('mousedown',this._onMouseDown,this).off('mousemove',this._onMouseMove,this);L.DomEvent.off(document,'mouseup',this._onMouseUp,this);if(this._shape){this._map.removeLayer(this._shape);delete this._shape;}}
this._isDrawing=false;},_getTooltipText:function(){return{text:this._endLabelText};},_onMouseDown:function(e){this._isDrawing=true;this._startLatLng=e.latlng;L.DomEvent.on(document,'mouseup',this._onMouseUp,this).preventDefault(e.originalEvent);},_onMouseMove:function(e){var latlng=e.latlng;this._tooltip.updatePosition(latlng);if(this._isDrawing){this._tooltip.updateContent(this._getTooltipText());this._drawShape(latlng);}},_onMouseUp:function(){if(this._shape){this._fireCreatedEvent();}
this.disable();if(this.options.repeatMode){this.enable();}}});L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:'rectangle'},options:{shapeOptions:{stroke:true,color:'#f06eaa',weight:4,opacity:0.5,fill:true,fillColor:null,fillOpacity:0.2,clickable:true},metric:true},initialize:function(map,options){this.type=L.Draw.Rectangle.TYPE;this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start;L.Draw.SimpleShape.prototype.initialize.call(this,map,options);},_drawShape:function(latlng){if(!this._shape){this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,latlng),this.options.shapeOptions);this._map.addLayer(this._shape);}else{this._shape.setBounds(new L.LatLngBounds(this._startLatLng,latlng));}},_fireCreatedEvent:function(){var rectangle=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,rectangle);},_getTooltipText:function(){var tooltipText=L.Draw.SimpleShape.prototype._getTooltipText.call(this),shape=this._shape,latLngs,area,subtext;if(shape){latLngs=this._shape.getLatLngs();area=L.GeometryUtil.geodesicArea(latLngs);subtext=L.GeometryUtil.readableArea(area,this.options.metric);}
return{text:tooltipText.text,subtext:subtext};}});L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:'circle'},options:{shapeOptions:{stroke:true,color:'#f06eaa',weight:4,opacity:0.5,fill:true,fillColor:null,fillOpacity:0.2,clickable:true},showRadius:true,metric:true},initialize:function(map,options){this.type=L.Draw.Circle.TYPE;this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start;L.Draw.SimpleShape.prototype.initialize.call(this,map,options);},_drawShape:function(latlng){if(!this._shape){this._shape=new L.Circle(this._startLatLng,this._startLatLng.distanceTo(latlng),this.options.shapeOptions);this._map.addLayer(this._shape);}else{this._shape.setRadius(this._startLatLng.distanceTo(latlng));}},_fireCreatedEvent:function(){var circle=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,circle);},_onMouseMove:function(e){var latlng=e.latlng,showRadius=this.options.showRadius,useMetric=this.options.metric,radius;this._tooltip.updatePosition(latlng);if(this._isDrawing){this._drawShape(latlng);radius=this._shape.getRadius().toFixed(1);this._tooltip.updateContent({text:this._endLabelText,subtext:showRadius?L.drawLocal.draw.handlers.circle.radius+': '+L.GeometryUtil.readableDistance(radius,useMetric):''});}}});L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:'marker'},options:{icon:new L.Icon.Default(),repeatMode:false,zIndexOffset:2000},initialize:function(map,options){this.type=L.Draw.Marker.TYPE;L.Draw.Feature.prototype.initialize.call(this,map,options);},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this);if(this._map){this._tooltip.updateContent({text:L.drawLocal.draw.handlers.marker.tooltip.start});if(!this._mouseMarker){this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:'leaflet-mouse-marker',iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset});}
this._mouseMarker.on('click',this._onClick,this).addTo(this._map);this._map.on('mousemove',this._onMouseMove,this);}},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this);if(this._map){if(this._marker){this._marker.off('click',this._onClick,this);this._map.off('click',this._onClick,this).removeLayer(this._marker);delete this._marker;}
this._mouseMarker.off('click',this._onClick,this);this._map.removeLayer(this._mouseMarker);delete this._mouseMarker;this._map.off('mousemove',this._onMouseMove,this);}},_onMouseMove:function(e){var latlng=e.latlng;this._tooltip.updatePosition(latlng);this._mouseMarker.setLatLng(latlng);if(!this._marker){this._marker=new L.Marker(latlng,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset});this._marker.on('click',this._onClick,this);this._map.on('click',this._onClick,this).addLayer(this._marker);}
else{latlng=this._mouseMarker.getLatLng();this._marker.setLatLng(latlng);}},_onClick:function(){this._fireCreatedEvent();this.disable();if(this.options.repeatMode){this.enable();}},_fireCreatedEvent:function(){var marker=new L.Marker(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,marker);}});L.Edit=L.Edit||{};L.Edit.Marker=L.Handler.extend({initialize:function(marker,options){this._marker=marker;L.setOptions(this,options);},addHooks:function(){var marker=this._marker;marker.dragging.enable();marker.on('dragend',this._onDragEnd,marker);this._toggleMarkerHighlight();},removeHooks:function(){var marker=this._marker;marker.dragging.disable();marker.off('dragend',this._onDragEnd,marker);this._toggleMarkerHighlight();},_onDragEnd:function(e){var layer=e.target;layer.edited=true;},_toggleMarkerHighlight:function(){if(!this._icon){return;}
var icon=this._icon;icon.style.display='none';if(L.DomUtil.hasClass(icon,'leaflet-edit-marker-selected')){L.DomUtil.removeClass(icon,'leaflet-edit-marker-selected');this._offsetMarker(icon,-4);}else{L.DomUtil.addClass(icon,'leaflet-edit-marker-selected');this._offsetMarker(icon,4);}
icon.style.display='';},_offsetMarker:function(icon,offset){var iconMarginTop=parseInt(icon.style.marginTop,10)-offset,iconMarginLeft=parseInt(icon.style.marginLeft,10)-offset;icon.style.marginTop=iconMarginTop+'px';icon.style.marginLeft=iconMarginLeft+'px';}});L.Marker.addInitHook(function(){if(L.Edit.Marker){this.editing=new L.Edit.Marker(this);if(this.options.editable){this.editing.enable();}}});L.Edit=L.Edit||{};L.Edit.Poly=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:'leaflet-div-icon leaflet-editing-icon'})},initialize:function(poly,options){this._poly=poly;L.setOptions(this,options);},addHooks:function(){var poly=this._poly;if(!(poly instanceof L.Polygon)){poly.options.editing.fill=false;}
poly.setStyle(poly.options.editing);if(this._poly._map){if(!this._markerGroup){this._initMarkers();}
this._poly._map.addLayer(this._markerGroup);}},removeHooks:function(){var poly=this._poly;poly.setStyle(poly.options.original);if(poly._map){poly._map.removeLayer(this._markerGroup);delete this._markerGroup;delete this._markers;}},updateMarkers:function(){this._markerGroup.clearLayers();this._initMarkers();},_initMarkers:function(){if(!this._markerGroup){this._markerGroup=new L.LayerGroup();}
this._markers=[];var latlngs=this._poly._latlngs,i,j,len,marker;for(i=0,len=latlngs.length;i<len;i++){marker=this._createMarker(latlngs[i],i);marker.on('click',this._onMarkerClick,this);this._markers.push(marker);}
var markerLeft,markerRight;for(i=0,j=len-1;i<len;j=i++){if(i===0&&!(L.Polygon&&(this._poly instanceof L.Polygon))){continue;}
markerLeft=this._markers[j];markerRight=this._markers[i];this._createMiddleMarker(markerLeft,markerRight);this._updatePrevNext(markerLeft,markerRight);}},_createMarker:function(latlng,index){var marker=new L.Marker(latlng,{draggable:true,icon:this.options.icon});marker._origLatLng=latlng;marker._index=index;marker.on('drag',this._onMarkerDrag,this);marker.on('dragend',this._fireEdit,this);this._markerGroup.addLayer(marker);return marker;},_removeMarker:function(marker){var i=marker._index;this._markerGroup.removeLayer(marker);this._markers.splice(i,1);this._poly.spliceLatLngs(i,1);this._updateIndexes(i,-1);marker.off('drag',this._onMarkerDrag,this).off('dragend',this._fireEdit,this).off('click',this._onMarkerClick,this);},_fireEdit:function(){this._poly.edited=true;this._poly.fire('edit');},_onMarkerDrag:function(e){var marker=e.target;L.extend(marker._origLatLng,marker._latlng);if(marker._middleLeft){marker._middleLeft.setLatLng(this._getMiddleLatLng(marker._prev,marker));}
if(marker._middleRight){marker._middleRight.setLatLng(this._getMiddleLatLng(marker,marker._next));}
this._poly.redraw();},_onMarkerClick:function(e){var minPoints=L.Polygon&&(this._poly instanceof L.Polygon)?4:3,marker=e.target;if(this._poly._latlngs.length<minPoints){return;}
this._removeMarker(marker);this._updatePrevNext(marker._prev,marker._next);if(marker._middleLeft){this._markerGroup.removeLayer(marker._middleLeft);}
if(marker._middleRight){this._markerGroup.removeLayer(marker._middleRight);}
if(marker._prev&&marker._next){this._createMiddleMarker(marker._prev,marker._next);}else if(!marker._prev){marker._next._middleLeft=null;}else if(!marker._next){marker._prev._middleRight=null;}
this._fireEdit();},_updateIndexes:function(index,delta){this._markerGroup.eachLayer(function(marker){if(marker._index>index){marker._index+=delta;}});},_createMiddleMarker:function(marker1,marker2){var latlng=this._getMiddleLatLng(marker1,marker2),marker=this._createMarker(latlng),onClick,onDragStart,onDragEnd;marker.setOpacity(0.6);marker1._middleRight=marker2._middleLeft=marker;onDragStart=function(){var i=marker2._index;marker._index=i;marker.off('click',onClick,this).on('click',this._onMarkerClick,this);latlng.lat=marker.getLatLng().lat;latlng.lng=marker.getLatLng().lng;this._poly.spliceLatLngs(i,0,latlng);this._markers.splice(i,0,marker);marker.setOpacity(1);this._updateIndexes(i,1);marker2._index++;this._updatePrevNext(marker1,marker);this._updatePrevNext(marker,marker2);this._poly.fire('editstart');};onDragEnd=function(){marker.off('dragstart',onDragStart,this);marker.off('dragend',onDragEnd,this);this._createMiddleMarker(marker1,marker);this._createMiddleMarker(marker,marker2);};onClick=function(){onDragStart.call(this);onDragEnd.call(this);this._fireEdit();};marker.on('dragstart',onDragStart,this).on('dragend',onDragEnd,this);this._markerGroup.addLayer(marker);},_updatePrevNext:function(marker1,marker2){if(marker1){marker1._next=marker2;}
if(marker2){marker2._prev=marker1;}},_getMiddleLatLng:function(marker1,marker2){var map=this._poly._map,p1=map.project(marker1.getLatLng()),p2=map.project(marker2.getLatLng());return map.unproject(p1._add(p2)._divideBy(2));}});L.Polyline.addInitHook(function(){if(this.editing){return;}
if(L.Edit.Poly){this.editing=new L.Edit.Poly(this);if(this.options.editable){this.editing.enable();}}
this.on('add',function(){if(this.editing&&this.editing.enabled()){this.editing.addHooks();}});this.on('remove',function(){if(this.editing&&this.editing.enabled()){this.editing.removeHooks();}});});L.Edit=L.Edit||{};L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:'leaflet-div-icon leaflet-editing-icon leaflet-edit-move'}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:'leaflet-div-icon leaflet-editing-icon leaflet-edit-resize'})},initialize:function(shape,options){this._shape=shape;L.Util.setOptions(this,options);},addHooks:function(){var shape=this._shape;shape.setStyle(shape.options.editing);if(shape._map){this._map=shape._map;if(!this._markerGroup){this._initMarkers();}
this._map.addLayer(this._markerGroup);}},removeHooks:function(){var shape=this._shape;shape.setStyle(shape.options.original);if(shape._map){this._unbindMarker(this._moveMarker);for(var i=0,l=this._resizeMarkers.length;i<l;i++){this._unbindMarker(this._resizeMarkers[i]);}
this._resizeMarkers=null;this._map.removeLayer(this._markerGroup);delete this._markerGroup;}
this._map=null;},updateMarkers:function(){this._markerGroup.clearLayers();this._initMarkers();},_initMarkers:function(){if(!this._markerGroup){this._markerGroup=new L.LayerGroup();}
this._createMoveMarker();this._createResizeMarker();},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(latlng,icon){var marker=new L.Marker(latlng,{draggable:true,icon:icon,zIndexOffset:10});this._bindMarker(marker);this._markerGroup.addLayer(marker);return marker;},_bindMarker:function(marker){marker.on('dragstart',this._onMarkerDragStart,this).on('drag',this._onMarkerDrag,this).on('dragend',this._onMarkerDragEnd,this);},_unbindMarker:function(marker){marker.off('dragstart',this._onMarkerDragStart,this).off('drag',this._onMarkerDrag,this).off('dragend',this._onMarkerDragEnd,this);},_onMarkerDragStart:function(e){var marker=e.target;marker.setOpacity(0);this._shape.fire('editstart');},_fireEdit:function(){this._shape.edited=true;this._shape.fire('edit');},_onMarkerDrag:function(e){var marker=e.target,latlng=marker.getLatLng();if(marker===this._moveMarker){this._move(latlng);}else{this._resize(latlng);}
this._shape.redraw();},_onMarkerDragEnd:function(e){var marker=e.target;marker.setOpacity(1);this._fireEdit();},_move:function(){},_resize:function(){}});L.Edit=L.Edit||{};L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var bounds=this._shape.getBounds(),center=bounds.getCenter();this._moveMarker=this._createMarker(center,this.options.moveIcon);},_createResizeMarker:function(){var corners=this._getCorners();this._resizeMarkers=[];for(var i=0,l=corners.length;i<l;i++){this._resizeMarkers.push(this._createMarker(corners[i],this.options.resizeIcon));this._resizeMarkers[i]._cornerIndex=i;}},_onMarkerDragStart:function(e){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,e);var corners=this._getCorners(),marker=e.target,currentCornerIndex=marker._cornerIndex;this._oppositeCorner=corners[(currentCornerIndex+2)%4];this._toggleCornerMarkers(0,currentCornerIndex);},_onMarkerDragEnd:function(e){var marker=e.target,bounds,center;if(marker===this._moveMarker){bounds=this._shape.getBounds();center=bounds.getCenter();marker.setLatLng(center);}
this._toggleCornerMarkers(1);this._repositionCornerMarkers();L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,e);},_move:function(newCenter){var latlngs=this._shape.getLatLngs(),bounds=this._shape.getBounds(),center=bounds.getCenter(),offset,newLatLngs=[];for(var i=0,l=latlngs.length;i<l;i++){offset=[latlngs[i].lat-center.lat,latlngs[i].lng-center.lng];newLatLngs.push([newCenter.lat+offset[0],newCenter.lng+offset[1]]);}
this._shape.setLatLngs(newLatLngs);this._repositionCornerMarkers();},_resize:function(latlng){var bounds;this._shape.setBounds(L.latLngBounds(latlng,this._oppositeCorner));bounds=this._shape.getBounds();this._moveMarker.setLatLng(bounds.getCenter());},_getCorners:function(){var bounds=this._shape.getBounds(),nw=bounds.getNorthWest(),ne=bounds.getNorthEast(),se=bounds.getSouthEast(),sw=bounds.getSouthWest();return[nw,ne,se,sw];},_toggleCornerMarkers:function(opacity){for(var i=0,l=this._resizeMarkers.length;i<l;i++){this._resizeMarkers[i].setOpacity(opacity);}},_repositionCornerMarkers:function(){var corners=this._getCorners();for(var i=0,l=this._resizeMarkers.length;i<l;i++){this._resizeMarkers[i].setLatLng(corners[i]);}}});L.Rectangle.addInitHook(function(){if(L.Edit.Rectangle){this.editing=new L.Edit.Rectangle(this);if(this.options.editable){this.editing.enable();}}});L.Edit=L.Edit||{};L.Edit.Circle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var center=this._shape.getLatLng();this._moveMarker=this._createMarker(center,this.options.moveIcon);},_createResizeMarker:function(){var center=this._shape.getLatLng(),resizemarkerPoint=this._getResizeMarkerPoint(center);this._resizeMarkers=[];this._resizeMarkers.push(this._createMarker(resizemarkerPoint,this.options.resizeIcon));},_getResizeMarkerPoint:function(latlng){var delta=this._shape._radius*Math.cos(Math.PI / 4),point=this._map.project(latlng);return this._map.unproject([point.x+delta,point.y-delta]);},_move:function(latlng){var resizemarkerPoint=this._getResizeMarkerPoint(latlng);this._resizeMarkers[0].setLatLng(resizemarkerPoint);this._shape.setLatLng(latlng);},_resize:function(latlng){var moveLatLng=this._moveMarker.getLatLng(),radius=moveLatLng.distanceTo(latlng);this._shape.setRadius(radius);}});L.Circle.addInitHook(function(){if(L.Edit.Circle){this.editing=new L.Edit.Circle(this);if(this.options.editable){this.editing.enable();}}
this.on('add',function(){if(this.editing&&this.editing.enabled()){this.editing.addHooks();}});this.on('remove',function(){if(this.editing&&this.editing.enabled()){this.editing.removeHooks();}});});L.LatLngUtil={cloneLatLngs:function(latlngs){var clone=[];for(var i=0,l=latlngs.length;i<l;i++){clone.push(this.cloneLatLng(latlngs[i]));}
return clone;},cloneLatLng:function(latlng){return L.latLng(latlng.lat,latlng.lng);}};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(latLngs){var pointsCount=latLngs.length,area=0.0,d2r=L.LatLng.DEG_TO_RAD,p1,p2;if(pointsCount>2){for(var i=0;i<pointsCount;i++){p1=latLngs[i];p2=latLngs[(i+1)%pointsCount];area+=((p2.lng-p1.lng)*d2r)*(2+Math.sin(p1.lat*d2r)+Math.sin(p2.lat*d2r));}
area=area*6378137.0*6378137.0 / 2.0;}
return Math.abs(area);},readableArea:function(area,isMetric){var areaStr;if(isMetric){if(area>=10000){areaStr=(area*0.0001).toFixed(2)+' ha';}else{areaStr=area.toFixed(2)+' m&sup2;';}}else{area /=0.836127;if(area>=3097600){areaStr=(area / 3097600).toFixed(2)+' mi&sup2;';}else if(area>=4840){areaStr=(area / 4840).toFixed(2)+' acres';}else{areaStr=Math.ceil(area)+' yd&sup2;';}}
return areaStr;},readableDistance:function(distance,isMetric){var distanceStr;if(isMetric){if(distance>1000){distanceStr=(distance / 1000).toFixed(2)+' km';}else{distanceStr=Math.ceil(distance)+' m';}}else{distance*=1.09361;if(distance>1760){distanceStr=(distance / 1760).toFixed(2)+' miles';}else{distanceStr=Math.ceil(distance)+' yd';}}
return distanceStr;}});L.Util.extend(L.LineUtil,{segmentsIntersect:function(p,p1,p2,p3){return this._checkCounterclockwise(p,p2,p3)!==this._checkCounterclockwise(p1,p2,p3)&&this._checkCounterclockwise(p,p1,p2)!==this._checkCounterclockwise(p,p1,p3);},_checkCounterclockwise:function(p,p1,p2){return(p2.y-p.y)*(p1.x-p.x)>(p1.y-p.y)*(p2.x-p.x);}});L.Polyline.include({intersects:function(){var points=this._originalPoints,len=points?points.length:0,i,p,p1;if(this._tooFewPointsForIntersection()){return false;}
for(i=len-1;i>=3;i--){p=points[i-1];p1=points[i];if(this._lineSegmentsIntersectsRange(p,p1,i-2)){return true;}}
return false;},newLatLngIntersects:function(latlng,skipFirst){if(!this._map){return false;}
return this.newPointIntersects(this._map.latLngToLayerPoint(latlng),skipFirst);},newPointIntersects:function(newPoint,skipFirst){var points=this._originalPoints,len=points?points.length:0,lastPoint=points?points[len-1]:null,maxIndex=len-2;if(this._tooFewPointsForIntersection(1)){return false;}
return this._lineSegmentsIntersectsRange(lastPoint,newPoint,maxIndex,skipFirst?1:0);},_tooFewPointsForIntersection:function(extraPoints){var points=this._originalPoints,len=points?points.length:0;len+=extraPoints||0;return!this._originalPoints||len<=3;},_lineSegmentsIntersectsRange:function(p,p1,maxIndex,minIndex){var points=this._originalPoints,p2,p3;minIndex=minIndex||0;for(var j=maxIndex;j>minIndex;j--){p2=points[j-1];p3=points[j];if(L.LineUtil.segmentsIntersect(p,p1,p2,p3)){return true;}}
return false;}});L.Polygon.include({intersects:function(){var polylineIntersects,points=this._originalPoints,len,firstPoint,lastPoint,maxIndex;if(this._tooFewPointsForIntersection()){return false;}
polylineIntersects=L.Polyline.prototype.intersects.call(this);if(polylineIntersects){return true;}
len=points.length;firstPoint=points[0];lastPoint=points[len-1];maxIndex=len-2;return this._lineSegmentsIntersectsRange(lastPoint,firstPoint,maxIndex,1);}});L.Control.Draw=L.Control.extend({options:{position:'topleft',draw:{},edit:false},initialize:function(options){if(L.version<'0.7'){throw new Error('Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/');}
L.Control.prototype.initialize.call(this,options);var toolbar;this._toolbars={};if(L.DrawToolbar&&this.options.draw){toolbar=new L.DrawToolbar(this.options.draw);this._toolbars[L.DrawToolbar.TYPE]=toolbar;this._toolbars[L.DrawToolbar.TYPE].on('enable',this._toolbarEnabled,this);}
if(L.EditToolbar&&this.options.edit){toolbar=new L.EditToolbar(this.options.edit);this._toolbars[L.EditToolbar.TYPE]=toolbar;this._toolbars[L.EditToolbar.TYPE].on('enable',this._toolbarEnabled,this);}},onAdd:function(map){var container=L.DomUtil.create('div','leaflet-draw'),addedTopClass=false,topClassName='leaflet-draw-toolbar-top',toolbarContainer;for(var toolbarId in this._toolbars){if(this._toolbars.hasOwnProperty(toolbarId)){toolbarContainer=this._toolbars[toolbarId].addToolbar(map);if(toolbarContainer){if(!addedTopClass){if(!L.DomUtil.hasClass(toolbarContainer,topClassName)){L.DomUtil.addClass(toolbarContainer.childNodes[0],topClassName);}
addedTopClass=true;}
container.appendChild(toolbarContainer);}}}
return container;},onRemove:function(){for(var toolbarId in this._toolbars){if(this._toolbars.hasOwnProperty(toolbarId)){this._toolbars[toolbarId].removeToolbar();}}},setDrawingOptions:function(options){for(var toolbarId in this._toolbars){if(this._toolbars[toolbarId]instanceof L.DrawToolbar){this._toolbars[toolbarId].setOptions(options);}}},_toolbarEnabled:function(e){var enabledToolbar=e.target;for(var toolbarId in this._toolbars){if(this._toolbars[toolbarId]!==enabledToolbar){this._toolbars[toolbarId].disable();}}}});L.Map.mergeOptions({drawControlTooltips:true,drawControl:false});L.Map.addInitHook(function(){if(this.options.drawControl){this.drawControl=new L.Control.Draw();this.addControl(this.drawControl);}});L.Toolbar=L.Class.extend({includes:[L.Mixin.Events],initialize:function(options){L.setOptions(this,options);this._modes={};this._actionButtons=[];this._activeMode=null;},enabled:function(){return this._activeMode!==null;},disable:function(){if(!this.enabled()){return;}
this._activeMode.handler.disable();},addToolbar:function(map){var container=L.DomUtil.create('div','leaflet-draw-section'),buttonIndex=0,buttonClassPrefix=this._toolbarClass||'',modeHandlers=this.getModeHandlers(map),i;this._toolbarContainer=L.DomUtil.create('div','leaflet-draw-toolbar leaflet-bar');this._map=map;for(i=0;i<modeHandlers.length;i++){if(modeHandlers[i].enabled){this._initModeHandler(modeHandlers[i].handler,this._toolbarContainer,buttonIndex++,buttonClassPrefix,modeHandlers[i].title);}}
if(!buttonIndex){return;}
this._lastButtonIndex=--buttonIndex;this._actionsContainer=L.DomUtil.create('ul','leaflet-draw-actions');container.appendChild(this._toolbarContainer);container.appendChild(this._actionsContainer);return container;},removeToolbar:function(){for(var handlerId in this._modes){if(this._modes.hasOwnProperty(handlerId)){this._disposeButton(this._modes[handlerId].button,this._modes[handlerId].handler.enable,this._modes[handlerId].handler);this._modes[handlerId].handler.disable();this._modes[handlerId].handler.off('enabled',this._handlerActivated,this).off('disabled',this._handlerDeactivated,this);}}
this._modes={};for(var i=0,l=this._actionButtons.length;i<l;i++){this._disposeButton(this._actionButtons[i].button,this._actionButtons[i].callback,this);}
this._actionButtons=[];this._actionsContainer=null;},_initModeHandler:function(handler,container,buttonIndex,classNamePredix,buttonTitle){var type=handler.type;this._modes[type]={};this._modes[type].handler=handler;this._modes[type].button=this._createButton({title:buttonTitle,className:classNamePredix+'-'+type,container:container,callback:this._modes[type].handler.enable,context:this._modes[type].handler});this._modes[type].buttonIndex=buttonIndex;this._modes[type].handler.on('enabled',this._handlerActivated,this).on('disabled',this._handlerDeactivated,this);},_createButton:function(options){var link=L.DomUtil.create('a',options.className||'',options.container);link.href='#';if(options.text){link.innerHTML=options.text;}
if(options.title){link.title=options.title;}
L.DomEvent.on(link,'click',L.DomEvent.stopPropagation).on(link,'mousedown',L.DomEvent.stopPropagation).on(link,'dblclick',L.DomEvent.stopPropagation).on(link,'click',L.DomEvent.preventDefault).on(link,'click',options.callback,options.context);return link;},_disposeButton:function(button,callback){L.DomEvent.off(button,'click',L.DomEvent.stopPropagation).off(button,'mousedown',L.DomEvent.stopPropagation).off(button,'dblclick',L.DomEvent.stopPropagation).off(button,'click',L.DomEvent.preventDefault).off(button,'click',callback);},_handlerActivated:function(e){this.disable();this._activeMode=this._modes[e.handler];L.DomUtil.addClass(this._activeMode.button,'leaflet-draw-toolbar-button-enabled');this._showActionsToolbar();this.fire('enable');},_handlerDeactivated:function(){this._hideActionsToolbar();L.DomUtil.removeClass(this._activeMode.button,'leaflet-draw-toolbar-button-enabled');this._activeMode=null;this.fire('disable');},_createActions:function(handler){var container=this._actionsContainer,buttons=this.getActions(handler),l=buttons.length,li,di,dl,button;for(di=0,dl=this._actionButtons.length;di<dl;di++){this._disposeButton(this._actionButtons[di].button,this._actionButtons[di].callback);}
this._actionButtons=[];while(container.firstChild){container.removeChild(container.firstChild);}
for(var i=0;i<l;i++){if('enabled'in buttons[i]&&!buttons[i].enabled){continue;}
li=L.DomUtil.create('li','',container);button=this._createButton({title:buttons[i].title,text:buttons[i].text,container:li,callback:buttons[i].callback,context:buttons[i].context});this._actionButtons.push({button:button,callback:buttons[i].callback});}},_showActionsToolbar:function(){var buttonIndex=this._activeMode.buttonIndex,lastButtonIndex=this._lastButtonIndex,toolbarPosition=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler);this._actionsContainer.style.top=toolbarPosition+'px';if(buttonIndex===0){L.DomUtil.addClass(this._toolbarContainer,'leaflet-draw-toolbar-notop');L.DomUtil.addClass(this._actionsContainer,'leaflet-draw-actions-top');}
if(buttonIndex===lastButtonIndex){L.DomUtil.addClass(this._toolbarContainer,'leaflet-draw-toolbar-nobottom');L.DomUtil.addClass(this._actionsContainer,'leaflet-draw-actions-bottom');}
this._actionsContainer.style.display='block';},_hideActionsToolbar:function(){this._actionsContainer.style.display='none';L.DomUtil.removeClass(this._toolbarContainer,'leaflet-draw-toolbar-notop');L.DomUtil.removeClass(this._toolbarContainer,'leaflet-draw-toolbar-nobottom');L.DomUtil.removeClass(this._actionsContainer,'leaflet-draw-actions-top');L.DomUtil.removeClass(this._actionsContainer,'leaflet-draw-actions-bottom');}});L.Tooltip=L.Class.extend({initialize:function(map){this._map=map;this._popupPane=map._panes.popupPane;this._container=map.options.drawControlTooltips?L.DomUtil.create('div','leaflet-draw-tooltip',this._popupPane):null;this._singleLineLabel=false;},dispose:function(){if(this._container){this._popupPane.removeChild(this._container);this._container=null;}},updateContent:function(labelText){if(!this._container){return this;}
labelText.subtext=labelText.subtext||'';if(labelText.subtext.length===0&&!this._singleLineLabel){L.DomUtil.addClass(this._container,'leaflet-draw-tooltip-single');this._singleLineLabel=true;}
else if(labelText.subtext.length>0&&this._singleLineLabel){L.DomUtil.removeClass(this._container,'leaflet-draw-tooltip-single');this._singleLineLabel=false;}
this._container.innerHTML=(labelText.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+labelText.subtext+'</span>'+'<br />':'')+'<span>'+labelText.text+'</span>';return this;},updatePosition:function(latlng){var pos=this._map.latLngToLayerPoint(latlng),tooltipContainer=this._container;if(this._container){tooltipContainer.style.visibility='inherit';L.DomUtil.setPosition(tooltipContainer,pos);}
return this;},showAsError:function(){if(this._container){L.DomUtil.addClass(this._container,'leaflet-error-draw-tooltip');}
return this;},removeError:function(){if(this._container){L.DomUtil.removeClass(this._container,'leaflet-error-draw-tooltip');}
return this;}});L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:'draw'},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{}},initialize:function(options){for(var type in this.options){if(this.options.hasOwnProperty(type)){if(options[type]){options[type]=L.extend({},this.options[type],options[type]);}}}
this._toolbarClass='leaflet-draw-draw';L.Toolbar.prototype.initialize.call(this,options);},getModeHandlers:function(map){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(map,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(map,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(map,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(map,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(map,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker}];},getActions:function(handler){return[{enabled:handler.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:handler.deleteLastVertex,context:handler},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}];},setOptions:function(options){L.setOptions(this,options);for(var type in this._modes){if(this._modes.hasOwnProperty(type)&&options.hasOwnProperty(type)){this._modes[type].handler.setOptions(options[type]);}}}});L.EditToolbar=L.Toolbar.extend({statics:{TYPE:'edit'},options:{edit:{selectedPathOptions:{color:'#fe57a1',opacity:0.6,dashArray:'10, 10',fill:true,fillColor:'#fe57a1',fillOpacity:0.1,maintainColor:false}},remove:{},featureGroup:null},initialize:function(options){if(options.edit){if(typeof options.edit.selectedPathOptions==='undefined'){options.edit.selectedPathOptions=this.options.edit.selectedPathOptions;}
options.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,options.edit.selectedPathOptions);}
if(options.remove){options.remove=L.extend({},this.options.remove,options.remove);}
this._toolbarClass='leaflet-draw-edit';L.Toolbar.prototype.initialize.call(this,options);this._selectedFeatureCount=0;},getModeHandlers:function(map){var featureGroup=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(map,{featureGroup:featureGroup,selectedPathOptions:this.options.edit.selectedPathOptions}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(map,{featureGroup:featureGroup}),title:L.drawLocal.edit.toolbar.buttons.remove}];},getActions:function(){return[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];},addToolbar:function(map){var container=L.Toolbar.prototype.addToolbar.call(this,map);this._checkDisabled();this.options.featureGroup.on('layeradd layerremove',this._checkDisabled,this);return container;},removeToolbar:function(){this.options.featureGroup.off('layeradd layerremove',this._checkDisabled,this);L.Toolbar.prototype.removeToolbar.call(this);},disable:function(){if(!this.enabled()){return;}
this._activeMode.handler.revertLayers();L.Toolbar.prototype.disable.call(this);},_save:function(){this._activeMode.handler.save();this._activeMode.handler.disable();},_checkDisabled:function(){var featureGroup=this.options.featureGroup,hasLayers=featureGroup.getLayers().length!==0,button;if(this.options.edit){button=this._modes[L.EditToolbar.Edit.TYPE].button;if(hasLayers){L.DomUtil.removeClass(button,'leaflet-disabled');}else{L.DomUtil.addClass(button,'leaflet-disabled');}
button.setAttribute('title',hasLayers?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled);}
if(this.options.remove){button=this._modes[L.EditToolbar.Delete.TYPE].button;if(hasLayers){L.DomUtil.removeClass(button,'leaflet-disabled');}else{L.DomUtil.addClass(button,'leaflet-disabled');}
button.setAttribute('title',hasLayers?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled);}}});L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:'edit'},includes:L.Mixin.Events,initialize:function(map,options){L.Handler.prototype.initialize.call(this,map);L.setOptions(this,options);this._featureGroup=options.featureGroup;if(!(this._featureGroup instanceof L.FeatureGroup)){throw new Error('options.featureGroup must be a L.FeatureGroup');}
this._uneditedLayerProps={};this.type=L.EditToolbar.Edit.TYPE;},enable:function(){if(this._enabled||!this._hasAvailableLayers()){return;}
this.fire('enabled',{handler:this.type});this._map.fire('draw:editstart',{handler:this.type});L.Handler.prototype.enable.call(this);this._featureGroup.on('layeradd',this._enableLayerEdit,this).on('layerremove',this._disableLayerEdit,this);},disable:function(){if(!this._enabled){return;}
this._featureGroup.off('layeradd',this._enableLayerEdit,this).off('layerremove',this._disableLayerEdit,this);L.Handler.prototype.disable.call(this);this._map.fire('draw:editstop',{handler:this.type});this.fire('disabled',{handler:this.type});},addHooks:function(){var map=this._map;if(map){map.getContainer().focus();this._featureGroup.eachLayer(this._enableLayerEdit,this);this._tooltip=new L.Tooltip(this._map);this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext});this._map.on('mousemove',this._onMouseMove,this);}},removeHooks:function(){if(this._map){this._featureGroup.eachLayer(this._disableLayerEdit,this);this._uneditedLayerProps={};this._tooltip.dispose();this._tooltip=null;this._map.off('mousemove',this._onMouseMove,this);}},revertLayers:function(){this._featureGroup.eachLayer(function(layer){this._revertLayer(layer);},this);},save:function(){var editedLayers=new L.LayerGroup();this._featureGroup.eachLayer(function(layer){if(layer.edited){editedLayers.addLayer(layer);layer.edited=false;}});this._map.fire('draw:edited',{layers:editedLayers});},_backupLayer:function(layer){var id=L.Util.stamp(layer);if(!this._uneditedLayerProps[id]){if(layer instanceof L.Polyline||layer instanceof L.Polygon||layer instanceof L.Rectangle){this._uneditedLayerProps[id]={latlngs:L.LatLngUtil.cloneLatLngs(layer.getLatLngs())};}else if(layer instanceof L.Circle){this._uneditedLayerProps[id]={latlng:L.LatLngUtil.cloneLatLng(layer.getLatLng()),radius:layer.getRadius()};}else if(layer instanceof L.Marker){this._uneditedLayerProps[id]={latlng:L.LatLngUtil.cloneLatLng(layer.getLatLng())};}}},_revertLayer:function(layer){var id=L.Util.stamp(layer);layer.edited=false;if(this._uneditedLayerProps.hasOwnProperty(id)){if(layer instanceof L.Polyline||layer instanceof L.Polygon||layer instanceof L.Rectangle){layer.setLatLngs(this._uneditedLayerProps[id].latlngs);}else if(layer instanceof L.Circle){layer.setLatLng(this._uneditedLayerProps[id].latlng);layer.setRadius(this._uneditedLayerProps[id].radius);}else if(layer instanceof L.Marker){layer.setLatLng(this._uneditedLayerProps[id].latlng);}
layer.fire('revert-edited',{layer:layer});}},_enableLayerEdit:function(e){var layer=e.layer||e.target||e,pathOptions;this._backupLayer(layer);if(this.options.selectedPathOptions){pathOptions=L.Util.extend({},this.options.selectedPathOptions);if(pathOptions.maintainColor){pathOptions.color=layer.options.color;pathOptions.fillColor=layer.options.fillColor;}
layer.options.original=L.extend({},layer.options);layer.options.editing=pathOptions;}
layer.editing.enable();},_disableLayerEdit:function(e){var layer=e.layer||e.target||e;layer.edited=false;layer.editing.disable();delete layer.options.editing;delete layer.options.original;},_onMouseMove:function(e){this._tooltip.updatePosition(e.latlng);},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0;}});L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:'remove'},includes:L.Mixin.Events,initialize:function(map,options){L.Handler.prototype.initialize.call(this,map);L.Util.setOptions(this,options);this._deletableLayers=this.options.featureGroup;if(!(this._deletableLayers instanceof L.FeatureGroup)){throw new Error('options.featureGroup must be a L.FeatureGroup');}
this.type=L.EditToolbar.Delete.TYPE;},enable:function(){if(this._enabled||!this._hasAvailableLayers()){return;}
this.fire('enabled',{handler:this.type});this._map.fire('draw:deletestart',{handler:this.type});L.Handler.prototype.enable.call(this);this._deletableLayers.on('layeradd',this._enableLayerDelete,this).on('layerremove',this._disableLayerDelete,this);},disable:function(){if(!this._enabled){return;}
this._deletableLayers.off('layeradd',this._enableLayerDelete,this).off('layerremove',this._disableLayerDelete,this);L.Handler.prototype.disable.call(this);this._map.fire('draw:deletestop',{handler:this.type});this.fire('disabled',{handler:this.type});},addHooks:function(){var map=this._map;if(map){map.getContainer().focus();this._deletableLayers.eachLayer(this._enableLayerDelete,this);this._deletedLayers=new L.LayerGroup();this._tooltip=new L.Tooltip(this._map);this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text});this._map.on('mousemove',this._onMouseMove,this);}},removeHooks:function(){if(this._map){this._deletableLayers.eachLayer(this._disableLayerDelete,this);this._deletedLayers=null;this._tooltip.dispose();this._tooltip=null;this._map.off('mousemove',this._onMouseMove,this);}},revertLayers:function(){this._deletedLayers.eachLayer(function(layer){this._deletableLayers.addLayer(layer);layer.fire('revert-deleted',{layer:layer});},this);},save:function(){this._map.fire('draw:deleted',{layers:this._deletedLayers});},_enableLayerDelete:function(e){var layer=e.layer||e.target||e;layer.on('click',this._removeLayer,this);},_disableLayerDelete:function(e){var layer=e.layer||e.target||e;layer.off('click',this._removeLayer,this);this._deletedLayers.removeLayer(layer);},_removeLayer:function(e){var layer=e.layer||e.target||e;this._deletableLayers.removeLayer(layer);this._deletedLayers.addLayer(layer);layer.fire('deleted');},_onMouseMove:function(e){this._tooltip.updatePosition(e.latlng);},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0;}});}(window,document));

/**
 * http://github.com/makinacorpus/Leaflet.GeometryUtil  --  dist/leaflet.geometryutil.js (8.4 kb)
 */
(function(factory){var L;if(typeof define==='function'&&define.amd){define(['leaflet'],factory);}else if(typeof module!=='undefined'){L=require('leaflet');module.exports=factory(L);}else{if(typeof window.L==='undefined')
throw'Leaflet must be loaded first';factory(window.L);}}(function(L){"use strict";L.GeometryUtil=L.extend(L.GeometryUtil||{},{distance:function(map,latlngA,latlngB){return map.latLngToLayerPoint(latlngA).distanceTo(map.latLngToLayerPoint(latlngB));},distanceSegment:function(map,latlng,latlngA,latlngB){var p=map.latLngToLayerPoint(latlng),p1=map.latLngToLayerPoint(latlngA),p2=map.latLngToLayerPoint(latlngB);return L.LineUtil.pointToSegmentDistance(p,p1,p2);},readableDistance:function(distance,unit){var isMetric=(unit!=='imperial'),distanceStr;if(isMetric){if(distance>1000){distanceStr=(distance / 1000).toFixed(2)+' km';}
else{distanceStr=Math.ceil(distance)+' m';}}
else{distance*=1.09361;if(distance>1760){distanceStr=(distance / 1760).toFixed(2)+' miles';}
else{distanceStr=Math.ceil(distance)+' yd';}}
return distanceStr;},belongsSegment:function(latlng,latlngA,latlngB,tolerance){tolerance=tolerance===undefined?0.2:tolerance;var hypotenuse=latlngA.distanceTo(latlngB),delta=latlngA.distanceTo(latlng)+latlng.distanceTo(latlngB)-hypotenuse;return delta/hypotenuse<tolerance;},length:function(coords){var accumulated=L.GeometryUtil.accumulatedLengths(coords);return accumulated.length>0?accumulated[accumulated.length-1]:0;},accumulatedLengths:function(coords){if(typeof coords.getLatLngs=='function'){coords=coords.getLatLngs();}
if(coords.length===0)
return[];var total=0,lengths=[0];for(var i=0,n=coords.length-1;i<n;i++){total+=coords[i].distanceTo(coords[i+1]);lengths.push(total);}
return lengths;},closestOnSegment:function(map,latlng,latlngA,latlngB){var maxzoom=map.getMaxZoom();if(maxzoom===Infinity)
maxzoom=map.getZoom();var p=map.project(latlng,maxzoom),p1=map.project(latlngA,maxzoom),p2=map.project(latlngB,maxzoom),closest=L.LineUtil.closestPointOnSegment(p,p1,p2);return map.unproject(closest,maxzoom);},closest:function(map,layer,latlng,vertices){if(typeof layer.getLatLngs!='function')
layer=L.polyline(layer);var latlngs=layer.getLatLngs().slice(0),mindist=Infinity,result=null,i,n,distance;if(vertices){for(i=0,n=latlngs.length;i<n;i++){var ll=latlngs[i];distance=L.GeometryUtil.distance(map,latlng,ll);if(distance<mindist){mindist=distance;result=ll;result.distance=distance;}}
return result;}
if(layer instanceof L.Polygon){latlngs.push(latlngs[0]);}
for(i=0,n=latlngs.length;i<n-1;i++){var latlngA=latlngs[i],latlngB=latlngs[i+1];distance=L.GeometryUtil.distanceSegment(map,latlng,latlngA,latlngB);if(distance<=mindist){mindist=distance;result=L.GeometryUtil.closestOnSegment(map,latlng,latlngA,latlngB);result.distance=distance;}}
return result;},closestLayer:function(map,layers,latlng){var mindist=Infinity,result=null,ll=null,distance=Infinity;for(var i=0,n=layers.length;i<n;i++){var layer=layers[i];if(typeof layer.getLatLng=='function'){ll=layer.getLatLng();distance=L.GeometryUtil.distance(map,latlng,ll);}
else{ll=L.GeometryUtil.closest(map,layer,latlng);if(ll)distance=ll.distance;}
if(distance<mindist){mindist=distance;result={layer:layer,latlng:ll,distance:distance};}}
return result;},closestLayerSnap:function(map,layers,latlng,tolerance,withVertices){tolerance=typeof tolerance=='number'?tolerance:Infinity;withVertices=typeof withVertices=='boolean'?withVertices:true;var result=L.GeometryUtil.closestLayer(map,layers,latlng);if(!result||result.distance>tolerance)
return null;if(withVertices&&typeof result.layer.getLatLngs=='function'){var closest=L.GeometryUtil.closest(map,result.layer,result.latlng,true);if(closest.distance<tolerance){result.latlng=closest;result.distance=L.GeometryUtil.distance(map,closest,latlng);}}
return result;},interpolateOnPointSegment:function(pA,pB,ratio){return L.point((pA.x*(1-ratio))+(ratio*pB.x),(pA.y*(1-ratio))+(ratio*pB.y));},interpolateOnLine:function(map,latLngs,ratio){latLngs=(latLngs instanceof L.Polyline)?latLngs.getLatLngs():latLngs;var n=latLngs.length;if(n<2){return null;}
ratio=Math.max(Math.min(ratio,1),0);if(ratio===0){return{latLng:latLngs[0]instanceof L.LatLng?latLngs[0]:L.latLng(latLngs[0]),predecessor:-1};}
if(ratio==1){return{latLng:latLngs[latLngs.length-1]instanceof L.LatLng?latLngs[latLngs.length-1]:L.latLng(latLngs[latLngs.length-1]),predecessor:latLngs.length-2};}
var maxzoom=map.getMaxZoom();if(maxzoom===Infinity)
maxzoom=map.getZoom();var pts=[];var lineLength=0;for(var i=0;i<n;i++){pts[i]=map.project(latLngs[i],maxzoom);if(i>0)
lineLength+=pts[i-1].distanceTo(pts[i]);}
var ratioDist=lineLength*ratio;var a=pts[0],b=pts[1],distA=0,distB=a.distanceTo(b);var index=1;for(;index<n&&distB<ratioDist;index++){a=b;distA=distB;b=pts[index];distB+=a.distanceTo(b);}
var segmentRatio=((distB-distA)!==0)?((ratioDist-distA)/(distB-distA)):0;var interpolatedPoint=L.GeometryUtil.interpolateOnPointSegment(a,b,segmentRatio);return{latLng:map.unproject(interpolatedPoint,maxzoom),predecessor:index-2};},locateOnLine:function(map,polyline,latlng){var latlngs=polyline.getLatLngs();if(latlng.equals(latlngs[0]))
return 0.0;if(latlng.equals(latlngs[latlngs.length-1]))
return 1.0;var point=L.GeometryUtil.closest(map,polyline,latlng,false),lengths=L.GeometryUtil.accumulatedLengths(latlngs),total_length=lengths[lengths.length-1],portion=0,found=false;for(var i=0,n=latlngs.length-1;i<n;i++){var l1=latlngs[i],l2=latlngs[i+1];portion=lengths[i];if(L.GeometryUtil.belongsSegment(point,l1,l2)){portion+=l1.distanceTo(point);found=true;break;}}
if(!found){throw"Could not interpolate "+latlng.toString()+" within "+polyline.toString();}
return portion / total_length;},reverse:function(polyline){return L.polyline(polyline.getLatLngs().slice(0).reverse());},extract:function(map,polyline,start,end){if(start>end){return L.GeometryUtil.extract(map,L.GeometryUtil.reverse(polyline),1.0-start,1.0-end);}
start=Math.max(Math.min(start,1),0);end=Math.max(Math.min(end,1),0);var latlngs=polyline.getLatLngs(),startpoint=L.GeometryUtil.interpolateOnLine(map,polyline,start),endpoint=L.GeometryUtil.interpolateOnLine(map,polyline,end);if(start==end){var point=L.GeometryUtil.interpolateOnLine(map,polyline,end);return[point.latLng];}
if(startpoint.predecessor==-1)
startpoint.predecessor=0;if(endpoint.predecessor==-1)
endpoint.predecessor=0;var result=latlngs.slice(startpoint.predecessor+1,endpoint.predecessor+1);result.unshift(startpoint.latLng);result.push(endpoint.latLng);return result;},isBefore:function(polyline,other){if(!other)return false;var lla=polyline.getLatLngs(),llb=other.getLatLngs();return(lla[lla.length-1]).equals(llb[0]);},isAfter:function(polyline,other){if(!other)return false;var lla=polyline.getLatLngs(),llb=other.getLatLngs();return(lla[0]).equals(llb[llb.length-1]);},startsAtExtremity:function(polyline,other){if(!other)return false;var lla=polyline.getLatLngs(),llb=other.getLatLngs(),start=lla[0];return start.equals(llb[0])||start.equals(llb[llb.length-1]);},computeAngle:function(a,b){return(Math.atan2(b.y-a.y,b.x-a.x)*180 / Math.PI);},computeSlope:function(a,b){var s=(b.y-a.y)/(b.x-a.x),o=a.y-(s*a.x);return{'a':s,'b':o};},rotatePoint:function(map,latlngPoint,angleDeg,latlngCenter){var maxzoom=map.getMaxZoom();if(maxzoom===Infinity)
maxzoom=map.getZoom();var angleRad=angleDeg*Math.PI/180,pPoint=map.project(latlngPoint,maxzoom),pCenter=map.project(latlngCenter,maxzoom),x2=Math.cos(angleRad)*(pPoint.x-pCenter.x)-Math.sin(angleRad)*(pPoint.y-pCenter.y)+pCenter.x,y2=Math.sin(angleRad)*(pPoint.x-pCenter.x)+Math.cos(angleRad)*(pPoint.y-pCenter.y)+pCenter.y;return map.unproject(new L.Point(x2,y2),maxzoom);},bearing:function(latlng1,latlng2){var rad=Math.PI / 180,lat1=latlng1.lat*rad,lat2=latlng2.lat*rad,lon1=latlng1.lng*rad,lon2=latlng2.lng*rad,y=Math.sin(lon2-lon1)*Math.cos(lat2),x=Math.cos(lat1)*Math.sin(lat2)-
Math.sin(lat1)*Math.cos(lat2)*Math.cos(lon2-lon1);var bearing=((Math.atan2(y,x)*180 / Math.PI)+360)%360;return bearing>=180?bearing-360:bearing;},destination:function(latlng,heading,distance){heading=(heading+360)%360;var rad=Math.PI / 180,radInv=180 / Math.PI,R=6378137,lon1=latlng.lng*rad,lat1=latlng.lat*rad,rheading=heading*rad,sinLat1=Math.sin(lat1),cosLat1=Math.cos(lat1),cosDistR=Math.cos(distance / R),sinDistR=Math.sin(distance / R),lat2=Math.asin(sinLat1*cosDistR+cosLat1*sinDistR*Math.cos(rheading)),lon2=lon1+Math.atan2(Math.sin(rheading)*sinDistR*cosLat1,cosDistR-sinLat1*Math.sin(lat2));lon2=lon2*radInv;lon2=lon2>180?lon2-360:lon2<-180?lon2+360:lon2;return L.latLng([lat2*radInv,lon2]);}});return L.GeometryUtil;}));

/**
 * http://github.com/makinacorpus/Leaflet.Snap  --  leaflet.snap.js (4.4 kb)
 */
(function(){L.Handler.MarkerSnap=L.Handler.extend({options:{snapDistance:15,snapVertices:true},initialize:function(map,marker,options){L.Handler.prototype.initialize.call(this,map);this._markers=[];this._guides=[];if(arguments.length==2){if(!(marker instanceof L.Class)){options=marker;marker=null;}}
L.Util.setOptions(this,options||{});if(marker){if(!marker.dragging)marker.dragging=new L.Handler.MarkerDrag(marker);marker.dragging.enable();this.watchMarker(marker);}
function computeBuffer(){this._buffer=map.layerPointToLatLng(new L.Point(0,0)).lat-
map.layerPointToLatLng(new L.Point(this.options.snapDistance,0)).lat;}
map.on('zoomend',computeBuffer,this);map.whenReady(computeBuffer,this);computeBuffer.call(this);},enable:function(){this.disable();for(var i=0;i<this._markers.length;i++){this.watchMarker(this._markers[i]);}},disable:function(){for(var i=0;i<this._markers.length;i++){this.unwatchMarker(this._markers[i]);}},watchMarker:function(marker){if(this._markers.indexOf(marker)==-1)
this._markers.push(marker);marker.on('move',this._snapMarker,this);},unwatchMarker:function(marker){marker.off('move',this._snapMarker,this);delete marker['snap'];},addGuideLayer:function(layer){for(var i=0,n=this._guides.length;i<n;i++)
if(L.stamp(layer)===L.stamp(this._guides[i]))
return;this._guides.push(layer);},_snapMarker:function(e){var marker=e.target,latlng=marker.getLatLng(),snaplist=[];function processGuide(guide){if((guide._layers!==undefined)&&(typeof guide.searchBuffer!=='function')){for(var id in guide._layers){processGuide(guide._layers[id]);}}
else if(typeof guide.searchBuffer==='function'){snaplist=snaplist.concat(guide.searchBuffer(latlng,this._buffer));}
else{snaplist.push(guide);}}
for(var i=0,n=this._guides.length;i<n;i++){var guide=this._guides[i];processGuide.call(this,guide);}
var closest=this._findClosestLayerSnap(this._map,snaplist,latlng,this.options.snapDistance,this.options.snapVertices);closest=closest||{layer:null,latlng:null};this._updateSnap(marker,closest.layer,closest.latlng);},_findClosestLayerSnap:function(map,layers,latlng,tolerance,withVertices){return L.GeometryUtil.closestLayerSnap(map,layers,latlng,tolerance,withVertices);},_updateSnap:function(marker,layer,latlng){if(layer&&latlng){marker._latlng=L.latLng(latlng);marker.update();if(marker.snap!=layer){marker.snap=layer;if(marker._icon)L.DomUtil.addClass(marker._icon,'marker-snapped');marker.fire('snap',{layer:layer,latlng:latlng});}}
else{if(marker.snap){if(marker._icon)L.DomUtil.removeClass(marker._icon,'marker-snapped');marker.fire('unsnap',{layer:marker.snap});}
delete marker['snap'];}}});if(!L.Edit){return;}
L.Handler.PolylineSnap=L.Edit.Poly.extend({initialize:function(map,poly,options){L.Edit.Poly.prototype.initialize.call(this,poly,options);this._snapper=new L.Handler.MarkerSnap(map,options);},addGuideLayer:function(layer){this._snapper.addGuideLayer(layer);},_createMarker:function(latlng,index){var marker=L.Edit.Poly.prototype._createMarker.call(this,latlng,index);var isMiddle=index===undefined;if(isMiddle){marker.on('dragstart',function(){this._snapper.watchMarker(marker);},this);}
else{this._snapper.watchMarker(marker);}
return marker;}});L.Draw.Feature.SnapMixin={_snap_initialize:function(){this.on('enabled',this._snap_on_enabled,this);this.on('disabled',this._snap_on_disabled,this);},_snap_on_enabled:function(){if(!this.options.guideLayers){return;}
if(!this._mouseMarker){return;}
if(!this._snapper){this._snapper=new L.Handler.MarkerSnap(this._map);if(this.options.snapDistance){this._snapper.options.snapDistance=this.options.snapDistance;}
if(this.options.snapVertices){this._snapper.options.snapVertices=this.options.snapVertices;}}
for(var i=0,n=this.options.guideLayers.length;i<n;i++)
this._snapper.addGuideLayer(this.options.guideLayers[i]);var marker=this._mouseMarker;this._snapper.watchMarker(marker);var icon=marker.options.icon;marker.on('snap',function(e){marker.setIcon(this.options.icon);marker.setOpacity(1);},this).on('unsnap',function(e){marker.setIcon(icon);marker.setOpacity(0);},this);marker.on('click',this._snap_on_click,this);},_snap_on_click:function(){if(this._markers){var markerCount=this._markers.length,marker=this._markers[markerCount-1];if(this._mouseMarker.snap){L.DomUtil.addClass(marker._icon,'marker-snapped');}}},_snap_on_disabled:function(){delete this._snapper;},};L.Draw.Feature.include(L.Draw.Feature.SnapMixin);L.Draw.Feature.addInitHook('_snap_initialize');})();

/**
 * http://github.com/Dominique92/MyLeaflet  --  src/PolylineEditor.js (5.4 kb)
 */
L.Control.PolylineEditor=L.Control.extend({options:{position:'topleft',help:['Edit command list'],idInput:'input-editor',idChange:null,submit:'<not implemented>',},changed:true,onAdd:function(map){map.editor=this;this.elInput=document.getElementById(this.options.idInput);this.elChange=document.getElementById(this.options.idChange);if(this.elInput){var input=[];if(this.elInput.value){this.inputValue=this.elInput.value;eval('input = '+this.elInput.value);}
this.type=input.type;switch(input.type){case'MultiPolygon':var c=input.coordinates;input.coordinates=[];for(i in c)
input.coordinates.push(c[i][0]);case'Polygon':input.type='MultiLineString';case'LineString':case'MultiLineString':break;case undefined:input={type:'MultiLineString',coordinates:input};break;default:alert('Type de geometrie inconnue de l\'editeur: '+input.type);}
var el=new L.GeoJSON(input,L.Polyline.prototype.options);el.addTo(map);this.addEdit(el);}
map.doubleClickZoom.disable();map.on('dblclick',function(e){var draw=new L.Draw.Polyline(map,{shapeOptions:L.Polyline.prototype.options});draw.addHooks();draw.enable();draw._currentLatLng=L.latLng([e.latlng.lat,e.latlng.lng]);if(e.last)
draw.addVertex(e.last._latlng);draw.addVertex(draw._currentLatLng);});map.on('draw:created',function(e){e.layer.options.editSnapable=true;map.addLayer(e.layer);this.addEdit(e.layer);},this);map.on('mouseup',function(){this.changed=true;},this);map.on('mousemove',function(){if(this.changed){this.changed=false;for(il1 in map._layers)
for(il2 in map._layers){var le1=map._layers[il1].editing,le2=map._layers[il2].editing;if(le1&&le1._enabled&&le2&&le2._enabled&&le1._leaflet_id<le2._leaflet_id){var ll1=le1._poly._latlngs,ll2=le2._poly._latlngs,lladd=null;if(ll1[0].equals(ll2[0])){ll1.reverse();lladd=ll2;}else if(ll1[0].equals(ll2[ll2.length-1])){ll1.reverse();lladd=ll2.reverse();}else if(ll1[ll1.length-1].equals(ll2[0])){lladd=ll2;}else if(ll1[ll1.length-1].equals(ll2[ll2.length-1])){lladd=ll2.reverse();}
if(lladd){le1._poly._latlngs.pop();le1._poly._latlngs=ll1.concat(lladd);le1._poly.redraw();le1.updateMarkers();map.removeLayer(le2._poly);}}}
for(il1 in map._layers){var le1=map._layers[il1].editing;if(le1&&le1._enabled&&le1._snapper){le1._snapper._guides=[];for(il2 in map._layers){var l2=map._layers[il2];if(il1!=il2&&l2.options&&l2.options.editSnapable)
le1._snapper.addGuideLayer(l2);}}}
var mp=[],ml=[];for(il1 in map._layers){var le1=map._layers[il1].editing;if(le1&&le1._enabled){var g=map._layers[il1].toGeoJSON().geometry;switch(g.type){case'Polygon':ml=ml.concat(g.coordinates);mp.push(g.coordinates);break;case'LineString':mp.push([g.coordinates]);ml.push(g.coordinates);break;default:alert('Type de geometrie inconnue dans l\'editeur: '+g.type);}}}
switch(this.type){case'Polygon':case'MultiPolygon':ml={type:'MultiPolygon',coordinates:mp};break
case'LineString':case'MultiLineString':ml={type:'MultiLineString',coordinates:ml};}
if(this.elInput)
this.elInput.value=this.elInput.innerHTML=JSON.stringify(ml);if(this.elChange&&(this.inputValue||'[]').trim()!=this.elInput.value)
this.elChange.style.display='';}},this);var container=L.DomUtil.create('div','leaflet-control-edit-help leaflet-bar');this.link=L.DomUtil.create('a','leaflet-control-edit-help-button',container);this.link.title=this.options.help.join('.\n')+this.options.submit+'.';L.DomEvent.on(this.link,'click',function(){alert(this.options.help.join('.\n')+this.options.submit+'.');},this);return container;},addEdit:function(layer){if(layer.editing){layer.options.editing={};layer.editing._snapper=new L.Handler.MarkerSnap(this._map);layer.editing.enable();layer.options.editSnapable=true;}
for(l in layer._layers)
this.addEdit(layer._layers[l]);}});L.Edit.Poly.addInitHook(function(){this._poly.on('click',function(e){var map=this._poly._map;if(e.target.editing._enabled){e.target.options.weight=20;e.target._updateStyle();if(confirm('Supprimer cette ligne ?')){map.removeLayer(this._poly);map.editor.changed=true;map.fire('mousemove');}else{e.target.options.weight=5;e.target._updateStyle();}}},this);});L.Edit.Poly.include({_createMarkerOrigin:L.Edit.Poly.prototype._createMarker,_createMarker:function(latlng,index){var map=this._poly._map,marker=this._createMarkerOrigin(latlng,index);if(index===undefined){marker.on('dragstart',function(){this._snapper.watchMarker(marker);},this);if(!this._poly._holePoints)
marker.on('click',this._onClickMiddleMarker,this);}else{this._snapper.watchMarker(marker);marker.on('click',function(e){if(!e.remove&&(!marker._prev||!marker._next))
map.fire('dblclick',{latlng:marker._latlng,last:marker._prev?(marker._prev._prev?marker._prev:null):(marker._next._next?marker._next:null)});});}
return marker;},_onClickMiddleMarker:function(e){var marker1,marker2,map=this._poly._map;for(m in this._markers)
if(this._markers[m]._middleRight&&this._markers[m]._middleRight._leaflet_id==e.target._leaflet_id)
marker1=this._markers[m];else if(this._markers[m]._middleLeft&&this._markers[m]._middleLeft._leaflet_id==e.target._leaflet_id)
marker2=this._markers[m];if(marker1&&marker2){if(!marker1._prev&&!marker2._next)
map.removeLayer(this._poly);if(!marker1._prev)
this._onMarkerClick({target:marker1,remove:true});else if(!marker2._next)
this._onMarkerClick({target:marker2,remove:true});else{var ll=[];for(var m=marker2;m;m=m._next){ll.push([m._latlng.lat,m._latlng.lng]);this._onMarkerClick({target:m,remove:true});}
var p=new L.Polyline(ll,this._poly.options).addTo(map);map.editor.addEdit(p);}}}});

/**
 * http://github.com/Dominique92/MyLeaflet  --  src/locales.fr.js (1.4 kb)
 */
L.Icon.Default.imagePath=L.Icon.Default.imagePath.replace(/(dist\/src|dist|src)/g,'leafletjs.com');L.Polyline=L.Polyline.extend({options:{color:'red',weight:4,opacity:1,}});if(navigator.language||navigator.userLanguage=='fr'){if(L.Control.Fullscreen)
L.Control.Fullscreen=L.Control.Fullscreen.extend({options:{title:{false:'Plein cran',true:'Sortir du plein cran'}}});if(L.Control.Gps)
L.Control.Gps=L.Control.Gps.extend({options:{title:'Afficher votre position GPS'}});if(L.Control.FileLayerLoad)
L.Control.FileLayerLoad=L.Control.FileLayerLoad.extend({statics:{TITLE:'Charger un fichier GPX, KML, GeoJSON'}});if(L.Control.OSMGeocoder)
L.Control.OSMGeocoder=L.Control.OSMGeocoder.extend({options:{position:'topleft',text:'Chercher',}});if(L.Control.PolylineEditor)
L.Control.PolylineEditor=L.Control.PolylineEditor.extend({options:{help:['EDITEUR DE LIGNE','Crer une nouvelle ligne: double cliquer sur la carte','Insrer un sommet: cliquer et glisser le carr intermdiaire','Dplacer un sommet: cliquer et glisser le carr','Supprimer un sommet: cliquer sur le carr','NOTE: un effet d\'adhrence prend les coordonnes des points proches','NOTE: l\'diteur fusionne les lignes de mme extrmit','Supprimer un segment: cliquer sur le carr intermdiaire','Allonger une ligne: cliquer sur le carr  l\'extrmit','Supprimer une ligne: cliquer sur la ligne','Enregitrer les modifications: ',]}});}